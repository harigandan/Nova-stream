(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[439],{57946:(e,t,n)=>{!function(){var t={223:function(e){e.exports=function(){var e={228:function(e){"use strict";var t=Object.prototype.hasOwnProperty,n="~";function r(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,t,r,o,a){if("function"!=typeof r)throw TypeError("The listener must be a function");var s=new i(r,o||e,a),u=n?n+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function s(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,r,i=[];if(0===this._eventsCount)return i;for(r in e=this._events)t.call(e,r)&&i.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=n?n+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,o=r.length,a=Array(o);i<o;i++)a[i]=r[i].fn;return a},s.prototype.listenerCount=function(e){var t=n?n+e:e,r=this._events[t];return r?r.fn?1:r.length:0},s.prototype.emit=function(e,t,r,i,o,a){var s=n?n+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,i),!0;case 5:return l.fn.call(l.context,t,r,i,o),!0;case 6:return l.fn.call(l.context,t,r,i,o,a),!0}for(c=1,u=Array(f-1);c<f;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var d,h=l.length;for(c=0;c<h;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),f){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,r);break;case 4:l[c].fn.call(l[c].context,t,r,i);break;default:if(!u)for(d=1,u=Array(f-1);d<f;d++)u[d-1]=arguments[d];l[c].fn.apply(l[c].context,u)}}return!0},s.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,r,i){var o=n?n+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||a(this,o);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==t||i&&!s[u].once||r&&s[u].context!==r)&&c.push(s[u]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&a(this,t)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,e.exports=s},543:function(e,t,n){var r;e=n.nmd(e),(function(){var i,o="Expected a function",a="__lodash_hash_undefined__",s="__lodash_placeholder__",u=1/0,c=NaN,l=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],f="[object Arguments]",d="[object Array]",h="[object Boolean]",p="[object Date]",v="[object Error]",g="[object Function]",m="[object GeneratorFunction]",y="[object Map]",_="[object Number]",b="[object Object]",E="[object Promise]",S="[object RegExp]",T="[object Set]",w="[object String]",C="[object Symbol]",k="[object WeakMap]",I="[object ArrayBuffer]",P="[object DataView]",A="[object Float32Array]",M="[object Float64Array]",L="[object Int8Array]",D="[object Int16Array]",x="[object Int32Array]",R="[object Uint8Array]",O="[object Uint8ClampedArray]",N="[object Uint16Array]",U="[object Uint32Array]",F=/\b__p \+= '';/g,B=/\b(__p \+=) '' \+/g,V=/(__e\(.*?\)|\b__t\)) \+\n'';/g,G=/&(?:amp|lt|gt|quot|#39);/g,H=/[&<>"']/g,W=RegExp(G.source),j=RegExp(H.source),z=/<%-([\s\S]+?)%>/g,K=/<%([\s\S]+?)%>/g,Q=/<%=([\s\S]+?)%>/g,q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Y=/^\w*$/,Z=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,J=/[\\^$.*+?()[\]{}|]/g,X=RegExp(J.source),$=/^\s+/,ee=/\s/,et=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,en=/\{\n\/\* \[wrapped with (.+)\] \*/,er=/,? & /,ei=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,eo=/[()=,{}\[\]\/\s]/,ea=/\\(\\)?/g,es=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,eu=/\w*$/,ec=/^[-+]0x[0-9a-f]+$/i,el=/^0b[01]+$/i,ef=/^\[object .+?Constructor\]$/,ed=/^0o[0-7]+$/i,eh=/^(?:0|[1-9]\d*)$/,ep=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ev=/($^)/,eg=/['\n\r\u2028\u2029\\]/g,em="\ud800-\udfff",ey="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",e_="\\u2700-\\u27bf",eb="a-z\\xdf-\\xf6\\xf8-\\xff",eE="A-Z\\xc0-\\xd6\\xd8-\\xde",eS="\\ufe0e\\ufe0f",eT="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ew="["+eT+"]",eC="["+ey+"]",ek="["+eb+"]",eI="[^"+em+eT+"\\d+"+e_+eb+eE+"]",eP="\ud83c[\udffb-\udfff]",eA="[^"+em+"]",eM="(?:\ud83c[\udde6-\uddff]){2}",eL="[\ud800-\udbff][\udc00-\udfff]",eD="["+eE+"]",ex="\\u200d",eR="(?:"+ek+"|"+eI+")",eO="(?:"+eD+"|"+eI+")",eN="(?:['’](?:d|ll|m|re|s|t|ve))?",eU="(?:['’](?:D|LL|M|RE|S|T|VE))?",eF="(?:"+eC+"|"+eP+")?",eB="["+eS+"]?",eV=eB+eF+"(?:"+ex+"(?:"+[eA,eM,eL].join("|")+")"+eB+eF+")*",eG="(?:"+["["+e_+"]",eM,eL].join("|")+")"+eV,eH="(?:"+[eA+eC+"?",eC,eM,eL,"["+em+"]"].join("|")+")",eW=RegExp("['’]","g"),ej=RegExp(eC,"g"),ez=RegExp(eP+"(?="+eP+")|"+eH+eV,"g"),eK=RegExp([eD+"?"+ek+"+"+eN+"(?="+[ew,eD,"$"].join("|")+")",eO+"+"+eU+"(?="+[ew,eD+eR,"$"].join("|")+")",eD+"?"+eR+"+"+eN,eD+"+"+eU,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",eG].join("|"),"g"),eQ=RegExp("["+ex+em+ey+eS+"]"),eq=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,eY=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],eZ=-1,eJ={};eJ[A]=eJ[M]=eJ[L]=eJ[D]=eJ[x]=eJ[R]=eJ[O]=eJ[N]=eJ[U]=!0,eJ[f]=eJ[d]=eJ[I]=eJ[h]=eJ[P]=eJ[p]=eJ[v]=eJ[g]=eJ[y]=eJ[_]=eJ[b]=eJ[S]=eJ[T]=eJ[w]=eJ[k]=!1;var eX={};eX[f]=eX[d]=eX[I]=eX[P]=eX[h]=eX[p]=eX[A]=eX[M]=eX[L]=eX[D]=eX[x]=eX[y]=eX[_]=eX[b]=eX[S]=eX[T]=eX[w]=eX[C]=eX[R]=eX[O]=eX[N]=eX[U]=!0,eX[v]=eX[g]=eX[k]=!1;var e$={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},e0=parseFloat,e1=parseInt,e2="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,e3="object"==typeof self&&self&&self.Object===Object&&self,e4=e2||e3||Function("return this")(),e8=t&&!t.nodeType&&t,e6=e8&&e&&!e.nodeType&&e,e5=e6&&e6.exports===e8,e7=e5&&e2.process,e9=function(){try{return e6&&e6.require&&e6.require("util").types||e7&&e7.binding&&e7.binding("util")}catch(e){}}(),te=e9&&e9.isArrayBuffer,tt=e9&&e9.isDate,tn=e9&&e9.isMap,tr=e9&&e9.isRegExp,ti=e9&&e9.isSet,to=e9&&e9.isTypedArray;function ta(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function ts(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r}function tu(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function tc(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function tl(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o}function tf(e,t){return!(null==e||!e.length)&&tE(e,t,0)>-1}function td(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function th(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function tp(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function tv(e,t,n,r){var i=-1,o=null==e?0:e.length;for(r&&o&&(n=e[++i]);++i<o;)n=t(n,e[i],i,e);return n}function tg(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function tm(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var ty=tC("length");function t_(e,t,n){var r;return n(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r}function tb(e,t,n,r){for(var i=e.length,o=n+(r?1:-1);r?o--:++o<i;)if(t(e[o],o,e))return o;return -1}function tE(e,t,n){return t==t?function(e,t,n){for(var r=n-1,i=e.length;++r<i;)if(e[r]===t)return r;return -1}(e,t,n):tb(e,tT,n)}function tS(e,t,n,r){for(var i=n-1,o=e.length;++i<o;)if(r(e[i],t))return i;return -1}function tT(e){return e!=e}function tw(e,t){var n=null==e?0:e.length;return n?tP(e,t)/n:c}function tC(e){return function(t){return null==t?i:t[e]}}function tk(e){return function(t){return null==e?i:e[t]}}function tI(e,t,n,r,i){return i(e,function(e,i,o){n=r?(r=!1,e):t(n,e,i,o)}),n}function tP(e,t){for(var n,r=-1,o=e.length;++r<o;){var a=t(e[r]);a!==i&&(n=n===i?a:n+a)}return n}function tA(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function tM(e){return e?e.slice(0,tK(e)+1).replace($,""):e}function tL(e){return function(t){return e(t)}}function tD(e,t){return th(t,function(t){return e[t]})}function tx(e,t){return e.has(t)}function tR(e,t){for(var n=-1,r=e.length;++n<r&&tE(t,e[n],0)>-1;);return n}function tO(e,t){for(var n=e.length;n--&&tE(t,e[n],0)>-1;);return n}var tN=tk({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),tU=tk({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function tF(e){return"\\"+e$[e]}function tB(e){return eQ.test(e)}function tV(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function tG(e,t){return function(n){return e(t(n))}}function tH(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n];a!==t&&a!==s||(e[n]=s,o[i++]=n)}return o}function tW(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function tj(e){return tB(e)?function(e){for(var t=ez.lastIndex=0;ez.test(e);)++t;return t}(e):ty(e)}function tz(e){return tB(e)?e.match(ez)||[]:e.split("")}function tK(e){for(var t=e.length;t--&&ee.test(e.charAt(t)););return t}var tQ=tk({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),tq=function e(t){var n,r=(t=null==t?e4:tq.defaults(e4.Object(),t,tq.pick(e4,eY))).Array,ee=t.Date,em=t.Error,ey=t.Function,e_=t.Math,eb=t.Object,eE=t.RegExp,eS=t.String,eT=t.TypeError,ew=r.prototype,eC=ey.prototype,ek=eb.prototype,eI=t["__core-js_shared__"],eP=eC.toString,eA=ek.hasOwnProperty,eM=0,eL=(n=/[^.]+$/.exec(eI&&eI.keys&&eI.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",eD=ek.toString,ex=eP.call(eb),eR=e4._,eO=eE("^"+eP.call(eA).replace(J,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),eN=e5?t.Buffer:i,eU=t.Symbol,eF=t.Uint8Array,eB=eN?eN.allocUnsafe:i,eV=tG(eb.getPrototypeOf,eb),eG=eb.create,eH=ek.propertyIsEnumerable,ez=ew.splice,eQ=eU?eU.isConcatSpreadable:i,e$=eU?eU.iterator:i,e2=eU?eU.toStringTag:i,e3=function(){try{var e=iu(eb,"defineProperty");return e({},"",{}),e}catch(e){}}(),e8=t.clearTimeout!==e4.clearTimeout&&t.clearTimeout,e6=ee&&ee.now!==e4.Date.now&&ee.now,e7=t.setTimeout!==e4.setTimeout&&t.setTimeout,e9=e_.ceil,ty=e_.floor,tk=eb.getOwnPropertySymbols,tY=eN?eN.isBuffer:i,tZ=t.isFinite,tJ=ew.join,tX=tG(eb.keys,eb),t$=e_.max,t0=e_.min,t1=ee.now,t2=t.parseInt,t3=e_.random,t4=ew.reverse,t8=iu(t,"DataView"),t6=iu(t,"Map"),t5=iu(t,"Promise"),t7=iu(t,"Set"),t9=iu(t,"WeakMap"),ne=iu(eb,"create"),nt=t9&&new t9,nn={},nr=iN(t8),ni=iN(t6),no=iN(t5),na=iN(t7),ns=iN(t9),nu=eU?eU.prototype:i,nc=nu?nu.valueOf:i,nl=nu?nu.toString:i;function nf(e){if(oW(e)&&!oD(e)&&!(e instanceof nv)){if(e instanceof np)return e;if(eA.call(e,"__wrapped__"))return iU(e)}return new np(e)}var nd=function(){function e(){}return function(t){if(!oH(t))return{};if(eG)return eG(t);e.prototype=t;var n=new e;return e.prototype=i,n}}();function nh(){}function np(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}function nv(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=0xffffffff,this.__views__=[]}function ng(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function nm(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ny(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function n_(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new ny;++t<n;)this.add(e[t])}function nb(e){var t=this.__data__=new nm(e);this.size=t.size}function nE(e,t){var n=oD(e),r=!n&&oL(e),i=!n&&!r&&oN(e),o=!n&&!r&&!i&&oJ(e),a=n||r||i||o,s=a?tA(e.length,eS):[],u=s.length;for(var c in e)!t&&!eA.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||ig(c,u))||s.push(c);return s}function nS(e){var t=e.length;return t?e[ra(0,t-1)]:i}function nT(e,t,n){(n===i||oP(e[t],n))&&(n!==i||t in e)||nP(e,t,n)}function nw(e,t,n){var r=e[t];eA.call(e,t)&&oP(r,n)&&(n!==i||t in e)||nP(e,t,n)}function nC(e,t){for(var n=e.length;n--;)if(oP(e[n][0],t))return n;return -1}function nk(e,t,n,r){return nO(e,function(e,i,o){t(r,e,n(e),o)}),r}function nI(e,t){return e&&rF(t,ac(t),e)}function nP(e,t,n){"__proto__"==t&&e3?e3(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function nA(e,t){for(var n=-1,o=t.length,a=r(o),s=null==e;++n<o;)a[n]=s?i:ai(e,t[n]);return a}function nM(e,t,n){return e==e&&(n!==i&&(e=e<=n?e:n),t!==i&&(e=e>=t?e:t)),e}function nL(e,t,n,r,o,a){var s,u=1&t,c=2&t,l=4&t;if(n&&(s=o?n(e,r,o,a):n(e)),s!==i)return s;if(!oH(e))return e;var d=oD(e);if(d){if(v=e.length,E=new e.constructor(v),v&&"string"==typeof e[0]&&eA.call(e,"index")&&(E.index=e.index,E.input=e.input),s=E,!u)return rU(e,s)}else{var v,E,k,F,B,V=id(e),G=V==g||V==m;if(oN(e))return rL(e,u);if(V==b||V==f||G&&!o){if(s=c||G?{}:ip(e),!u)return c?(F=(k=s)&&rF(e,al(e),k),rF(e,il(e),F)):(B=nI(s,e),rF(e,ic(e),B))}else{if(!eX[V])return o?e:{};s=function(e,t,n){var r,i,o=e.constructor;switch(t){case I:return rD(e);case h:case p:return new o(+e);case P:return r=n?rD(e.buffer):e.buffer,new e.constructor(r,e.byteOffset,e.byteLength);case A:case M:case L:case D:case x:case R:case O:case N:case U:return rx(e,n);case y:return new o;case _:case w:return new o(e);case S:return(i=new e.constructor(e.source,eu.exec(e))).lastIndex=e.lastIndex,i;case T:return new o;case C:return nc?eb(nc.call(e)):{}}}(e,V,u)}}a||(a=new nb);var H=a.get(e);if(H)return H;a.set(e,s),oq(e)?e.forEach(function(r){s.add(nL(r,t,n,r,e,a))}):oj(e)&&e.forEach(function(r,i){s.set(i,nL(r,t,n,i,e,a))});var W=d?i:(l?c?function(e){return nQ(e,al,il)}:function(e){return nQ(e,ac,ic)}:c?al:ac)(e);return tu(W||e,function(r,i){W&&(r=e[i=r]),nw(s,i,nL(r,t,n,i,e,a))}),s}function nD(e,t,n){var r=n.length;if(null==e)return!r;for(e=eb(e);r--;){var o=n[r],a=t[o],s=e[o];if(s===i&&!(o in e)||!a(s))return!1}return!0}function nx(e,t,n){if("function"!=typeof e)throw new eT(o);return iI(function(){e.apply(i,n)},t)}function nR(e,t,n,r){var i=-1,o=tf,a=!0,s=e.length,u=[],c=t.length;if(!s)return u;n&&(t=th(t,tL(n))),r?(o=td,a=!1):t.length>=200&&(o=tx,a=!1,t=new n_(t));e:for(;++i<s;){var l=e[i],f=null==n?l:n(l);if(l=r||0!==l?l:0,a&&f==f){for(var d=c;d--;)if(t[d]===f)continue e;u.push(l)}else o(t,f,r)||u.push(l)}return u}nf.templateSettings={escape:z,evaluate:K,interpolate:Q,variable:"",imports:{_:nf}},nf.prototype=nh.prototype,nf.prototype.constructor=nf,np.prototype=nd(nh.prototype),np.prototype.constructor=np,nv.prototype=nd(nh.prototype),nv.prototype.constructor=nv,ng.prototype.clear=function(){this.__data__=ne?ne(null):{},this.size=0},ng.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=!!t,t},ng.prototype.get=function(e){var t=this.__data__;if(ne){var n=t[e];return n===a?i:n}return eA.call(t,e)?t[e]:i},ng.prototype.has=function(e){var t=this.__data__;return ne?t[e]!==i:eA.call(t,e)},ng.prototype.set=function(e,t){var n=this.__data__;return this.size+=+!this.has(e),n[e]=ne&&t===i?a:t,this},nm.prototype.clear=function(){this.__data__=[],this.size=0},nm.prototype.delete=function(e){var t=this.__data__,n=nC(t,e);return!(n<0||(n==t.length-1?t.pop():ez.call(t,n,1),--this.size,0))},nm.prototype.get=function(e){var t=this.__data__,n=nC(t,e);return n<0?i:t[n][1]},nm.prototype.has=function(e){return nC(this.__data__,e)>-1},nm.prototype.set=function(e,t){var n=this.__data__,r=nC(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},ny.prototype.clear=function(){this.size=0,this.__data__={hash:new ng,map:new(t6||nm),string:new ng}},ny.prototype.delete=function(e){var t=ia(this,e).delete(e);return this.size-=!!t,t},ny.prototype.get=function(e){return ia(this,e).get(e)},ny.prototype.has=function(e){return ia(this,e).has(e)},ny.prototype.set=function(e,t){var n=ia(this,e),r=n.size;return n.set(e,t),this.size+=+(n.size!=r),this},n_.prototype.add=n_.prototype.push=function(e){return this.__data__.set(e,a),this},n_.prototype.has=function(e){return this.__data__.has(e)},nb.prototype.clear=function(){this.__data__=new nm,this.size=0},nb.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},nb.prototype.get=function(e){return this.__data__.get(e)},nb.prototype.has=function(e){return this.__data__.has(e)},nb.prototype.set=function(e,t){var n=this.__data__;if(n instanceof nm){var r=n.__data__;if(!t6||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new ny(r)}return n.set(e,t),this.size=n.size,this};var nO=rG(nW),nN=rG(nj,!0);function nU(e,t){var n=!0;return nO(e,function(e,r,i){return n=!!t(e,r,i)}),n}function nF(e,t,n){for(var r=-1,o=e.length;++r<o;){var a=e[r],s=t(a);if(null!=s&&(u===i?s==s&&!oZ(s):n(s,u)))var u=s,c=a}return c}function nB(e,t){var n=[];return nO(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function nV(e,t,n,r,i){var o=-1,a=e.length;for(n||(n=iv),i||(i=[]);++o<a;){var s=e[o];t>0&&n(s)?t>1?nV(s,t-1,n,r,i):tp(i,s):r||(i[i.length]=s)}return i}var nG=rH(),nH=rH(!0);function nW(e,t){return e&&nG(e,t,ac)}function nj(e,t){return e&&nH(e,t,ac)}function nz(e,t){return tl(t,function(t){return oB(e[t])})}function nK(e,t){for(var n=0,r=(t=rP(t,e)).length;null!=e&&n<r;)e=e[iO(t[n++])];return n&&n==r?e:i}function nQ(e,t,n){var r=t(e);return oD(e)?r:tp(r,n(e))}function nq(e){return null==e?e===i?"[object Undefined]":"[object Null]":e2&&e2 in eb(e)?function(e){var t=eA.call(e,e2),n=e[e2];try{e[e2]=i;var r=!0}catch(e){}var o=eD.call(e);return r&&(t?e[e2]=n:delete e[e2]),o}(e):eD.call(e)}function nY(e,t){return e>t}function nZ(e,t){return null!=e&&eA.call(e,t)}function nJ(e,t){return null!=e&&t in eb(e)}function nX(e,t,n){for(var o=n?td:tf,a=e[0].length,s=e.length,u=s,c=r(s),l=1/0,f=[];u--;){var d=e[u];u&&t&&(d=th(d,tL(t))),l=t0(d.length,l),c[u]=!n&&(t||a>=120&&d.length>=120)?new n_(u&&d):i}d=e[0];var h=-1,p=c[0];e:for(;++h<a&&f.length<l;){var v=d[h],g=t?t(v):v;if(v=n||0!==v?v:0,!(p?tx(p,g):o(f,g,n))){for(u=s;--u;){var m=c[u];if(!(m?tx(m,g):o(e[u],g,n)))continue e}p&&p.push(g),f.push(v)}}return f}function n$(e,t,n){var r=null==(e=iw(e,t=rP(t,e)))?e:e[iO(iq(t))];return null==r?i:ta(r,e,n)}function n0(e){return oW(e)&&nq(e)==f}function n1(e,t,n,r,o){return e===t||(null!=e&&null!=t&&(oW(e)||oW(t))?function(e,t,n,r,o,a){var s=oD(e),u=oD(t),c=s?d:id(e),l=u?d:id(t),g=(c=c==f?b:c)==b,m=(l=l==f?b:l)==b,E=c==l;if(E&&oN(e)){if(!oN(t))return!1;s=!0,g=!1}if(E&&!g)return a||(a=new nb),s||oJ(e)?r9(e,t,n,r,o,a):function(e,t,n,r,i,o,a){switch(n){case P:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case I:return!(e.byteLength!=t.byteLength||!o(new eF(e),new eF(t)));case h:case p:case _:return oP(+e,+t);case v:return e.name==t.name&&e.message==t.message;case S:case w:return e==t+"";case y:var s=tV;case T:var u=1&r;if(s||(s=tW),e.size!=t.size&&!u)break;var c=a.get(e);if(c)return c==t;r|=2,a.set(e,t);var l=r9(s(e),s(t),r,i,o,a);return a.delete(e),l;case C:if(nc)return nc.call(e)==nc.call(t)}return!1}(e,t,c,n,r,o,a);if(!(1&n)){var k=g&&eA.call(e,"__wrapped__"),A=m&&eA.call(t,"__wrapped__");if(k||A){var M=k?e.value():e,L=A?t.value():t;return a||(a=new nb),o(M,L,n,r,a)}}return!!E&&(a||(a=new nb),function(e,t,n,r,o,a){var s=1&n,u=nQ(e,ac,ic),c=u.length;if(c!=nQ(t,ac,ic).length&&!s)return!1;for(var l=c;l--;){var f=u[l];if(!(s?f in t:eA.call(t,f)))return!1}var d=a.get(e),h=a.get(t);if(d&&h)return d==t&&h==e;var p=!0;a.set(e,t),a.set(t,e);for(var v=s;++l<c;){var g=e[f=u[l]],m=t[f];if(r)var y=s?r(m,g,f,t,e,a):r(g,m,f,e,t,a);if(!(y===i?g===m||o(g,m,n,r,a):y)){p=!1;break}v||(v="constructor"==f)}if(p&&!v){var _=e.constructor,b=t.constructor;_==b||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof b&&b instanceof b||(p=!1)}return a.delete(e),a.delete(t),p}(e,t,n,r,o,a))}(e,t,n,r,n1,o):e!=e&&t!=t)}function n2(e,t,n,r){var o=n.length,a=o,s=!r;if(null==e)return!a;for(e=eb(e);o--;){var u=n[o];if(s&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++o<a;){var c=(u=n[o])[0],l=e[c],f=u[1];if(s&&u[2]){if(l===i&&!(c in e))return!1}else{var d=new nb;if(r)var h=r(l,f,c,e,t,d);if(!(h===i?n1(f,l,3,r,d):h))return!1}}return!0}function n3(e){return!(!oH(e)||eL&&eL in e)&&(oB(e)?eO:ef).test(iN(e))}function n4(e){return"function"==typeof e?e:null==e?aO:"object"==typeof e?oD(e)?n9(e[0],e[1]):n7(e):aj(e)}function n8(e){if(!iE(e))return tX(e);var t=[];for(var n in eb(e))eA.call(e,n)&&"constructor"!=n&&t.push(n);return t}function n6(e,t){return e<t}function n5(e,t){var n=-1,i=oR(e)?r(e.length):[];return nO(e,function(e,r,o){i[++n]=t(e,r,o)}),i}function n7(e){var t=is(e);return 1==t.length&&t[0][2]?iS(t[0][0],t[0][1]):function(n){return n===e||n2(n,e,t)}}function n9(e,t){var n;return iy(e)&&(n=t)==n&&!oH(n)?iS(iO(e),t):function(n){var r=ai(n,e);return r===i&&r===t?ao(n,e):n1(t,r,3)}}function re(e,t,n,r,o){e!==t&&nG(t,function(a,s){if(o||(o=new nb),oH(a))!function(e,t,n,r,o,a,s){var u=iC(e,n),c=iC(t,n),l=s.get(c);if(l)nT(e,n,l);else{var f=a?a(u,c,n+"",e,t,s):i,d=f===i;if(d){var h=oD(c),p=!h&&oN(c),v=!h&&!p&&oJ(c);f=c,h||p||v?oD(u)?f=u:oO(u)?f=rU(u):p?(d=!1,f=rL(c,!0)):v?(d=!1,f=rx(c,!0)):f=[]:oK(c)||oL(c)?(f=u,oL(u)?f=o8(u):oH(u)&&!oB(u)||(f=ip(c))):d=!1}d&&(s.set(c,f),o(f,c,r,a,s),s.delete(c)),nT(e,n,f)}}(e,t,s,n,re,r,o);else{var u=r?r(iC(e,s),a,s+"",e,t,o):i;u===i&&(u=a),nT(e,s,u)}},al)}function rt(e,t){var n=e.length;if(n)return ig(t+=t<0?n:0,n)?e[t]:i}function rn(e,t,n){t=t.length?th(t,function(e){return oD(e)?function(t){return nK(t,1===e.length?e[0]:e)}:e}):[aO];var r=-1;t=th(t,tL(io()));var i=n5(e,function(e,n,i){return{criteria:th(t,function(t){return t(e)}),index:++r,value:e}}),o=i.length;for(i.sort(function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,o=t.criteria,a=i.length,s=n.length;++r<a;){var u=rR(i[r],o[r]);if(u)return r>=s?u:u*("desc"==n[r]?-1:1)}return e.index-t.index}(e,t,n)});o--;)i[o]=i[o].value;return i}function rr(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=nK(e,a);n(s,a)&&rc(o,rP(a,e),s)}return o}function ri(e,t,n,r){var i=r?tS:tE,o=-1,a=t.length,s=e;for(e===t&&(t=rU(t)),n&&(s=th(e,tL(n)));++o<a;)for(var u=0,c=t[o],l=n?n(c):c;(u=i(s,l,u,r))>-1;)s!==e&&ez.call(s,u,1),ez.call(e,u,1);return e}function ro(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==o){var o=i;ig(i)?ez.call(e,i,1):rb(e,i)}}return e}function ra(e,t){return e+ty(t3()*(t-e+1))}function rs(e,t){var n="";if(!e||t<1||t>0x1fffffffffffff)return n;do t%2&&(n+=e),(t=ty(t/2))&&(e+=e);while(t);return n}function ru(e,t){return iP(iT(e,t,aO),e+"")}function rc(e,t,n,r){if(!oH(e))return e;for(var o=-1,a=(t=rP(t,e)).length,s=a-1,u=e;null!=u&&++o<a;){var c=iO(t[o]),l=n;if("__proto__"===c||"constructor"===c||"prototype"===c)break;if(o!=s){var f=u[c];(l=r?r(f,c,u):i)===i&&(l=oH(f)?f:ig(t[o+1])?[]:{})}nw(u,c,l),u=u[c]}return e}var rl=nt?function(e,t){return nt.set(e,t),e}:aO,rf=e3?function(e,t){return e3(e,"toString",{configurable:!0,enumerable:!1,value:aD(t),writable:!0})}:aO;function rd(e,t,n){var i=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var a=r(o);++i<o;)a[i]=e[i+t];return a}function rh(e,t){var n;return nO(e,function(e,r,i){return!(n=t(e,r,i))}),!!n}function rp(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=0x7fffffff){for(;r<i;){var o=r+i>>>1,a=e[o];null!==a&&!oZ(a)&&(n?a<=t:a<t)?r=o+1:i=o}return i}return rv(e,t,aO,n)}function rv(e,t,n,r){var o=0,a=null==e?0:e.length;if(0===a)return 0;for(var s=(t=n(t))!=t,u=null===t,c=oZ(t),l=t===i;o<a;){var f=ty((o+a)/2),d=n(e[f]),h=d!==i,p=null===d,v=d==d,g=oZ(d);if(s)var m=r||v;else m=l?v&&(r||h):u?v&&h&&(r||!p):c?v&&h&&!p&&(r||!g):!p&&!g&&(r?d<=t:d<t);m?o=f+1:a=f}return t0(a,0xfffffffe)}function rg(e,t){for(var n=-1,r=e.length,i=0,o=[];++n<r;){var a=e[n],s=t?t(a):a;if(!n||!oP(s,u)){var u=s;o[i++]=0===a?0:a}}return o}function rm(e){return"number"==typeof e?e:oZ(e)?c:+e}function ry(e){if("string"==typeof e)return e;if(oD(e))return th(e,ry)+"";if(oZ(e))return nl?nl.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function r_(e,t,n){var r=-1,i=tf,o=e.length,a=!0,s=[],u=s;if(n)a=!1,i=td;else if(o>=200){var c=t?null:r3(e);if(c)return tW(c);a=!1,i=tx,u=new n_}else u=t?[]:s;e:for(;++r<o;){var l=e[r],f=t?t(l):l;if(l=n||0!==l?l:0,a&&f==f){for(var d=u.length;d--;)if(u[d]===f)continue e;t&&u.push(f),s.push(l)}else i(u,f,n)||(u!==s&&u.push(f),s.push(l))}return s}function rb(e,t){return null==(e=iw(e,t=rP(t,e)))||delete e[iO(iq(t))]}function rE(e,t,n,r){return rc(e,t,n(nK(e,t)),r)}function rS(e,t,n,r){for(var i=e.length,o=r?i:-1;(r?o--:++o<i)&&t(e[o],o,e););return n?rd(e,r?0:o,r?o+1:i):rd(e,r?o+1:0,r?i:o)}function rT(e,t){var n=e;return n instanceof nv&&(n=n.value()),tv(t,function(e,t){return t.func.apply(t.thisArg,tp([e],t.args))},n)}function rw(e,t,n){var i=e.length;if(i<2)return i?r_(e[0]):[];for(var o=-1,a=r(i);++o<i;)for(var s=e[o],u=-1;++u<i;)u!=o&&(a[o]=nR(a[o]||s,e[u],t,n));return r_(nV(a,1),t,n)}function rC(e,t,n){for(var r=-1,o=e.length,a=t.length,s={};++r<o;){var u=r<a?t[r]:i;n(s,e[r],u)}return s}function rk(e){return oO(e)?e:[]}function rI(e){return"function"==typeof e?e:aO}function rP(e,t){return oD(e)?e:iy(e,t)?[e]:iR(o6(e))}function rA(e,t,n){var r=e.length;return n=n===i?r:n,!t&&n>=r?e:rd(e,t,n)}var rM=e8||function(e){return e4.clearTimeout(e)};function rL(e,t){if(t)return e.slice();var n=e.length,r=eB?eB(n):new e.constructor(n);return e.copy(r),r}function rD(e){var t=new e.constructor(e.byteLength);return new eF(t).set(new eF(e)),t}function rx(e,t){var n=t?rD(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function rR(e,t){if(e!==t){var n=e!==i,r=null===e,o=e==e,a=oZ(e),s=t!==i,u=null===t,c=t==t,l=oZ(t);if(!u&&!l&&!a&&e>t||a&&s&&c&&!u&&!l||r&&s&&c||!n&&c||!o)return 1;if(!r&&!a&&!l&&e<t||l&&n&&o&&!r&&!a||u&&n&&o||!s&&o||!c)return -1}return 0}function rO(e,t,n,i){for(var o=-1,a=e.length,s=n.length,u=-1,c=t.length,l=t$(a-s,0),f=r(c+l),d=!i;++u<c;)f[u]=t[u];for(;++o<s;)(d||o<a)&&(f[n[o]]=e[o]);for(;l--;)f[u++]=e[o++];return f}function rN(e,t,n,i){for(var o=-1,a=e.length,s=-1,u=n.length,c=-1,l=t.length,f=t$(a-u,0),d=r(f+l),h=!i;++o<f;)d[o]=e[o];for(var p=o;++c<l;)d[p+c]=t[c];for(;++s<u;)(h||o<a)&&(d[p+n[s]]=e[o++]);return d}function rU(e,t){var n=-1,i=e.length;for(t||(t=r(i));++n<i;)t[n]=e[n];return t}function rF(e,t,n,r){var o=!n;n||(n={});for(var a=-1,s=t.length;++a<s;){var u=t[a],c=r?r(n[u],e[u],u,n,e):i;c===i&&(c=e[u]),o?nP(n,u,c):nw(n,u,c)}return n}function rB(e,t){return function(n,r){var i=oD(n)?ts:nk,o=t?t():{};return i(n,e,io(r,2),o)}}function rV(e){return ru(function(t,n){var r=-1,o=n.length,a=o>1?n[o-1]:i,s=o>2?n[2]:i;for(a=e.length>3&&"function"==typeof a?(o--,a):i,s&&im(n[0],n[1],s)&&(a=o<3?i:a,o=1),t=eb(t);++r<o;){var u=n[r];u&&e(t,u,r,a)}return t})}function rG(e,t){return function(n,r){if(null==n)return n;if(!oR(n))return e(n,r);for(var i=n.length,o=t?i:-1,a=eb(n);(t?o--:++o<i)&&!1!==r(a[o],o,a););return n}}function rH(e){return function(t,n,r){for(var i=-1,o=eb(t),a=r(t),s=a.length;s--;){var u=a[e?s:++i];if(!1===n(o[u],u,o))break}return t}}function rW(e){return function(t){var n=tB(t=o6(t))?tz(t):i,r=n?n[0]:t.charAt(0),o=n?rA(n,1).join(""):t.slice(1);return r[e]()+o}}function rj(e){return function(t){return tv(aA(aE(t).replace(eW,"")),e,"")}}function rz(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=nd(e.prototype),r=e.apply(n,t);return oH(r)?r:n}}function rK(e){return function(t,n,r){var o=eb(t);if(!oR(t)){var a=io(n,3);t=ac(t),n=function(e){return a(o[e],e,o)}}var s=e(t,n,r);return s>-1?o[a?t[s]:s]:i}}function rQ(e){return ie(function(t){var n=t.length,r=n,a=np.prototype.thru;for(e&&t.reverse();r--;){var s=t[r];if("function"!=typeof s)throw new eT(o);if(a&&!u&&"wrapper"==ir(s))var u=new np([],!0)}for(r=u?r:n;++r<n;){var c=ir(s=t[r]),l="wrapper"==c?it(s):i;u=l&&i_(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?u[ir(l[0])].apply(u,l[3]):1==s.length&&i_(s)?u[c]():u.thru(s)}return function(){var e=arguments,r=e[0];if(u&&1==e.length&&oD(r))return u.plant(r).value();for(var i=0,o=n?t[i].apply(this,e):r;++i<n;)o=t[i].call(this,o);return o}})}function rq(e,t,n,o,a,s,u,c,l,f){var d=128&t,h=1&t,p=2&t,v=24&t,g=512&t,m=p?i:rz(e);return function y(){for(var _=arguments.length,b=r(_),E=_;E--;)b[E]=arguments[E];if(v)var S=ii(y),T=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(b,S);if(o&&(b=rO(b,o,a,v)),s&&(b=rN(b,s,u,v)),_-=T,v&&_<f){var w=tH(b,S);return r1(e,t,rq,y.placeholder,n,b,w,c,l,f-_)}var C=h?n:this,k=p?C[e]:e;return _=b.length,c?b=function(e,t){for(var n=e.length,r=t0(t.length,n),o=rU(e);r--;){var a=t[r];e[r]=ig(a,n)?o[a]:i}return e}(b,c):g&&_>1&&b.reverse(),d&&l<_&&(b.length=l),this&&this!==e4&&this instanceof y&&(k=m||rz(k)),k.apply(C,b)}}function rY(e,t){return function(n,r){var i,o;return i=t(r),o={},nW(n,function(t,n,r){e(o,i(t),n,r)}),o}}function rZ(e,t){return function(n,r){var o;if(n===i&&r===i)return t;if(n!==i&&(o=n),r!==i){if(o===i)return r;"string"==typeof n||"string"==typeof r?(n=ry(n),r=ry(r)):(n=rm(n),r=rm(r)),o=e(n,r)}return o}}function rJ(e){return ie(function(t){return t=th(t,tL(io())),ru(function(n){var r=this;return e(t,function(e){return ta(e,r,n)})})})}function rX(e,t){var n=(t=t===i?" ":ry(t)).length;if(n<2)return n?rs(t,e):t;var r=rs(t,e9(e/tj(t)));return tB(t)?rA(tz(r),0,e).join(""):r.slice(0,e)}function r$(e){return function(t,n,o){return o&&"number"!=typeof o&&im(t,n,o)&&(n=o=i),t=o1(t),n===i?(n=t,t=0):n=o1(n),function(e,t,n,i){for(var o=-1,a=t$(e9((t-e)/(n||1)),0),s=r(a);a--;)s[i?a:++o]=e,e+=n;return s}(t,n,o=o===i?t<n?1:-1:o1(o),e)}}function r0(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=o4(t),n=o4(n)),e(t,n)}}function r1(e,t,n,r,o,a,s,u,c,l){var f=8&t;t|=f?32:64,4&(t&=~(f?64:32))||(t&=-4);var d=[e,t,o,f?a:i,f?s:i,f?i:a,f?i:s,u,c,l],h=n.apply(i,d);return i_(e)&&ik(h,d),h.placeholder=r,iA(h,e,t)}function r2(e){var t=e_[e];return function(e,n){if(e=o4(e),(n=null==n?0:t0(o2(n),292))&&tZ(e)){var r=(o6(e)+"e").split("e");return+((r=(o6(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(r[1]-n))}return t(e)}}var r3=t7&&1/tW(new t7([,-0]))[1]==u?function(e){return new t7(e)}:aV;function r4(e){return function(t){var n,r,i=id(t);return i==y?tV(t):i==T?(n=-1,r=Array(t.size),t.forEach(function(e){r[++n]=[e,e]}),r):th(e(t),function(e){return[e,t[e]]})}}function r8(e,t,n,a,u,c,l,f){var d=2&t;if(!d&&"function"!=typeof e)throw new eT(o);var h=a?a.length:0;if(h||(t&=-97,a=u=i),l=l===i?l:t$(o2(l),0),f=f===i?f:o2(f),h-=u?u.length:0,64&t){var p=a,v=u;a=u=i}var g=d?i:it(e),m=[e,t,n,a,u,p,v,c,l,f];if(g&&function(e,t){var n=e[1],r=t[1],i=n|r,o=i<131,a=128==r&&8==n||128==r&&256==n&&e[7].length<=t[8]||384==r&&t[7].length<=t[8]&&8==n;if(o||a){1&r&&(e[2]=t[2],i|=1&n?0:4);var u=t[3];if(u){var c=e[3];e[3]=c?rO(c,u,t[4]):u,e[4]=c?tH(e[3],s):t[4]}(u=t[5])&&(c=e[5],e[5]=c?rN(c,u,t[6]):u,e[6]=c?tH(e[5],s):t[6]),(u=t[7])&&(e[7]=u),128&r&&(e[8]=null==e[8]?t[8]:t0(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}}(m,g),e=m[0],t=m[1],n=m[2],a=m[3],u=m[4],(f=m[9]=m[9]===i?d?0:e.length:t$(m[9]-h,0))||!(24&t)||(t&=-25),t&&1!=t)x=8==t||16==t?(y=e,_=t,b=f,E=rz(y),function e(){for(var t=arguments.length,n=r(t),o=t,a=ii(e);o--;)n[o]=arguments[o];var s=t<3&&n[0]!==a&&n[t-1]!==a?[]:tH(n,a);return(t-=s.length)<b?r1(y,_,rq,e.placeholder,i,n,s,i,i,b-t):ta(this&&this!==e4&&this instanceof e?E:y,this,n)}):32!=t&&33!=t||u.length?rq.apply(i,m):(S=e,T=t,w=n,C=a,k=1&T,I=rz(S),function e(){for(var t=-1,n=arguments.length,i=-1,o=C.length,a=r(o+n),s=this&&this!==e4&&this instanceof e?I:S;++i<o;)a[i]=C[i];for(;n--;)a[i++]=arguments[++t];return ta(s,k?w:this,a)});else var y,_,b,E,S,T,w,C,k,I,P,A,M,L,D,x=(P=e,A=t,M=n,L=1&A,D=rz(P),function e(){return(this&&this!==e4&&this instanceof e?D:P).apply(L?M:this,arguments)});return iA((g?rl:ik)(x,m),e,t)}function r6(e,t,n,r){return e===i||oP(e,ek[n])&&!eA.call(r,n)?t:e}function r5(e,t,n,r,o,a){return oH(e)&&oH(t)&&(a.set(t,e),re(e,t,i,r5,a),a.delete(t)),e}function r7(e){return oK(e)?i:e}function r9(e,t,n,r,o,a){var s=1&n,u=e.length,c=t.length;if(u!=c&&!(s&&c>u))return!1;var l=a.get(e),f=a.get(t);if(l&&f)return l==t&&f==e;var d=-1,h=!0,p=2&n?new n_:i;for(a.set(e,t),a.set(t,e);++d<u;){var v=e[d],g=t[d];if(r)var m=s?r(g,v,d,t,e,a):r(v,g,d,e,t,a);if(m!==i){if(m)continue;h=!1;break}if(p){if(!tm(t,function(e,t){if(!tx(p,t)&&(v===e||o(v,e,n,r,a)))return p.push(t)})){h=!1;break}}else if(v!==g&&!o(v,g,n,r,a)){h=!1;break}}return a.delete(e),a.delete(t),h}function ie(e){return iP(iT(e,i,iW),e+"")}var it=nt?function(e){return nt.get(e)}:aV;function ir(e){for(var t=e.name+"",n=nn[t],r=eA.call(nn,t)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==e)return i.name}return t}function ii(e){return(eA.call(nf,"placeholder")?nf:e).placeholder}function io(){var e=nf.iteratee||aN;return e=e===aN?n4:e,arguments.length?e(arguments[0],arguments[1]):e}function ia(e,t){var n,r=e.__data__;return("string"==(n=typeof t)||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==t:null===t)?r["string"==typeof t?"string":"hash"]:r.map}function is(e){for(var t=ac(e),n=t.length;n--;){var r,i=t[n],o=e[i];t[n]=[i,o,(r=o)==r&&!oH(r)]}return t}function iu(e,t){var n=null==e?i:e[t];return n3(n)?n:i}var ic=tk?function(e){return null==e?[]:tl(tk(e=eb(e)),function(t){return eH.call(e,t)})}:aQ,il=tk?function(e){for(var t=[];e;)tp(t,ic(e)),e=eV(e);return t}:aQ,id=nq;function ih(e,t,n){for(var r=-1,i=(t=rP(t,e)).length,o=!1;++r<i;){var a=iO(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&oG(i)&&ig(a,i)&&(oD(e)||oL(e))}function ip(e){return"function"!=typeof e.constructor||iE(e)?{}:nd(eV(e))}function iv(e){return oD(e)||oL(e)||!!(eQ&&e&&e[eQ])}function ig(e,t){var n=typeof e;return!!(t=null==t?0x1fffffffffffff:t)&&("number"==n||"symbol"!=n&&eh.test(e))&&e>-1&&e%1==0&&e<t}function im(e,t,n){if(!oH(n))return!1;var r=typeof t;return!!("number"==r?oR(n)&&ig(t,n.length):"string"==r&&t in n)&&oP(n[t],e)}function iy(e,t){if(oD(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!oZ(e))||Y.test(e)||!q.test(e)||null!=t&&e in eb(t)}function i_(e){var t=ir(e),n=nf[t];if("function"!=typeof n||!(t in nv.prototype))return!1;if(e===n)return!0;var r=it(n);return!!r&&e===r[0]}(t8&&id(new t8(new ArrayBuffer(1)))!=P||t6&&id(new t6)!=y||t5&&id(t5.resolve())!=E||t7&&id(new t7)!=T||t9&&id(new t9)!=k)&&(id=function(e){var t=nq(e),n=t==b?e.constructor:i,r=n?iN(n):"";if(r)switch(r){case nr:return P;case ni:return y;case no:return E;case na:return T;case ns:return k}return t});var ib=eI?oB:aq;function iE(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||ek)}function iS(e,t){return function(n){return null!=n&&n[e]===t&&(t!==i||e in eb(n))}}function iT(e,t,n){return t=t$(t===i?e.length-1:t,0),function(){for(var i=arguments,o=-1,a=t$(i.length-t,0),s=r(a);++o<a;)s[o]=i[t+o];o=-1;for(var u=r(t+1);++o<t;)u[o]=i[o];return u[t]=n(s),ta(e,this,u)}}function iw(e,t){return t.length<2?e:nK(e,rd(t,0,-1))}function iC(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var ik=iM(rl),iI=e7||function(e,t){return e4.setTimeout(e,t)},iP=iM(rf);function iA(e,t,n){var r,i,o=t+"";return iP(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(et,"{\n/* [wrapped with "+t+"] */\n")}(o,(i=(r=o.match(en))?r[1].split(er):[],tu(l,function(e){var t="_."+e[0];n&e[1]&&!tf(i,t)&&i.push(t)}),i.sort())))}function iM(e){var t=0,n=0;return function(){var r=t1(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(i,arguments)}}function iL(e,t){var n=-1,r=e.length,o=r-1;for(t=t===i?r:t;++n<t;){var a=ra(n,o),s=e[a];e[a]=e[n],e[n]=s}return e.length=t,e}var iD,ix,iR=(ix=(iD=oS(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Z,function(e,n,r,i){t.push(r?i.replace(ea,"$1"):n||e)}),t},function(e){return 500===ix.size&&ix.clear(),e})).cache,iD);function iO(e){if("string"==typeof e||oZ(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function iN(e){if(null!=e){try{return eP.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function iU(e){if(e instanceof nv)return e.clone();var t=new np(e.__wrapped__,e.__chain__);return t.__actions__=rU(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var iF=ru(function(e,t){return oO(e)?nR(e,nV(t,1,oO,!0)):[]}),iB=ru(function(e,t){var n=iq(t);return oO(n)&&(n=i),oO(e)?nR(e,nV(t,1,oO,!0),io(n,2)):[]}),iV=ru(function(e,t){var n=iq(t);return oO(n)&&(n=i),oO(e)?nR(e,nV(t,1,oO,!0),i,n):[]});function iG(e,t,n){var r=null==e?0:e.length;if(!r)return -1;var i=null==n?0:o2(n);return i<0&&(i=t$(r+i,0)),tb(e,io(t,3),i)}function iH(e,t,n){var r=null==e?0:e.length;if(!r)return -1;var o=r-1;return n!==i&&(o=o2(n),o=n<0?t$(r+o,0):t0(o,r-1)),tb(e,io(t,3),o,!0)}function iW(e){return null!=e&&e.length?nV(e,1):[]}function ij(e){return e&&e.length?e[0]:i}var iz=ru(function(e){var t=th(e,rk);return t.length&&t[0]===e[0]?nX(t):[]}),iK=ru(function(e){var t=iq(e),n=th(e,rk);return t===iq(n)?t=i:n.pop(),n.length&&n[0]===e[0]?nX(n,io(t,2)):[]}),iQ=ru(function(e){var t=iq(e),n=th(e,rk);return(t="function"==typeof t?t:i)&&n.pop(),n.length&&n[0]===e[0]?nX(n,i,t):[]});function iq(e){var t=null==e?0:e.length;return t?e[t-1]:i}var iY=ru(iZ);function iZ(e,t){return e&&e.length&&t&&t.length?ri(e,t):e}var iJ=ie(function(e,t){var n=null==e?0:e.length,r=nA(e,t);return ro(e,th(t,function(e){return ig(e,n)?+e:e}).sort(rR)),r});function iX(e){return null==e?e:t4.call(e)}var i$=ru(function(e){return r_(nV(e,1,oO,!0))}),i0=ru(function(e){var t=iq(e);return oO(t)&&(t=i),r_(nV(e,1,oO,!0),io(t,2))}),i1=ru(function(e){var t=iq(e);return t="function"==typeof t?t:i,r_(nV(e,1,oO,!0),i,t)});function i2(e){if(!e||!e.length)return[];var t=0;return e=tl(e,function(e){if(oO(e))return t=t$(e.length,t),!0}),tA(t,function(t){return th(e,tC(t))})}function i3(e,t){if(!e||!e.length)return[];var n=i2(e);return null==t?n:th(n,function(e){return ta(t,i,e)})}var i4=ru(function(e,t){return oO(e)?nR(e,t):[]}),i8=ru(function(e){return rw(tl(e,oO))}),i6=ru(function(e){var t=iq(e);return oO(t)&&(t=i),rw(tl(e,oO),io(t,2))}),i5=ru(function(e){var t=iq(e);return t="function"==typeof t?t:i,rw(tl(e,oO),i,t)}),i7=ru(i2),i9=ru(function(e){var t=e.length,n=t>1?e[t-1]:i;return n="function"==typeof n?(e.pop(),n):i,i3(e,n)});function oe(e){var t=nf(e);return t.__chain__=!0,t}function ot(e,t){return t(e)}var on=ie(function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,o=function(t){return nA(t,e)};return!(t>1||this.__actions__.length)&&r instanceof nv&&ig(n)?((r=r.slice(n,+n+ +!!t)).__actions__.push({func:ot,args:[o],thisArg:i}),new np(r,this.__chain__).thru(function(e){return t&&!e.length&&e.push(i),e})):this.thru(o)}),or=rB(function(e,t,n){eA.call(e,n)?++e[n]:nP(e,n,1)}),oi=rK(iG),oo=rK(iH);function oa(e,t){return(oD(e)?tu:nO)(e,io(t,3))}function os(e,t){return(oD(e)?function(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}:nN)(e,io(t,3))}var ou=rB(function(e,t,n){eA.call(e,n)?e[n].push(t):nP(e,n,[t])}),oc=ru(function(e,t,n){var i=-1,o="function"==typeof t,a=oR(e)?r(e.length):[];return nO(e,function(e){a[++i]=o?ta(t,e,n):n$(e,t,n)}),a}),ol=rB(function(e,t,n){nP(e,n,t)});function of(e,t){return(oD(e)?th:n5)(e,io(t,3))}var od=rB(function(e,t,n){e[+!n].push(t)},function(){return[[],[]]}),oh=ru(function(e,t){if(null==e)return[];var n=t.length;return n>1&&im(e,t[0],t[1])?t=[]:n>2&&im(t[0],t[1],t[2])&&(t=[t[0]]),rn(e,nV(t,1),[])}),op=e6||function(){return e4.Date.now()};function ov(e,t,n){return t=n?i:t,t=e&&null==t?e.length:t,r8(e,128,i,i,i,i,t)}function og(e,t){var n;if("function"!=typeof t)throw new eT(o);return e=o2(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=i),n}}var om=ru(function(e,t,n){var r=1;if(n.length){var i=tH(n,ii(om));r|=32}return r8(e,r,t,n,i)}),oy=ru(function(e,t,n){var r=3;if(n.length){var i=tH(n,ii(oy));r|=32}return r8(t,r,e,n,i)});function o_(e,t,n){var r,a,s,u,c,l,f=0,d=!1,h=!1,p=!0;if("function"!=typeof e)throw new eT(o);function v(t){var n=r,o=a;return r=a=i,f=t,u=e.apply(o,n)}function g(e){var n=e-l;return l===i||n>=t||n<0||h&&e-f>=s}function m(){var e,n=op();if(g(n))return y(n);c=iI(m,(e=t-(n-l),h?t0(e,s-(n-f)):e))}function y(e){return c=i,p&&r?v(e):(r=a=i,u)}function _(){var e,n=op(),o=g(n);if(r=arguments,a=this,l=n,o){if(c===i)return f=e=l,c=iI(m,t),d?v(e):u;if(h)return rM(c),c=iI(m,t),v(l)}return c===i&&(c=iI(m,t)),u}return t=o4(t)||0,oH(n)&&(d=!!n.leading,s=(h="maxWait"in n)?t$(o4(n.maxWait)||0,t):s,p="trailing"in n?!!n.trailing:p),_.cancel=function(){c!==i&&rM(c),f=0,r=l=a=c=i},_.flush=function(){return c===i?u:y(op())},_}var ob=ru(function(e,t){return nx(e,1,t)}),oE=ru(function(e,t,n){return nx(e,o4(t)||0,n)});function oS(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new eT(o);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(oS.Cache||ny),n}function oT(e){if("function"!=typeof e)throw new eT(o);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}oS.Cache=ny;var ow=ru(function(e,t){var n=(t=1==t.length&&oD(t[0])?th(t[0],tL(io())):th(nV(t,1),tL(io()))).length;return ru(function(r){for(var i=-1,o=t0(r.length,n);++i<o;)r[i]=t[i].call(this,r[i]);return ta(e,this,r)})}),oC=ru(function(e,t){var n=tH(t,ii(oC));return r8(e,32,i,t,n)}),ok=ru(function(e,t){var n=tH(t,ii(ok));return r8(e,64,i,t,n)}),oI=ie(function(e,t){return r8(e,256,i,i,i,t)});function oP(e,t){return e===t||e!=e&&t!=t}var oA=r0(nY),oM=r0(function(e,t){return e>=t}),oL=n0(function(){return arguments}())?n0:function(e){return oW(e)&&eA.call(e,"callee")&&!eH.call(e,"callee")},oD=r.isArray,ox=te?tL(te):function(e){return oW(e)&&nq(e)==I};function oR(e){return null!=e&&oG(e.length)&&!oB(e)}function oO(e){return oW(e)&&oR(e)}var oN=tY||aq,oU=tt?tL(tt):function(e){return oW(e)&&nq(e)==p};function oF(e){if(!oW(e))return!1;var t=nq(e);return t==v||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!oK(e)}function oB(e){if(!oH(e))return!1;var t=nq(e);return t==g||t==m||"[object AsyncFunction]"==t||"[object Proxy]"==t}function oV(e){return"number"==typeof e&&e==o2(e)}function oG(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff}function oH(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function oW(e){return null!=e&&"object"==typeof e}var oj=tn?tL(tn):function(e){return oW(e)&&id(e)==y};function oz(e){return"number"==typeof e||oW(e)&&nq(e)==_}function oK(e){if(!oW(e)||nq(e)!=b)return!1;var t=eV(e);if(null===t)return!0;var n=eA.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&eP.call(n)==ex}var oQ=tr?tL(tr):function(e){return oW(e)&&nq(e)==S},oq=ti?tL(ti):function(e){return oW(e)&&id(e)==T};function oY(e){return"string"==typeof e||!oD(e)&&oW(e)&&nq(e)==w}function oZ(e){return"symbol"==typeof e||oW(e)&&nq(e)==C}var oJ=to?tL(to):function(e){return oW(e)&&oG(e.length)&&!!eJ[nq(e)]},oX=r0(n6),o$=r0(function(e,t){return e<=t});function o0(e){if(!e)return[];if(oR(e))return oY(e)?tz(e):rU(e);if(e$&&e[e$]){for(var t,n=e[e$](),r=[];!(t=n.next()).done;)r.push(t.value);return r}var i=id(e);return(i==y?tV:i==T?tW:ay)(e)}function o1(e){return e?(e=o4(e))===u||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function o2(e){var t=o1(e),n=t%1;return t==t?n?t-n:t:0}function o3(e){return e?nM(o2(e),0,0xffffffff):0}function o4(e){if("number"==typeof e)return e;if(oZ(e))return c;if(oH(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=oH(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=tM(e);var n=el.test(e);return n||ed.test(e)?e1(e.slice(2),n?2:8):ec.test(e)?c:+e}function o8(e){return rF(e,al(e))}function o6(e){return null==e?"":ry(e)}var o5=rV(function(e,t){if(iE(t)||oR(t))rF(t,ac(t),e);else for(var n in t)eA.call(t,n)&&nw(e,n,t[n])}),o7=rV(function(e,t){rF(t,al(t),e)}),o9=rV(function(e,t,n,r){rF(t,al(t),e,r)}),ae=rV(function(e,t,n,r){rF(t,ac(t),e,r)}),at=ie(nA),an=ru(function(e,t){e=eb(e);var n=-1,r=t.length,o=r>2?t[2]:i;for(o&&im(t[0],t[1],o)&&(r=1);++n<r;)for(var a=t[n],s=al(a),u=-1,c=s.length;++u<c;){var l=s[u],f=e[l];(f===i||oP(f,ek[l])&&!eA.call(e,l))&&(e[l]=a[l])}return e}),ar=ru(function(e){return e.push(i,r5),ta(ad,i,e)});function ai(e,t,n){var r=null==e?i:nK(e,t);return r===i?n:r}function ao(e,t){return null!=e&&ih(e,t,nJ)}var aa=rY(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=eD.call(t)),e[t]=n},aD(aO)),as=rY(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=eD.call(t)),eA.call(e,t)?e[t].push(n):e[t]=[n]},io),au=ru(n$);function ac(e){return oR(e)?nE(e):n8(e)}function al(e){return oR(e)?nE(e,!0):function(e){if(!oH(e)){var t=[];if(null!=e)for(var n in eb(e))t.push(n);return t}var r=iE(e),i=[];for(var o in e)("constructor"!=o||!r&&eA.call(e,o))&&i.push(o);return i}(e)}var af=rV(function(e,t,n){re(e,t,n)}),ad=rV(function(e,t,n,r){re(e,t,n,r)}),ah=ie(function(e,t){var n={};if(null==e)return n;var r=!1;t=th(t,function(t){return t=rP(t,e),r||(r=t.length>1),t}),rF(e,nQ(e,al,il),n),r&&(n=nL(n,7,r7));for(var i=t.length;i--;)rb(n,t[i]);return n}),ap=ie(function(e,t){return null==e?{}:rr(e,t,function(t,n){return ao(e,n)})});function av(e,t){if(null==e)return{};var n=th(nQ(e,al,il),function(e){return[e]});return t=io(t),rr(e,n,function(e,n){return t(e,n[0])})}var ag=r4(ac),am=r4(al);function ay(e){return null==e?[]:tD(e,ac(e))}var a_=rj(function(e,t,n){return t=t.toLowerCase(),e+(n?ab(t):t)});function ab(e){return aP(o6(e).toLowerCase())}function aE(e){return(e=o6(e))&&e.replace(ep,tN).replace(ej,"")}var aS=rj(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),aT=rj(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),aw=rW("toLowerCase"),aC=rj(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}),ak=rj(function(e,t,n){return e+(n?" ":"")+aP(t)}),aI=rj(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),aP=rW("toUpperCase");function aA(e,t,n){var r;return e=o6(e),(t=n?i:t)===i?(r=e,eq.test(r))?e.match(eK)||[]:e.match(ei)||[]:e.match(t)||[]}var aM=ru(function(e,t){try{return ta(e,i,t)}catch(e){return oF(e)?e:new em(e)}}),aL=ie(function(e,t){return tu(t,function(t){nP(e,t=iO(t),om(e[t],e))}),e});function aD(e){return function(){return e}}var ax=rQ(),aR=rQ(!0);function aO(e){return e}function aN(e){return n4("function"==typeof e?e:nL(e,1))}var aU=ru(function(e,t){return function(n){return n$(n,e,t)}}),aF=ru(function(e,t){return function(n){return n$(e,n,t)}});function aB(e,t,n){var r=ac(t),i=nz(t,r);null!=n||oH(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=nz(t,ac(t)));var o=!(oH(n)&&"chain"in n&&!n.chain),a=oB(e);return tu(i,function(n){var r=t[n];e[n]=r,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=rU(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,tp([this.value()],arguments))})}),e}function aV(){}var aG=rJ(th),aH=rJ(tc),aW=rJ(tm);function aj(e){return iy(e)?tC(iO(e)):function(t){return nK(t,e)}}var az=r$(),aK=r$(!0);function aQ(){return[]}function aq(){return!1}var aY,aZ=rZ(function(e,t){return e+t},0),aJ=r2("ceil"),aX=rZ(function(e,t){return e/t},1),a$=r2("floor"),a0=rZ(function(e,t){return e*t},1),a1=r2("round"),a2=rZ(function(e,t){return e-t},0);return nf.after=function(e,t){if("function"!=typeof t)throw new eT(o);return e=o2(e),function(){if(--e<1)return t.apply(this,arguments)}},nf.ary=ov,nf.assign=o5,nf.assignIn=o7,nf.assignInWith=o9,nf.assignWith=ae,nf.at=at,nf.before=og,nf.bind=om,nf.bindAll=aL,nf.bindKey=oy,nf.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return oD(e)?e:[e]},nf.chain=oe,nf.chunk=function(e,t,n){t=(n?im(e,t,n):t===i)?1:t$(o2(t),0);var o=null==e?0:e.length;if(!o||t<1)return[];for(var a=0,s=0,u=r(e9(o/t));a<o;)u[s++]=rd(e,a,a+=t);return u},nf.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var o=e[t];o&&(i[r++]=o)}return i},nf.concat=function(){var e=arguments.length;if(!e)return[];for(var t=r(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return tp(oD(n)?rU(n):[n],nV(t,1))},nf.cond=function(e){var t=null==e?0:e.length,n=io();return e=t?th(e,function(e){if("function"!=typeof e[1])throw new eT(o);return[n(e[0]),e[1]]}):[],ru(function(n){for(var r=-1;++r<t;){var i=e[r];if(ta(i[0],this,n))return ta(i[1],this,n)}})},nf.conforms=function(e){var t,n;return n=ac(t=nL(e,1)),function(e){return nD(e,t,n)}},nf.constant=aD,nf.countBy=or,nf.create=function(e,t){var n=nd(e);return null==t?n:nI(n,t)},nf.curry=function e(t,n,r){var o=r8(t,8,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},nf.curryRight=function e(t,n,r){var o=r8(t,16,i,i,i,i,i,n=r?i:n);return o.placeholder=e.placeholder,o},nf.debounce=o_,nf.defaults=an,nf.defaultsDeep=ar,nf.defer=ob,nf.delay=oE,nf.difference=iF,nf.differenceBy=iB,nf.differenceWith=iV,nf.drop=function(e,t,n){var r=null==e?0:e.length;return r?rd(e,(t=n||t===i?1:o2(t))<0?0:t,r):[]},nf.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?rd(e,0,(t=r-(t=n||t===i?1:o2(t)))<0?0:t):[]},nf.dropRightWhile=function(e,t){return e&&e.length?rS(e,io(t,3),!0,!0):[]},nf.dropWhile=function(e,t){return e&&e.length?rS(e,io(t,3),!0):[]},nf.fill=function(e,t,n,r){var o=null==e?0:e.length;return o?(n&&"number"!=typeof n&&im(e,t,n)&&(n=0,r=o),function(e,t,n,r){var o=e.length;for((n=o2(n))<0&&(n=-n>o?0:o+n),(r=r===i||r>o?o:o2(r))<0&&(r+=o),r=n>r?0:o3(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},nf.filter=function(e,t){return(oD(e)?tl:nB)(e,io(t,3))},nf.flatMap=function(e,t){return nV(of(e,t),1)},nf.flatMapDeep=function(e,t){return nV(of(e,t),u)},nf.flatMapDepth=function(e,t,n){return n=n===i?1:o2(n),nV(of(e,t),n)},nf.flatten=iW,nf.flattenDeep=function(e){return null!=e&&e.length?nV(e,u):[]},nf.flattenDepth=function(e,t){return null!=e&&e.length?nV(e,t=t===i?1:o2(t)):[]},nf.flip=function(e){return r8(e,512)},nf.flow=ax,nf.flowRight=aR,nf.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},nf.functions=function(e){return null==e?[]:nz(e,ac(e))},nf.functionsIn=function(e){return null==e?[]:nz(e,al(e))},nf.groupBy=ou,nf.initial=function(e){return null!=e&&e.length?rd(e,0,-1):[]},nf.intersection=iz,nf.intersectionBy=iK,nf.intersectionWith=iQ,nf.invert=aa,nf.invertBy=as,nf.invokeMap=oc,nf.iteratee=aN,nf.keyBy=ol,nf.keys=ac,nf.keysIn=al,nf.map=of,nf.mapKeys=function(e,t){var n={};return t=io(t,3),nW(e,function(e,r,i){nP(n,t(e,r,i),e)}),n},nf.mapValues=function(e,t){var n={};return t=io(t,3),nW(e,function(e,r,i){nP(n,r,t(e,r,i))}),n},nf.matches=function(e){return n7(nL(e,1))},nf.matchesProperty=function(e,t){return n9(e,nL(t,1))},nf.memoize=oS,nf.merge=af,nf.mergeWith=ad,nf.method=aU,nf.methodOf=aF,nf.mixin=aB,nf.negate=oT,nf.nthArg=function(e){return e=o2(e),ru(function(t){return rt(t,e)})},nf.omit=ah,nf.omitBy=function(e,t){return av(e,oT(io(t)))},nf.once=function(e){return og(2,e)},nf.orderBy=function(e,t,n,r){return null==e?[]:(oD(t)||(t=null==t?[]:[t]),oD(n=r?i:n)||(n=null==n?[]:[n]),rn(e,t,n))},nf.over=aG,nf.overArgs=ow,nf.overEvery=aH,nf.overSome=aW,nf.partial=oC,nf.partialRight=ok,nf.partition=od,nf.pick=ap,nf.pickBy=av,nf.property=aj,nf.propertyOf=function(e){return function(t){return null==e?i:nK(e,t)}},nf.pull=iY,nf.pullAll=iZ,nf.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?ri(e,t,io(n,2)):e},nf.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?ri(e,t,i,n):e},nf.pullAt=iJ,nf.range=az,nf.rangeRight=aK,nf.rearg=oI,nf.reject=function(e,t){return(oD(e)?tl:nB)(e,oT(io(t,3)))},nf.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],o=e.length;for(t=io(t,3);++r<o;){var a=e[r];t(a,r,e)&&(n.push(a),i.push(r))}return ro(e,i),n},nf.rest=function(e,t){if("function"!=typeof e)throw new eT(o);return ru(e,t=t===i?t:o2(t))},nf.reverse=iX,nf.sampleSize=function(e,t,n){return t=(n?im(e,t,n):t===i)?1:o2(t),(oD(e)?function(e,t){return iL(rU(e),nM(t,0,e.length))}:function(e,t){var n=ay(e);return iL(n,nM(t,0,n.length))})(e,t)},nf.set=function(e,t,n){return null==e?e:rc(e,t,n)},nf.setWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:rc(e,t,n,r)},nf.shuffle=function(e){return(oD(e)?function(e){return iL(rU(e))}:function(e){return iL(ay(e))})(e)},nf.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&im(e,t,n)?(t=0,n=r):(t=null==t?0:o2(t),n=n===i?r:o2(n)),rd(e,t,n)):[]},nf.sortBy=oh,nf.sortedUniq=function(e){return e&&e.length?rg(e):[]},nf.sortedUniqBy=function(e,t){return e&&e.length?rg(e,io(t,2)):[]},nf.split=function(e,t,n){return n&&"number"!=typeof n&&im(e,t,n)&&(t=n=i),(n=n===i?0xffffffff:n>>>0)?(e=o6(e))&&("string"==typeof t||null!=t&&!oQ(t))&&!(t=ry(t))&&tB(e)?rA(tz(e),0,n):e.split(t,n):[]},nf.spread=function(e,t){if("function"!=typeof e)throw new eT(o);return t=null==t?0:t$(o2(t),0),ru(function(n){var r=n[t],i=rA(n,0,t);return r&&tp(i,r),ta(e,this,i)})},nf.tail=function(e){var t=null==e?0:e.length;return t?rd(e,1,t):[]},nf.take=function(e,t,n){return e&&e.length?rd(e,0,(t=n||t===i?1:o2(t))<0?0:t):[]},nf.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?rd(e,(t=r-(t=n||t===i?1:o2(t)))<0?0:t,r):[]},nf.takeRightWhile=function(e,t){return e&&e.length?rS(e,io(t,3),!1,!0):[]},nf.takeWhile=function(e,t){return e&&e.length?rS(e,io(t,3)):[]},nf.tap=function(e,t){return t(e),e},nf.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new eT(o);return oH(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),o_(e,t,{leading:r,maxWait:t,trailing:i})},nf.thru=ot,nf.toArray=o0,nf.toPairs=ag,nf.toPairsIn=am,nf.toPath=function(e){return oD(e)?th(e,iO):oZ(e)?[e]:rU(iR(o6(e)))},nf.toPlainObject=o8,nf.transform=function(e,t,n){var r=oD(e),i=r||oN(e)||oJ(e);if(t=io(t,4),null==n){var o=e&&e.constructor;n=i?r?new o:[]:oH(e)&&oB(o)?nd(eV(e)):{}}return(i?tu:nW)(e,function(e,r,i){return t(n,e,r,i)}),n},nf.unary=function(e){return ov(e,1)},nf.union=i$,nf.unionBy=i0,nf.unionWith=i1,nf.uniq=function(e){return e&&e.length?r_(e):[]},nf.uniqBy=function(e,t){return e&&e.length?r_(e,io(t,2)):[]},nf.uniqWith=function(e,t){return t="function"==typeof t?t:i,e&&e.length?r_(e,i,t):[]},nf.unset=function(e,t){return null==e||rb(e,t)},nf.unzip=i2,nf.unzipWith=i3,nf.update=function(e,t,n){return null==e?e:rE(e,t,rI(n))},nf.updateWith=function(e,t,n,r){return r="function"==typeof r?r:i,null==e?e:rE(e,t,rI(n),r)},nf.values=ay,nf.valuesIn=function(e){return null==e?[]:tD(e,al(e))},nf.without=i4,nf.words=aA,nf.wrap=function(e,t){return oC(rI(t),e)},nf.xor=i8,nf.xorBy=i6,nf.xorWith=i5,nf.zip=i7,nf.zipObject=function(e,t){return rC(e||[],t||[],nw)},nf.zipObjectDeep=function(e,t){return rC(e||[],t||[],rc)},nf.zipWith=i9,nf.entries=ag,nf.entriesIn=am,nf.extend=o7,nf.extendWith=o9,aB(nf,nf),nf.add=aZ,nf.attempt=aM,nf.camelCase=a_,nf.capitalize=ab,nf.ceil=aJ,nf.clamp=function(e,t,n){return n===i&&(n=t,t=i),n!==i&&(n=(n=o4(n))==n?n:0),t!==i&&(t=(t=o4(t))==t?t:0),nM(o4(e),t,n)},nf.clone=function(e){return nL(e,4)},nf.cloneDeep=function(e){return nL(e,5)},nf.cloneDeepWith=function(e,t){return nL(e,5,t="function"==typeof t?t:i)},nf.cloneWith=function(e,t){return nL(e,4,t="function"==typeof t?t:i)},nf.conformsTo=function(e,t){return null==t||nD(e,t,ac(t))},nf.deburr=aE,nf.defaultTo=function(e,t){return null==e||e!=e?t:e},nf.divide=aX,nf.endsWith=function(e,t,n){e=o6(e),t=ry(t);var r=e.length,o=n=n===i?r:nM(o2(n),0,r);return(n-=t.length)>=0&&e.slice(n,o)==t},nf.eq=oP,nf.escape=function(e){return(e=o6(e))&&j.test(e)?e.replace(H,tU):e},nf.escapeRegExp=function(e){return(e=o6(e))&&X.test(e)?e.replace(J,"\\$&"):e},nf.every=function(e,t,n){var r=oD(e)?tc:nU;return n&&im(e,t,n)&&(t=i),r(e,io(t,3))},nf.find=oi,nf.findIndex=iG,nf.findKey=function(e,t){return t_(e,io(t,3),nW)},nf.findLast=oo,nf.findLastIndex=iH,nf.findLastKey=function(e,t){return t_(e,io(t,3),nj)},nf.floor=a$,nf.forEach=oa,nf.forEachRight=os,nf.forIn=function(e,t){return null==e?e:nG(e,io(t,3),al)},nf.forInRight=function(e,t){return null==e?e:nH(e,io(t,3),al)},nf.forOwn=function(e,t){return e&&nW(e,io(t,3))},nf.forOwnRight=function(e,t){return e&&nj(e,io(t,3))},nf.get=ai,nf.gt=oA,nf.gte=oM,nf.has=function(e,t){return null!=e&&ih(e,t,nZ)},nf.hasIn=ao,nf.head=ij,nf.identity=aO,nf.includes=function(e,t,n,r){e=oR(e)?e:ay(e),n=n&&!r?o2(n):0;var i=e.length;return n<0&&(n=t$(i+n,0)),oY(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&tE(e,t,n)>-1},nf.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return -1;var i=null==n?0:o2(n);return i<0&&(i=t$(r+i,0)),tE(e,t,i)},nf.inRange=function(e,t,n){var r,o,a;return t=o1(t),n===i?(n=t,t=0):n=o1(n),(r=e=o4(e))>=t0(o=t,a=n)&&r<t$(o,a)},nf.invoke=au,nf.isArguments=oL,nf.isArray=oD,nf.isArrayBuffer=ox,nf.isArrayLike=oR,nf.isArrayLikeObject=oO,nf.isBoolean=function(e){return!0===e||!1===e||oW(e)&&nq(e)==h},nf.isBuffer=oN,nf.isDate=oU,nf.isElement=function(e){return oW(e)&&1===e.nodeType&&!oK(e)},nf.isEmpty=function(e){if(null==e)return!0;if(oR(e)&&(oD(e)||"string"==typeof e||"function"==typeof e.splice||oN(e)||oJ(e)||oL(e)))return!e.length;var t=id(e);if(t==y||t==T)return!e.size;if(iE(e))return!n8(e).length;for(var n in e)if(eA.call(e,n))return!1;return!0},nf.isEqual=function(e,t){return n1(e,t)},nf.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:i)?n(e,t):i;return r===i?n1(e,t,i,n):!!r},nf.isError=oF,nf.isFinite=function(e){return"number"==typeof e&&tZ(e)},nf.isFunction=oB,nf.isInteger=oV,nf.isLength=oG,nf.isMap=oj,nf.isMatch=function(e,t){return e===t||n2(e,t,is(t))},nf.isMatchWith=function(e,t,n){return n="function"==typeof n?n:i,n2(e,t,is(t),n)},nf.isNaN=function(e){return oz(e)&&e!=+e},nf.isNative=function(e){if(ib(e))throw new em("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return n3(e)},nf.isNil=function(e){return null==e},nf.isNull=function(e){return null===e},nf.isNumber=oz,nf.isObject=oH,nf.isObjectLike=oW,nf.isPlainObject=oK,nf.isRegExp=oQ,nf.isSafeInteger=function(e){return oV(e)&&e>=-0x1fffffffffffff&&e<=0x1fffffffffffff},nf.isSet=oq,nf.isString=oY,nf.isSymbol=oZ,nf.isTypedArray=oJ,nf.isUndefined=function(e){return e===i},nf.isWeakMap=function(e){return oW(e)&&id(e)==k},nf.isWeakSet=function(e){return oW(e)&&"[object WeakSet]"==nq(e)},nf.join=function(e,t){return null==e?"":tJ.call(e,t)},nf.kebabCase=aS,nf.last=iq,nf.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return -1;var o=r;return n!==i&&(o=(o=o2(n))<0?t$(r+o,0):t0(o,r-1)),t==t?function(e,t,n){for(var r=n+1;r--&&e[r]!==t;);return r}(e,t,o):tb(e,tT,o,!0)},nf.lowerCase=aT,nf.lowerFirst=aw,nf.lt=oX,nf.lte=o$,nf.max=function(e){return e&&e.length?nF(e,aO,nY):i},nf.maxBy=function(e,t){return e&&e.length?nF(e,io(t,2),nY):i},nf.mean=function(e){return tw(e,aO)},nf.meanBy=function(e,t){return tw(e,io(t,2))},nf.min=function(e){return e&&e.length?nF(e,aO,n6):i},nf.minBy=function(e,t){return e&&e.length?nF(e,io(t,2),n6):i},nf.stubArray=aQ,nf.stubFalse=aq,nf.stubObject=function(){return{}},nf.stubString=function(){return""},nf.stubTrue=function(){return!0},nf.multiply=a0,nf.nth=function(e,t){return e&&e.length?rt(e,o2(t)):i},nf.noConflict=function(){return e4._===this&&(e4._=eR),this},nf.noop=aV,nf.now=op,nf.pad=function(e,t,n){e=o6(e);var r=(t=o2(t))?tj(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return rX(ty(i),n)+e+rX(e9(i),n)},nf.padEnd=function(e,t,n){e=o6(e);var r=(t=o2(t))?tj(e):0;return t&&r<t?e+rX(t-r,n):e},nf.padStart=function(e,t,n){e=o6(e);var r=(t=o2(t))?tj(e):0;return t&&r<t?rX(t-r,n)+e:e},nf.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t*=1),t2(o6(e).replace($,""),t||0)},nf.random=function(e,t,n){if(n&&"boolean"!=typeof n&&im(e,t,n)&&(t=n=i),n===i&&("boolean"==typeof t?(n=t,t=i):"boolean"==typeof e&&(n=e,e=i)),e===i&&t===i?(e=0,t=1):(e=o1(e),t===i?(t=e,e=0):t=o1(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var o=t3();return t0(e+o*(t-e+e0("1e-"+((o+"").length-1))),t)}return ra(e,t)},nf.reduce=function(e,t,n){var r=oD(e)?tv:tI,i=arguments.length<3;return r(e,io(t,4),n,i,nO)},nf.reduceRight=function(e,t,n){var r=oD(e)?tg:tI,i=arguments.length<3;return r(e,io(t,4),n,i,nN)},nf.repeat=function(e,t,n){return t=(n?im(e,t,n):t===i)?1:o2(t),rs(o6(e),t)},nf.replace=function(){var e=arguments,t=o6(e[0]);return e.length<3?t:t.replace(e[1],e[2])},nf.result=function(e,t,n){var r=-1,o=(t=rP(t,e)).length;for(o||(o=1,e=i);++r<o;){var a=null==e?i:e[iO(t[r])];a===i&&(r=o,a=n),e=oB(a)?a.call(e):a}return e},nf.round=a1,nf.runInContext=e,nf.sample=function(e){return(oD(e)?nS:function(e){return nS(ay(e))})(e)},nf.size=function(e){if(null==e)return 0;if(oR(e))return oY(e)?tj(e):e.length;var t=id(e);return t==y||t==T?e.size:n8(e).length},nf.snakeCase=aC,nf.some=function(e,t,n){var r=oD(e)?tm:rh;return n&&im(e,t,n)&&(t=i),r(e,io(t,3))},nf.sortedIndex=function(e,t){return rp(e,t)},nf.sortedIndexBy=function(e,t,n){return rv(e,t,io(n,2))},nf.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=rp(e,t);if(r<n&&oP(e[r],t))return r}return -1},nf.sortedLastIndex=function(e,t){return rp(e,t,!0)},nf.sortedLastIndexBy=function(e,t,n){return rv(e,t,io(n,2),!0)},nf.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=rp(e,t,!0)-1;if(oP(e[n],t))return n}return -1},nf.startCase=ak,nf.startsWith=function(e,t,n){return e=o6(e),n=null==n?0:nM(o2(n),0,e.length),t=ry(t),e.slice(n,n+t.length)==t},nf.subtract=a2,nf.sum=function(e){return e&&e.length?tP(e,aO):0},nf.sumBy=function(e,t){return e&&e.length?tP(e,io(t,2)):0},nf.template=function(e,t,n){var r=nf.templateSettings;n&&im(e,t,n)&&(t=i),e=o6(e),t=o9({},t,r,r6);var o,a,s=o9({},t.imports,r.imports,r6),u=ac(s),c=tD(s,u),l=0,f=t.interpolate||ev,d="__p += '",h=eE((t.escape||ev).source+"|"+f.source+"|"+(f===Q?es:ev).source+"|"+(t.evaluate||ev).source+"|$","g"),p="//# sourceURL="+(eA.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++eZ+"]")+"\n";e.replace(h,function(t,n,r,i,s,u){return r||(r=i),d+=e.slice(l,u).replace(eg,tF),n&&(o=!0,d+="' +\n__e("+n+") +\n'"),s&&(a=!0,d+="';\n"+s+";\n__p += '"),r&&(d+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=u+t.length,t}),d+="';\n";var v=eA.call(t,"variable")&&t.variable;if(v){if(eo.test(v))throw new em("Invalid `variable` option passed into `_.template`")}else d="with (obj) {\n"+d+"\n}\n";d=(a?d.replace(F,""):d).replace(B,"$1").replace(V,"$1;"),d="function("+(v||"obj")+") {\n"+(v?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+d+"return __p\n}";var g=aM(function(){return ey(u,p+"return "+d).apply(i,c)});if(g.source=d,oF(g))throw g;return g},nf.times=function(e,t){if((e=o2(e))<1||e>0x1fffffffffffff)return[];var n=0xffffffff,r=t0(e,0xffffffff);t=io(t),e-=0xffffffff;for(var i=tA(r,t);++n<e;)t(n);return i},nf.toFinite=o1,nf.toInteger=o2,nf.toLength=o3,nf.toLower=function(e){return o6(e).toLowerCase()},nf.toNumber=o4,nf.toSafeInteger=function(e){return e?nM(o2(e),-0x1fffffffffffff,0x1fffffffffffff):0===e?e:0},nf.toString=o6,nf.toUpper=function(e){return o6(e).toUpperCase()},nf.trim=function(e,t,n){if((e=o6(e))&&(n||t===i))return tM(e);if(!e||!(t=ry(t)))return e;var r=tz(e),o=tz(t);return rA(r,tR(r,o),tO(r,o)+1).join("")},nf.trimEnd=function(e,t,n){if((e=o6(e))&&(n||t===i))return e.slice(0,tK(e)+1);if(!e||!(t=ry(t)))return e;var r=tz(e);return rA(r,0,tO(r,tz(t))+1).join("")},nf.trimStart=function(e,t,n){if((e=o6(e))&&(n||t===i))return e.replace($,"");if(!e||!(t=ry(t)))return e;var r=tz(e);return rA(r,tR(r,tz(t))).join("")},nf.truncate=function(e,t){var n=30,r="...";if(oH(t)){var o="separator"in t?t.separator:o;n="length"in t?o2(t.length):n,r="omission"in t?ry(t.omission):r}var a=(e=o6(e)).length;if(tB(e)){var s=tz(e);a=s.length}if(n>=a)return e;var u=n-tj(r);if(u<1)return r;var c=s?rA(s,0,u).join(""):e.slice(0,u);if(o===i)return c+r;if(s&&(u+=c.length-u),oQ(o)){if(e.slice(u).search(o)){var l,f=c;for(o.global||(o=eE(o.source,o6(eu.exec(o))+"g")),o.lastIndex=0;l=o.exec(f);)var d=l.index;c=c.slice(0,d===i?u:d)}}else if(e.indexOf(ry(o),u)!=u){var h=c.lastIndexOf(o);h>-1&&(c=c.slice(0,h))}return c+r},nf.unescape=function(e){return(e=o6(e))&&W.test(e)?e.replace(G,tQ):e},nf.uniqueId=function(e){var t=++eM;return o6(e)+t},nf.upperCase=aI,nf.upperFirst=aP,nf.each=oa,nf.eachRight=os,nf.first=ij,aB(nf,(aY={},nW(nf,function(e,t){eA.call(nf.prototype,t)||(aY[t]=e)}),aY),{chain:!1}),nf.VERSION="4.17.21",tu(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){nf[e].placeholder=nf}),tu(["drop","take"],function(e,t){nv.prototype[e]=function(n){n=n===i?1:t$(o2(n),0);var r=this.__filtered__&&!t?new nv(this):this.clone();return r.__filtered__?r.__takeCount__=t0(n,r.__takeCount__):r.__views__.push({size:t0(n,0xffffffff),type:e+(r.__dir__<0?"Right":"")}),r},nv.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),tu(["filter","map","takeWhile"],function(e,t){var n=t+1,r=1==n||3==n;nv.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:io(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),tu(["head","last"],function(e,t){var n="take"+(t?"Right":"");nv.prototype[e]=function(){return this[n](1).value()[0]}}),tu(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");nv.prototype[e]=function(){return this.__filtered__?new nv(this):this[n](1)}}),nv.prototype.compact=function(){return this.filter(aO)},nv.prototype.find=function(e){return this.filter(e).head()},nv.prototype.findLast=function(e){return this.reverse().find(e)},nv.prototype.invokeMap=ru(function(e,t){return"function"==typeof e?new nv(this):this.map(function(n){return n$(n,e,t)})}),nv.prototype.reject=function(e){return this.filter(oT(io(e)))},nv.prototype.slice=function(e,t){e=o2(e);var n=this;return n.__filtered__&&(e>0||t<0)?new nv(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==i&&(n=(t=o2(t))<0?n.dropRight(-t):n.take(t-e)),n)},nv.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},nv.prototype.toArray=function(){return this.take(0xffffffff)},nW(nv.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),o=nf[r?"take"+("last"==t?"Right":""):t],a=r||/^find/.test(t);o&&(nf.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,u=t instanceof nv,c=s[0],l=u||oD(t),f=function(e){var t=o.apply(nf,tp([e],s));return r&&d?t[0]:t};l&&n&&"function"==typeof c&&1!=c.length&&(u=l=!1);var d=this.__chain__,h=!!this.__actions__.length,p=a&&!d,v=u&&!h;if(!a&&l){t=v?t:new nv(this);var g=e.apply(t,s);return g.__actions__.push({func:ot,args:[f],thisArg:i}),new np(g,d)}return p&&v?e.apply(this,s):(g=this.thru(f),p?r?g.value()[0]:g.value():g)})}),tu(["pop","push","shift","sort","splice","unshift"],function(e){var t=ew[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);nf.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(oD(i)?i:[],e)}return this[n](function(n){return t.apply(oD(n)?n:[],e)})}}),nW(nv.prototype,function(e,t){var n=nf[t];if(n){var r=n.name+"";eA.call(nn,r)||(nn[r]=[]),nn[r].push({name:t,func:n})}}),nn[rq(i,2).name]=[{name:"wrapper",func:i}],nv.prototype.clone=function(){var e=new nv(this.__wrapped__);return e.__actions__=rU(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=rU(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=rU(this.__views__),e},nv.prototype.reverse=function(){if(this.__filtered__){var e=new nv(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},nv.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=oD(e),r=t<0,i=n?e.length:0,o=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=t0(t,e+a);break;case"takeRight":e=t$(e,t-a)}}return{start:e,end:t}}(0,i,this.__views__),a=o.start,s=o.end,u=s-a,c=r?s:a-1,l=this.__iteratees__,f=l.length,d=0,h=t0(u,this.__takeCount__);if(!n||!r&&i==u&&h==u)return rT(e,this.__actions__);var p=[];e:for(;u--&&d<h;){for(var v=-1,g=e[c+=t];++v<f;){var m=l[v],y=m.iteratee,_=m.type,b=y(g);if(2==_)g=b;else if(!b){if(1==_)continue e;break e}}p[d++]=g}return p},nf.prototype.at=on,nf.prototype.chain=function(){return oe(this)},nf.prototype.commit=function(){return new np(this.value(),this.__chain__)},nf.prototype.next=function(){this.__values__===i&&(this.__values__=o0(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?i:this.__values__[this.__index__++]}},nf.prototype.plant=function(e){for(var t,n=this;n instanceof nh;){var r=iU(n);r.__index__=0,r.__values__=i,t?o.__wrapped__=r:t=r;var o=r;n=n.__wrapped__}return o.__wrapped__=e,t},nf.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof nv){var t=e;return this.__actions__.length&&(t=new nv(this)),(t=t.reverse()).__actions__.push({func:ot,args:[iX],thisArg:i}),new np(t,this.__chain__)}return this.thru(iX)},nf.prototype.toJSON=nf.prototype.valueOf=nf.prototype.value=function(){return rT(this.__wrapped__,this.__actions__)},nf.prototype.first=nf.prototype.head,e$&&(nf.prototype[e$]=function(){return this}),nf}();e4._=tq,(r=(function(){return tq}).call(t,n,t,e))===i||(e.exports=r)}).call(this)},815:function(e,t){"use strict";var n,r,i,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});function a(e,t){var n={};return Object.assign(n,e),t&&Object.assign(n,t),n}Object.defineProperty(t,"__esModule",{value:!0}),t.DeviceConfigPropertyHolder=t.DeviceConfigManager=t.DeviceConfigEnv=void 0,(f=i||(t.DeviceConfigEnv=i={})).BETA="beta",f.PROD="prod",f.CUSTOM="custom";var s=function(e){function t(t){return e.call(this,t)||this}return o(t,e),t}(Error),u="data",c="base64";t.DeviceConfigManager=function(){function e(e,t){if(!t.fileKey)throw Error("options.fileKey cannot be empty");var n=null!=(s=t.clock)?s:new m,r=n.getMillis();switch(this.context=e,this.fileKey=t.fileKey,this.env=t.standardEnv,t.standardEnv){case i.BETA:this.fetchServer="beta.ivs-device-config-beta.live-video.net";break;case i.PROD:this.fetchServer="prod.ivs-device-config.live-video.net";break;case i.CUSTOM:if(!t.customServer)throw Error("Custom env requires options.customServer");this.fetchServer=t.customServer;break;default:throw Error("Invalid value for standardEnv: ".concat(t.standardEnv))}this.trace=null!=(c=t.trace)?c:new p(t.enableConsoleLog),this.fetch=null!=(l=t.fetch)?l:new h(e),this.storage=new g("amazon_ivs_device_config_v1_"+t.fileKey,e.localStorage),this.state=new _(this.storage,"state"),this.refresh={refreshIntervalSeconds:null!=(f=t.refresh.refreshIntervalSeconds)?f:900,retryCount:null!=(d=t.refresh.retryCount)?d:3,retryIntervalSeconds:null!=(v=t.refresh.retryIntervalSeconds)?v:10,maxCacheAgeSeconds:null!=(y=t.refresh.maxCacheAgeSeconds)?y:259200,stopRefreshAfterSeconds:null!=(b=t.refresh.stopRefreshAfterSeconds)?b:7200,canRefreshNow:t.refresh.canRefreshNow},this.emitMetrics=t.emitMetrics,this.analyticsProperties=t.analyticsProperties,this.enableConsoleLog=t.enableConsoleLog,this.clock=n,this.isInitialRefreshDone=!1;var o=0,a=this.state.getState();a&&a.fetchServer===this.fetchServer&&a.lastFetchWhenMs&&(o=a.lastFetchWhenMs);var s,c,l,f,d,v,y,b,E,S=n.getMillis(),T=(S-o)/1e3;if(T<=this.refresh.maxCacheAgeSeconds){var w=this.storage.getJson(u);w&&w.fetchServer===this.fetchServer&&this.setData(w.json)}this.lastUseMs=S,T>=this.refresh.refreshIntervalSeconds||0==o?E=0:(E=Math.round(this.refresh.refreshIntervalSeconds-T),this.isInitialRefreshDone=!0),E<5&&(E=5),this.trace.onTrace("Will start refresh in "+E+" seconds"),this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*E);var C=n.getMillis();this.initialLoadTime=C-r}return e.getInstance=function(t,n){try{if(!(t.fetch&&t.setTimeout&&t.clearTimeout&&t.localStorage))return void console.log("Context needs to provide fetch, setTimeout, clearTimeout, localStorage")}catch(e){return void console.error("Error checking for context properties "+e)}if(this.gInstance){if(this.gInstance.fileKey!=n.fileKey)throw Error("Existing instance has file key ".concat(this.gInstance.fileKey,", now asking for ").concat(n.fileKey));return this.gInstance}return this.gInstance=new e(t,n),this.gInstance},e.prototype.getConfigurationHolder=function(e){var t,n=this.clock.getMillis();this.lastUseMs=n;var r=null!=(t=e.analytics)?t:new v(this.enableConsoleLog),i=0,o=this.state.getState();return o&&o.fetchServer===this.fetchServer&&o.lastFetchWhenMs&&(i=o.lastFetchWhenMs),(n-i)/1e3<=this.refresh.maxCacheAgeSeconds?new l(r,this.analyticsProperties,this.properties,i,this.clock):new l(r,void 0,void 0,0,this.clock)},e.prototype.getFetchUrl=function(){var e=new URL("https://".concat(this.fetchServer,"/").concat(this.fileKey,".json"));return e.searchParams.set("version","1.0"),e},e.clearInstance=function(){var e;null==(e=this.gInstance)||e.clearInstanceImpl(),this.gInstance=void 0},e.prototype.clearInstanceImpl=function(){this.context.clearTimeout(this.fetchTask),this.fetchTask=void 0,this.context.clearTimeout(this.retryTask),this.retryTask=void 0},e.prototype.startRefresh=function(){var e=this;this.trace.onTrace("Starting refresh request"),this.fetchTask=void 0,this.retryTask&&(this.context.clearTimeout(this.retryTask),this.retryTask=void 0),this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*this.refresh.refreshIntervalSeconds);var t=this.clock.getMillis();if((t-this.lastUseMs)/1e3>this.refresh.stopRefreshAfterSeconds)this.trace.onTrace("Will not refresh due to refresh timeout");else if(!this.isInitialRefreshDone||this.refresh.canRefreshNow()){this.isInitialRefreshDone=!0;var n={};this.fetchData().then(function(r){e.processResponse(r,n,t),e.emitMetricsImpl(n)}).catch(function(t){e.exceptionMetrics(n,t),e.emitMetricsImpl(n),e.trace.onTrace("Fetch error: "+t),e.refresh.retryCount>0&&e.scheduleRetry(1)})}else this.trace.onTrace("Will not refresh due to callback having returned false")},e.prototype.fetchData=function(){var e=this.getFetchUrl(),t=new Headers,n=this.state.getState();return n.fetchServer===this.fetchServer&&(n.lastFetchWhenFullMs&&this.clock.getMillis()-n.lastFetchWhenFullMs>864e5?this.trace.onTrace("Forcing full refresh"):this.properties&&n.lastFetchEtagHeader&&t.set("If-None-Match",n.lastFetchEtagHeader)),this.fetch.fetchUrl(e,t)},e.prototype.processResponse=function(e,t,n){var r={fetchServer:this.fetchServer,lastFetchWhenMs:this.clock.getMillis()},i=e.headers.get("etag");if(i&&(r.lastFetchEtagHeader=i),e.status<300&&e.json)if(this.setData(e.json)){this.trace.onTrace("Successfully parsed fetched data"),this.storage.setJson(u,{fetchServer:this.fetchServer,json:e.json});var o=this.clock.getMillis();r.lastFetchWhenFullMs=o,this.state.setState(r),t.success_new_data_count=1,t.fetch_duration_average=Math.max(0,o-n)}else t.fail_invalid_data_count=1;else{if(304!==e.status){var a="Unexpected http fetch status: "+e.status;throw this.trace.onTrace(a),new s(a)}this.trace.onTrace("Server said no change in data"),r.lastFetchWhenMs=o=this.clock.getMillis(),this.state.setState(r),t.success_no_change_count=1,t.fetch_duration_average=Math.max(0,o-n)}},e.prototype.scheduleRetry=function(e){var t=this;this.retryTask&&this.context.clearTimeout(this.retryTask);var n=e*this.refresh.retryIntervalSeconds;this.retryTask=this.context.setTimeout(function(){t.retryTask=void 0,t.fetchRetry(e)},1e3*n)},e.prototype.fetchRetry=function(e){var t=this;this.trace.onTrace("Starting retry request ".concat(e,"..."));var n={},r=this.clock.getMillis();this.fetchData().then(function(e){t.processResponse(e,n,r),t.emitMetricsImpl(n)}).catch(function(r){t.exceptionMetrics(n,r),t.emitMetricsImpl(n),t.trace.onTrace("Fetch error: "+r),t.refresh.retryCount>e&&t.scheduleRetry(e+1)})},e.prototype.setData=function(e){if(!e)return!1;if("1.0"!==e.version)return this.trace.onTrace("Data version is not 1.0, not applying"),!1;var t=e.properties;if(!t||!Array.isArray(t))return this.trace.onTrace("Data properties is not an array, not applying"),!1;for(var n=new Map,r=0;r<t.length;r++){var i=t[r];if(i.name&&i.type&&this.isValidValueType(i.type)){if(i.value_string&&"string"!=typeof i.value_string){this.trace.onTrace("Invalid type of value.value_string "+typeof i.value_string);continue}if(i.value_number&&"number"!=typeof i.value_number){this.trace.onTrace("Invalid type of value.value_number "+typeof i.value_number);continue}if(i.value_boolean&&"boolean"!=typeof i.value_boolean){this.trace.onTrace("Invalid type of value.value_boolean "+typeof i.value_boolean);continue}if(i.value_json&&"string"!=typeof i.value_json){this.trace.onTrace("Invalid type of value.value_json "+typeof i.value_json);continue}if(i.value_analytics&&"string"!=typeof i.value_analytics){this.trace.onTrace("Invalid type of item.value_analytics "+typeof i.value_analytics);continue}var o=new y(i.name,this.parseValueType(i.type),i.value_string,i.value_number,i.value_boolean,i.value_json,i.value_analytics,i.encoding);n.set(o.name,o)}}return 0!=n.size&&(this.properties=n,!0)},e.prototype.isValidValueType=function(e){return"string"===e||"number"===e||"boolean"===e||"json"==e},e.prototype.parseValueType=function(e){switch(e){case"string":return d.STRING;case"number":return d.NUMBER;case"boolean":return d.BOOLEAN;case"json":return d.JSON;default:throw Error("Unsupported value type ".concat(e))}},e.prototype.emitMetricsImpl=function(e){var t,n,r,i,o,s,u={initial_load_time:this.initialLoadTime,fetch_attempt_count:1,fetch_duration_average:null!=(t=e.fetch_duration_average)?t:0,success_no_change_count:null!=(n=e.success_no_change_count)?n:0,success_new_data_count:null!=(r=e.success_new_data_count)?r:0,fail_exception_count:null!=(i=e.fail_exception_count)?i:0,fail_http_error_count:null!=(o=e.fail_http_error_count)?o:0,fail_invalid_data_count:null!=(s=e.fail_invalid_data_count)?s:0};this.emitMetrics(a(u,this.analyticsProperties))},e.prototype.exceptionMetrics=function(e,t){var n;t instanceof s||(null==(n=null==t?void 0:t.message)?void 0:n.startsWith("http error"))?e.fail_http_error_count=1:e.fail_exception_count=1},e}();var l=function(){function e(e,t,n,r,i){this.analytics=e,this.analyticsProperties=t,this.properties=n,this.dataFetchedWhenMs=r,this.clock=i}return e.prototype.getSize=function(){return this.properties?this.properties.size:-1},e.prototype.getStringValue=function(e){var t,n;if(this.properties){var r=this.properties.get(e);if(r){if(r.type===d.STRING){var i=null!=(t=r.valueString)?t:"";return this.analytics.onValue(a({key_name:r.name,value:null!=(n=r.valueAnalytics)?n:i,fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),i}this.analytics.onError(a({key_name:r.name,message:"Type is not string"},this.analyticsProperties))}}else this.analytics.onTrace(a({key_name:e,message:"Configuration is not available"},this.analyticsProperties))},e.prototype.getNumberValue=function(e){var t,n;if(this.properties){var r=this.properties.get(e);if(r){if(r.type===d.NUMBER){var i=null!=(t=r.valueNumber)?t:0;return this.analytics.onValue(a({key_name:r.name,value:null!=(n=r.valueAnalytics)?n:i.toString(),fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),i}this.analytics.onError(a({key_name:r.name,message:"Type is not number"},this.analyticsProperties))}}else this.analytics.onTrace(a({key_name:e,message:"Configuration is not available"},this.analyticsProperties))},e.prototype.getBooleanValue=function(e){var t,n;if(this.properties){var r=this.properties.get(e);if(r){if(r.type===d.BOOLEAN){var i=null!=(t=r.valueBoolean)&&t;return this.analytics.onValue(a({key_name:r.name,value:null!=(n=r.valueAnalytics)?n:i.toString(),fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),i}this.analytics.onError(a({key_name:r.name,message:"Type is not number"},this.analyticsProperties))}}else this.analytics.onTrace(a({key_name:e,message:"Configuration is not available"},this.analyticsProperties))},e.prototype.getJsonValue=function(e){var t,n;if(this.properties){var r=this.properties.get(e);if(r){if(r.type===d.JSON){var i=r.valueJson;if(!i)return this.analytics.onValue(a({key_name:r.name,value:null!=(t=r.valueAnalytics)?t:"",fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),null;try{var o=JSON.parse(i);return this.analytics.onValue(a({key_name:r.name,value:null!=(n=r.valueAnalytics)?n:o,fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),o}catch(e){return void this.analytics.onError(a({key_name:r.name,message:"JSON parse error"},this.analyticsProperties))}}this.analytics.onError(a({key_name:r.name,message:"Type is not JSON"},this.analyticsProperties))}}else this.analytics.onTrace(a({key_name:e,message:"Configuration is not available"},this.analyticsProperties))},e.prototype.getFetchedSecondsAgo=function(){if(this.dataFetchedWhenMs)return(this.clock.getMillis()-this.dataFetchedWhenMs)/1e3},e}();t.DeviceConfigPropertyHolder=l;var f,d,h=function(){function e(e){this.context=e}return e.prototype.fetchUrl=function(e,t){var n=this,r={headers:t,cache:"no-store"},i=null;if("undefined"!=typeof AbortController){var o=new AbortController;i=this.context.setTimeout(function(){return o.abort()},15e3),r.signal=o.signal}return new Promise(function(t,o){n.context.fetch(e,r).then(function(e){if(e.status>=400)o(new s("http error ".concat(e.status,", ").concat(e.statusText)));else{var n={status:e.status,headers:e.headers};e.json().then(function(e){n.json=e,t(n)}).catch(function(){t(n)})}}).catch(function(e){o(e)}).finally(function(){i&&n.context.clearTimeout(i)})})},e}(),p=function(){function e(e){this.enableConsoleLog=e}return e.prototype.onTrace=function(e){this.enableConsoleLog&&console.log("DeviceConfig trace: "+e)},e}(),v=function(){function e(e){this.enableConsoleLog=e}return e.prototype.onValue=function(e){this.enableConsoleLog&&console.log("DeviceConfig analytics value:  ".concat(e))},e.prototype.onError=function(e){this.enableConsoleLog&&console.error("DeviceConfig analytics error: ".concat(e))},e.prototype.onTrace=function(e){this.enableConsoleLog&&console.log("DeviceConfig analytics trace: ".concat(e))},e}(),g=function(){function e(e,t){this.prefix=e,this.storage=t}return e.prototype.getJson=function(e){var t=this.prefix+"_"+e;try{var n=this.storage.getItem(t);if(n)return JSON.parse(n)}catch(e){console.error("Error getting local storage key ".concat(t)+e)}return null},e.prototype.setJson=function(e,t){var n=this.prefix+"_"+e;try{this.storage.setItem(n,JSON.stringify(t))}catch(e){console.error("Error setting local storage key ".concat(n,": ")+e)}},e}(),m=function(){function e(){}return e.prototype.getMillis=function(){return Date.now()},e}();(n=d||(d={}))[n.STRING=0]="STRING",n[n.NUMBER=1]="NUMBER",n[n.BOOLEAN=2]="BOOLEAN",n[n.JSON=3]="JSON";var y=function(e,t,n,r,i,o,a,s){switch(this.name=e,this.type=t,this.valueString=n,this.valueNumber=r,this.valueBoolean=i,this.valueJson=o,this.valueAnalytics=a,this.type){case d.STRING:s===c&&n&&(this.valueString=atob(n));break;case d.JSON:s===c&&o&&(this.valueJson=atob(o))}},_=function(){function e(e,t){var n;this.storage=e,this.key=t,this.state=null!=(n=e.getJson(t))?n:{}}return e.prototype.getState=function(){return this.state},e.prototype.setState=function(e){Object.assign(this.state,e),this.storage.setJson(this.key,this.state)},e}()},456:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(903),t)},903:function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2==arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.TypedEmitter=void 0;var i=n(228);t.TypedEmitter=function(){function e(e){var t=e.propagateErrors;this.emitter=new i.EventEmitter,this.propagateErrors=null!=t&&t}return e.prototype.on=function(e,t){t.call=this.wrapCall(e,t),this.emitter.on(e,t)},e.prototype.off=function(e,t){this.emitter.off(e,t)},e.prototype.emit=function(e){for(var t,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];(t=this.emitter).emit.apply(t,r([e],n,!1))},e.prototype.removeAllListeners=function(){this.emitter.removeAllListeners()},e.prototype.wrapCall=function(e,t){var n=this;return function(r){for(var i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];if(n.propagateErrors)t.apply(r,i);else try{t.apply(r,i)}catch(n){var a="Error in callback for ".concat(e),s=t.name;return s&&(a+=" for function ".concat(s)),void console.error(a,n)}}},e}()},987:function(e,t,n){"use strict";var r,i=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&o(t,e,n);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.createFsm=t.FsmWildcardState=t.RejectedTransitionError=t.InvalidStateTransitionError=void 0;var u=s(n(293)),c=function(e){function t(t,n){var r=e.call(this,"Invalid transition from '".concat(n,"' via event '").concat(t,"'"))||this;return r.name="InvalidStateTransitionError",r}return i(t,e),t}(Error);t.InvalidStateTransitionError=c;var l=function(e){function t(t,n,r){var i=e.call(this,"Transition from '".concat(n,"' via event '").concat(t,"' was rejected for: ").concat(r))||this;return i.name="RejectedTransitionError",i}return i(t,e),t}(Error);t.RejectedTransitionError=l,t.FsmWildcardState="*",t.createFsm=function(e){var n,r=e.transitions,i=e.callbacks,o=e.initialState,a=function(e){var n,i=null==(n=r[e])?void 0:n.from;return!!i&&("string"==typeof i?i===t.FsmWildcardState:i.includes(o))};return{canTransition:a,transition:function(e,t){if(!a(e))return u.err(new c(String(o),String(e)));var s,f,d,h,p,v,g=r[e];return void 0===g.shouldTransition||g.shouldTransition(o)?(null==(f=null==(s=null==i?void 0:i[o])?void 0:s.onExiting)||f.call(s),null==(d=null==i?void 0:i.onStateExiting)||d.call(i,o),n=o,o=g.to,null==(p=null==(h=null==i?void 0:i[o])?void 0:h.onChanged)||p.call(h,n,t),null==(v=null==i?void 0:i.onStateChanged)||v.call(i,n,o,t),u.ok(o)):u.err(new l(String(o),String(e),"shouldTransition returned false"))},previousState:function(){return n},currentState:function(){return o}}}},156:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=void 0,t.VERSION="0.6.0",i(n(815),t),i(n(456),t),i(n(987),t),i(n(135),t),i(n(925),t)},925:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(166),t),i(n(612),t),i(n(56),t),i(n(139),t),i(n(877),t)},166:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__spreadArray||function(e,t,n){if(n||2==arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.getLogConfig=t.setLogConfig=t.setLogConfigByLevel=t.extractLogConfig=void 0;var o=n(612),a=n(56),s=n(139),u=n(478),c={enabled:!1,levels:{debug:!0,log:!0,info:!0,warn:!0,error:!0},targets:[(0,a.createConsoleLogTarget)()],categories:{}},l=Object.keys(c);t.extractLogConfig=function(e){var t={};if(Object.keys(e).some(function(e){return l.includes(e)})){for(var n=0;n<l.length;n++){var r=l[n];if(void 0!==e[r]){var i=e[r];t[r]=i}}return t}},t.setLogConfigByLevel=function(e){var n=e.enabled||c.enabled,r=e.targets||c.targets,i={debug:!1,log:!1,info:!1,warn:!1,error:!1},o=function(e,t){for(var n=0;n<e.length;n++)i[e[n]]=t};switch(e.level){case"debug":o(["debug","log","info","warn","error"],n);break;case"log":o(["log","info","warn","error"],n);break;case"info":o(["info","warn","error"],!0);break;case"warn":o(["warn","error"],!0);break;case"error":o(["error"],!0)}(0,t.setLogConfig)({enabled:n,levels:i,targets:r})},t.setLogConfig=function(e){var t=(0,u.mergeConfigs)(c,e);t&&(c=t,o.defaultLogEmitter.emit(s.LogEventType.CONFIG_UPDATED,c))},t.getLogConfig=function(){return{enabled:c.enabled,levels:r({},c.levels),targets:i([],c.targets,!0),categories:r({},c.categories)}}},612:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultLogEmitter=void 0,t.defaultLogEmitter=new(n(456)).TypedEmitter({})},56:function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2==arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.createEventLogTarget=t.createConsoleLogTarget=void 0;var i=n(139);t.createConsoleLogTarget=function(){return{handleMessage:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console[e].apply(console,t)}}},t.createEventLogTarget=function(e){return{handleMessage:function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];e.emit.apply(e,r([i.LogEventType.MESSAGE_LOGGED,t],n,!1))}}}},139:function(e,t){"use strict";var n,r;Object.defineProperty(t,"__esModule",{value:!0}),t.LogEventType=void 0,(r=n||(t.LogEventType=n={})).CONFIG_UPDATED="logConfigUpdated",r.MESSAGE_LOGGED="messageLogged"},877:function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__spreadArray||function(e,t,n){if(n||2==arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.createLogger=void 0;var o=n(478),a=n(166),s=n(612),u=n(139),c=function(e,t){return(0,o.mergeConfigs)(e,t)||e};t.createLogger=function(e){var n=e.name,o=e.category,l=e.parent,f=(0,a.extractLogConfig)(e)||{},d=c((0,a.getLogConfig)(),f);s.defaultLogEmitter.on(u.LogEventType.CONFIG_UPDATED,function(e){d=c(e,f||{})});var h=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(l&&!l.canLog(e)||!v(e))return!1;for(var r=p(),o=(new Date).toTimeString().split(" ")[0],a=i(["".concat(o," - (").concat(r,")")],t,!0),s=0,u=d.targets;s<u.length;s++){var c=u[s];c.handleMessage.apply(c,i([e],a,!1))}return!0},p=function(){return l?"".concat(l.getName()," | ").concat(n):n},v=function(e){return!(!d.enabled||!d.levels[e]||0===d.targets.length||void 0!==o&&!d.categories[o])},g={debug:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return h.apply(void 0,i(["debug"],e,!1))},log:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return h.apply(void 0,i(["log"],e,!1))},info:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return h.apply(void 0,i(["info"],e,!1))},warn:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return h.apply(void 0,i(["warn"],e,!1))},error:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return h.apply(void 0,i(["error"],e,!1))},getName:p,canLog:v,getChildLogger:function(e){return(0,t.createLogger)(r(r({},e),{parent:g}))},setConfig:function(e){d=c(d,f=e)}};return g}},478:function(e,t,n){"use strict";var r=this&&this.__spreadArray||function(e,t,n){if(n||2==arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.mergeConfigs=void 0;var i=n(543),o=function(e,t){if((0,i.isArray)(e))return t};t.mergeConfigs=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var a=t.map(function(e){return null==e||"object"!=typeof e}).filter(Boolean).length>0;if("object"==typeof e&&!a)return i.mergeWith.apply(void 0,r(r([{},e],t,!1),[o],!1))}},293:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getErr=t.getOk_or=t.getOk=t.isNotOk=t.isOk=t.err=t.ok=void 0,t.ok=function(e){return{ok:!0,value:e}},t.err=function(e){return{ok:!1,error:e}},t.isOk=function(e){return!0===e.ok},t.isNotOk=function(e){return!(0,t.isOk)(e)},t.getOk=function(e){return!0===e.ok?e.value:void 0},t.getOk_or=function(e,t){return!0===e.ok?e.value:t},t.getErr=function(e){return!0===e.ok?void 0:e.error}},12:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timedThrottle=void 0,t.timedThrottle=function(e,t){var n=0;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var o=Date.now();o-n>=t&&(n=o,e.apply(this,r))}}},135:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(12),t),i(n(293),t)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},n(156)}()},580:function(e,t,r){"use strict";r.d(t,{mC:function(){return l},cp:function(){return g},on:function(){return m}});var i,o,a,s=n(27593),u=r(998),c=((i=c||{}).DESKTOP="web",i.MOBILE_WEB="mobile_web",i.FIRETV="firetv_web_tv",i.XBOX="xbox_web_tv",i.PS5="ps5_web_tv",i.TIZEN="samsung_web_tv",i.WEBOS="lg_web_tv",i.PS4="ps4_web_tv",i.ANDROIDTV="androidtv_web_tv",i.VIZIO="vizio_web_tv",i.SWITCH="switch_web_tv",i.VESTEL="vestel_web_tv",i.WEBTV="web_tv",i.CHROMECAST="chromecast",i.OTHERTV="other_web_tv",i),l=((o={}).CHROME="chrome",o.EDGE="msEdgeChromium",o.FIREFOX="firefox",o.OPERA="opera",o.SAFARI="safari",o),f=/^(\d+)\.(\d+)\.(\d+)[+|-]?(.*)?$/,d=/^(\d+)\.(\d+)[+|-]?(.*)?$/,h=/^(\d+)$/,p=((a={platform:c.DESKTOP})[l.CHROME]=!1,a[l.EDGE]=!1,a[l.FIREFOX]=!1,a[l.OPERA]=!1,a[l.SAFARI]=!1,a.chromecast=!1,a.domain="",a.electron=!1,a.family="",a.host="",a.major=-1,a.minor=-1,a.msEdgeLegacy=!1,a.msIE=!1,a.name="",a.osName="",a.osVersion="",a.patch=-1,a.url="",a.userAgent="",a.mobile=!1,a.supportsDataChannels=!1,a.supportsWebTransport=!1,a.supportsMSEInWorkers=!1,a.supportsMuxedFMP4=!0,a),v=null;function g(){if(v)return v;if("undefined"==typeof window||"undefined"==typeof navigator)return v=p;var e,t,n,r=navigator.userAgent,i=s.getParser(r),o=(t=String(i.getBrowserVersion()),{major:parseInt((n=f.exec(t)||d.exec(t)||h.exec(t)||[])[1],10)||0,minor:parseInt(n[2],10)||0,patch:parseInt(n[3],10)||0}),a=i.getEngine(),g=i.getOSName(),m=String(i.getOSVersion()),_=!(!i.some(["mobile"])&&!i.some(["tablet"]));return(e={platform:function(e,t,n){if(/AFT[A-Z0-9]{1,}/i.test(e))return c.FIRETV;if(/Xbox/i.test(e))return c.XBOX;if(/playstation\s5/i.test(e))return c.PS5;if(/playstation\s4/i.test(e))return c.PS4;var r,i,o=t.getOSName();return/tizen/i.test(o)?c.TIZEN:/webos/i.test(o)?c.WEBOS:(r=/Android.*Build\/[A-Z0-9.]+/i.test(e),i=/; wv\)/.test(e),!y(e)&&r&&i)?c.ANDROIDTV:y(e)?c.CHROMECAST:n?c.MOBILE_WEB:c.DESKTOP}(r,i,_)})[l.CHROME]=!!i.some([l.CHROME]),e[l.FIREFOX]=!!i.some([l.FIREFOX]),e[l.EDGE]=!!i.some(["microsoft edge"])&&"Blink"===a.name,e[l.OPERA]=!!i.some([l.OPERA]),e[l.SAFARI]=!!i.some([l.SAFARI]),e.chromecast=navigator.userAgent.toLowerCase().indexOf("crkey")>-1,e.domain=window.location.host.split(".").slice(-2).join("."),e.electron=!!i.some(["electron"]),e.family=i.getBrowserName().toLowerCase(),e.host=window.location.host,e.major=o.major,e.minor=o.minor,e.msEdgeLegacy=!!i.some(["microsoft edge"])&&"Blink"!==a.name,e.msIE=!!i.some(["internet explorer"]),e.name=navigator.appVersion,e.osName=g,e.osVersion=m,e.patch=o.patch,e.url=window.location.href,e.userAgent=navigator.userAgent,e.mobile=_,e.supportsDataChannels="RTCPeerConnection"in window,e.supportsWebTransport="WebTransport"in window,e.supportsMSEInWorkers=u.Z.isSupportedInWorker(),e.supportsMuxedFMP4=!1===navigator.userAgent.toLowerCase().includes("playstation"),v=e}function m(e){return null!=e&&Object.values(c).includes(e)?e:c.DESKTOP}function y(e){return/Chromecast/i.test(e)}},530:function(e,t,n){"use strict";n.d(t,{YJ:function(){return s},aP:function(){return i},bz:function(){return o},dq:function(){return a}});var r=n(580);function i(){return"undefined"!=typeof MediaSource}function o(){var e='video/mp4; codecs="hvc1.1.40000000.L60.80.0.0.0.0.0"';return i()?MediaSource.isTypeSupported(e):""!==document.createElement("video").canPlayType(e)}function a(){var e='video/mp4; codecs="av01.0.05M.08"';return i()?MediaSource.isTypeSupported(e):""!==document.createElement("video").canPlayType(e)}function s(){var e=(0,r.cp)();return"Windows"===e.osName&&(e.chrome||e.firefox||e.msEdgeChromium)&&i()?"mediaCapabilities"in navigator?navigator.mediaCapabilities.decodingInfo({type:"media-source",video:{contentType:'video/mp4;codecs="vp09.00.41.08"',width:1920,height:1080,bitrate:8e6,framerate:60}}).then(function(e){return e.supported&&e.smooth}):Promise.resolve(MediaSource.isTypeSupported('video/mp4;codecs="vp09.00.10.08"')):Promise.resolve(!1)}},554:function(e,t,n){"use strict";n.d(t,{g:function(){return i}});var r,i=((r={}).UNKNOWN="Unspecified",r.FILE="File",r.SEGMENT="Segment",r.SOURCE="Source",r.DECODER="Decode",r.RENDERER="Render",r.MASTER_PLAYLIST="MasterPlaylist",r.MEDIA_PLAYLIST="MediaPlaylist",r.DRM="DRM",r)},911:function(e,t,n){"use strict";n.d(t,{B:function(){return o},y:function(){return a}});var r,i,o=((r={}).GENERIC="Error",r.NOT_SUPPORTED="ErrorNotSupported",r.NO_SOURCE="ErrorNoSource",r.INVALID_DATA="ErrorInvalidData",r.INVALID_STATE="ErrorInvalidState",r.INVALID_PARAMETER="ErrorInvalidParameter",r.TIMEOUT="ErrorTimeout",r.NETWORK="ErrorNetwork",r.NETWORK_IO="ErrorNetworkIO",r.AUTHORIZATION="ErrorAuthorization",r.NOT_AVAILABLE="ErrorNotAvailable",r),a=((i={})[i.GEOBLOCKED=1]="GEOBLOCKED",i[i.UNSUPPORTED_DEVICE=2]="UNSUPPORTED_DEVICE",i[i.ANONYMIZER_BLOCKED=3]="ANONYMIZER_BLOCKED",i[i.CELLULAR_NETWORK_PROHIBITED=4]="CELLULAR_NETWORK_PROHIBITED",i[i.UNAUTHORIZATION_ENTITLEMENTS=5]="UNAUTHORIZATION_ENTITLEMENTS",i[i.VOD_RESTRICTED=6]="VOD_RESTRICTED",i)},695:function(e,t,n){"use strict";n.d(t,{P:function(){return i}});var r,i=((r={}).CAPTURE_ENABLED="CaptureEnabled",r.CAPTURE_BUNDLE="CaptureBundle",r.CAPTURE_ANALYTICS="CaptureAnalytics",r.FMP4_SEGMENT="FMP4Segment",r)},0:function(e,t,n){"use strict";n.d(t,{C:function(){return o},_:function(){return a}});var r,i,o=((r={}).ID3="MetaID3",r.CAPTION="MetaCaption",r.SEI="SEI",r),a=((i={}).METADATA_ID="metadata.live-video.net",i.INBAND_METADATA_ID="inband.metadata.live-video.net",i)},184:function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var r,i=((r={}).INITIALIZED="PlayerInitialized",r.QUALITY_CHANGED="PlayerQualityChanged",r.QUALITIES_CHANGED="PlayerQualitiesChanged",r.DURATION_CHANGED="PlayerDurationChanged",r.VOLUME_CHANGED="PlayerVolumeChanged",r.MUTED_CHANGED="PlayerMutedChanged",r.PLAYBACK_RATE_CHANGED="PlayerPlaybackRateChanged",r.REBUFFERING="PlayerRebuffering",r.AUDIO_BLOCKED="PlayerAudioBlocked",r.PLAYBACK_BLOCKED="PlayerPlaybackBlocked",r.ERROR="PlayerError",r.RECOVERABLE_ERROR="PlayerRecoverableError",r.ANALYTICS_EVENT="PlayerAnalyticsEvent",r.TIME_UPDATE="PlayerTimeUpdate",r.SYNC_TIME_UPDATE="PlayerSyncTimeUpdate",r.BUFFER_UPDATE="PlayerBufferUpdate",r.SEEK_COMPLETED="PlayerSeekCompleted",r.SESSION_DATA="PlayerSessionData",r.STATE_CHANGED="PlayerStateChanged",r.WORKER_ERROR="PlayerWorkerError",r.METADATA="PlayerMetadata",r.TEXT_CUE="PlayerTextCue",r.TEXT_METADATA_CUE="PlayerTextMetadataCue",r.AD_CUE="PlayerAdCue",r.STREAM_SOURCE_CUE="PlayerStreamSourceCue",r.NETWORK_UNAVAILABLE="PlayerNetworkUnavailable",r.SEGMENT_DISCONTINUITY="PlayerSegmentDiscontinuity",r.SEGMENT_METADATA="PlayerSegmentMetadata",r.SOURCE_GROUP_CHANGED="PlayerSourceGroupChanged",r)},355:function(e,t,n){"use strict";n.d(t,{G:function(){return i}});var r,i=((r={}).AVAILABLE="RemotePlayerAvailable",r.UNAVAILABLE="RemotePlayerUnavailable",r.SESSION_STARTED="RemotePlayerSessionStarted",r.SESSION_ENDED="RemotePlayerSessionEnded",r)},376:function(e,t,n){"use strict";n.d(t,{p:function(){return i}});var r,i=((r={}).IDLE="Idle",r.READY="Ready",r.BUFFERING="Buffering",r.PLAYING="Playing",r.ENDED="Ended",r)},965:function(e,t,r){"use strict";r.d(t,{KJ:function(){return nt},vt:function(){return t9},Zx:function(){return t6},HF:function(){return ne},i$:function(){return t7},TH:function(){return t5}});var i,o,a,s,u,c,l,f,d,h,p,v,g,m=r(580),y=n(80208),_=r.n(y),b=r(184),E=null,S=null;function T(e){if(!e||!e.arg||!e.arg.name)return e;var t=e.type,n=e.arg,r=t===b.a.ANALYTICS_EVENT,i="video-play"===n.name||"minute-watched"===n.name||"video_error"===n.name||n.name.includes("gpu_");if(!r||!i)return e;if(!E&&!S)try{var o=document.createElement("canvas"),a=o.getContext("webgl")||o.getContext("experimental-webgl");if(a&&"getExtension"in a){var s=a.getExtension("WEBGL_debug_renderer_info");s&&"getParameter"in a&&(E=a.getParameter(s.UNMASKED_RENDERER_WEBGL),S=a.getParameter(s.UNMASKED_VENDOR_WEBGL))}}catch(e){}return e.arg.properties.gl_renderer=E,e.arg.properties.gl_vendor=S,e}var w=function(){function e(){var t=this;this.batteryManager=void 0,this.processor=this.processor.bind(this),e.isSupported()&&window.navigator.getBattery().then(function(e){t.batteryManager=e})}return e.isSupported=function(){var e;return void 0!==(null==(e=window)||null==(e=e.navigator)?void 0:e.getBattery)},e.prototype.processor=function(e){var t=e.type===b.a.ANALYTICS_EVENT,n=e.arg&&"minute-watched"===e.arg.name;return t&&n&&this.batteryManager&&(e.arg.properties.battery_percent=this.batteryManager.level),e},e}(),C=n(49165),k=r.n(C),I=n(81390),P=r.n(I),A=r(139);function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var L,D,x=(L=_()({},{enabled:!1,levels:{debug:!0,info:!0,warn:!0,error:!0}}),D=function(e){if(L.enabled&&L.levels[e]){for(var t=(new Date).toTimeString().split(" ")[0],n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];console[e].apply(console,[t+" - [VideoTransformer]"].concat(r))}},{debug:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return D.apply(void 0,[A.$.DEBUG].concat(t))},log:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return D.apply(void 0,[A.$.INFO].concat(t))},info:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return D.apply(void 0,[A.$.INFO].concat(t))},warn:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return D.apply(void 0,[A.$.WARN].concat(t))},error:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return D.apply(void 0,[A.$.ERROR].concat(t))},setConfig:function(e){var t={debug:!1,info:!1,warn:!1,error:!1},n=function(e,n){for(var r,i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return M(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,void 0):void 0}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e);!(r=i()).done;)t[r.value]=n};switch(e.level){case A.$.DEBUG:n([A.$.DEBUG,A.$.INFO,A.$.WARN,A.$.ERROR],!0);break;case A.$.INFO:n([A.$.INFO,A.$.WARN,A.$.ERROR],!0);break;case A.$.WARN:n([A.$.WARN,A.$.ERROR],!0);break;case A.$.ERROR:n([A.$.ERROR],!0)}L.enabled=e.enabled,L.levels=_()({},t)}});x.setConfig({enabled:!0,level:A.$.WARN});var R=((eO={}).gpu_pending="Awaiting WebGPU adapter",eO.gpu_unavailable="WebGPU unavailable",eO.gpu_adapter_unavailable="WebGPU adapter unavailable",eO.gpu_adapterinfo_undefined="WebGPU adapter.info undefined",eO.gpu_error="WebGPU error",eO),O=r(530),N=r(290),U={keySystem:"org.w3.clearkey",uuid:"1077efec-c0b2-4d02-ace3-3c1e52e2fb4b"},F={keySystem:"com.apple.fps.2_0",certUrl:"https://fairplay.twitch.keyos.com/api/v4/getCertificate?certHash=a17fd33d3843df9b17679ccf50a419b2",licenseUrl:"https://fairplay.twitch.keyos.com/api/v4/getLicense",uuid:"94CE86FB-07FF-4F43-ADB8-93D2FA968CA2"},B={keySystem:"com.microsoft.playready",licenseUrl:"https://playready.twitch.keyos.com/api/v4/getLicense",uuid:"9a04f079-9840-4286-ab92-e65be0885f95"},V={keySystem:"com.widevine.alpha",licenseUrl:"https://widevine.twitch.keyos.com/api/v4/getLicense",uuid:"edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"},G={CLEARKEY:U,FAIRPLAY:F,PLAYREADY:B,WIDEVINE:V},H={"com.widevine.alpha":V,"com.microsoft.playready":B,"com.apple.fps.2_0":F,"org.w3.clearkey":U},W=N.a1,j=N.Pt,z={value:N.Ec,message:"Error while requesting DRM license"},K={value:N.Ri,message:"DRM license not available"},Q={NO_CDM_SUPPORT:{value:j,message:"Your browser does not support any DRM Content Decryption Modules"},SESSION_UPDATE:{value:j,message:"There was an issue while updating DRM License"},LICENSE_REQUEST:z,LICENSE_REQUEST_AUTHORIZATION:{value:N.$1,message:"DRM license not authorized for this browser version"},LICENSE_REQUEST_NOT_AVAILABLE:K,LICENSE_SERVER:{value:N.xA,message:"DRM license server error"},KEY_SESSION_CREATION:{value:j,message:"Error creating key session"},KEY_SESSION_INTERNAL:{value:j,message:"Encryption key not usable because of internal error in CDM"},NO_PSSH_FOUND:{value:j,message:"Unable to find valid CDM support on media"},AUTH_XML_REQUEST:{value:W,message:"Request for AuthXML failed"},CERT_REQUEST:{value:W,message:"Request for DRM certificate failed"}};function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function Y(e){return e instanceof Uint8Array||e instanceof Uint16Array?e.buffer:e}function Z(e,t){return new Promise(function(n,r){var i=new XMLHttpRequest;for(var o in i.open(t.method,e,!0),t.headers)Object.prototype.hasOwnProperty.call(t.headers,o)&&i.setRequestHeader(o,t.headers[o]);i.responseType=t.responseType,i.onload=function(){200===i.status&&n(i.response)},i.onloadend=function(){r(i.status)},i.send(t.body)})}function J(e,t){for(var n=new DataView(e.buffer,e.byteOffset,e.byteLength),r=X(t),i=0;i<e.byteLength;){var o=n.getUint32(i);if(n.getUint32(i+4)===r)return e.subarray(i+8,i+o);i+=o}return new Uint8Array(e)}function X(e){return(e.charCodeAt(0)<<24)+(e.charCodeAt(1)<<16)+(e.charCodeAt(2)<<8)+e.charCodeAt(3)}function $(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function ee(e){for(var t=atob(e),n=t.length,r=new Uint8Array(n),i=0;i<n;i++)r[i]=t.charCodeAt(i);return r}function et(e){return decodeURIComponent(e.replace(/\+/g," "))}var en=r(0),er=r(355),ei=r(376);function eo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var ea=[{initDataTypes:["cenc"],audioCapabilities:[{contentType:'audio/mp4;codecs="mp4a.40.2"'}],videoCapabilities:[{robustness:"SW_SECURE_CRYPTO",contentType:'video/mp4;codecs="avc1.42E01E"'}]}],es=function(){function e(e){var t=this;this.video=void 0,this.listener=void 0,this.cdmSupport=void 0,this.selectedCDM=void 0,this.mediaKeys=void 0,this.pendingSessions=void 0,this.sessions=void 0,this.authXml=void 0,this.video=e.video,this.listener=e.listener,this.cdmSupport=null,this.selectedCDM=null,this.mediaKeys=void 0,this.pendingSessions=[],this.reset(),this.video.addEventListener("encrypted",function(e){return t.handleEncrypted(e)}),this.video.addEventListener("webkitneedkey",function(e){return t.handleWebKitEncrypted(e)})}var t,n,r,i,o,a=e.prototype;return a.configure=function(e){var t=this;if(!this.authXml){var n,r,i=new URL(e),o=i.pathname.split("/"),a=o[o.length-1].split(".")[0],s=(n=new URL(e).searchParams,r={},n.forEach(function(e,t){r[et(t)]=e?et(e):""}),r),u=s.token,c=s.sig,l="https://"+i.host+"/api/authxml/"+a+"?token="+encodeURIComponent(u)+"&sig="+c;this.authXml=Z(l,{method:"GET",responseType:"text"}).catch(function(e){t.handleError(Object.assign({code:e},Q.AUTH_XML_REQUEST))})}},a.reset=function(){this.authXml=null,this.sessions=[]},a.isProtected=function(){return null!==this.authXml},a.handleError=function(e){this.listener.onSinkError({value:e.value||N.Pt,code:e.code||0,message:e.message||""})},a.hasSession=function(e){if(!e)return!1;for(var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return eo(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eo(e,void 0):void 0}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(this.sessions);!(t=n()).done;){var r=t.value;if(r.initData&&function(e,t){if((e=Y(e))===(t=Y(t)))return!0;if(e.byteLength!==t.byteLength)return!1;for(var n=new DataView(e),r=new DataView(t),i=0;i<n.byteLength;i++)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0}(r.initData,e))return!0}return!1},a.createKeySystemSupportChain=function(){if(null===this.cdmSupport||0===this.cdmSupport.length)return Promise.reject(Q.NO_PSSH_FOUND);var e=Promise.reject();return this.cdmSupport.forEach(function(t){e=e.catch(function(){return navigator.requestMediaKeySystemAccess(t.keySystem,ea)})}),e=e.catch(function(){return Promise.reject(Q.NO_CDM_SUPPORT)})},t=k()(P().mark(function e(t){var n,r;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasSession(t.initData)){e.next=2;break}return e.abrupt("return");case 2:if(this.sessions.push(t),"sinf"!==t.initDataType){e.next=6;break}return this.handleWebKitEncrypted(t),e.abrupt("return");case 6:if(null===this.cdmSupport&&(this.cdmSupport=function(e){var t,n;return t=function(e){if(null===e)return[];for(var t=new DataView(e.buffer||e),n=[],r=0;!(r>=t.buffer.byteLength);){var i=r+t.getUint32(r);if(r+=4,t.getUint32(r)===X("pssh")){r+=4;var o=t.getUint8(r);if(0===o||1===o){r++,r+=3;for(var a="",s=0;s<4;s++)a+=$(t.getUint8(r+s));r+=4,a+="-";for(var u=0;u<2;u++)a+=$(t.getUint8(r+u));r+=2,a+="-";for(var c=0;c<2;c++)a+=$(t.getUint8(r+c));r+=2,a+="-";for(var l=0;l<2;l++)a+=$(t.getUint8(r+l));r+=2,a+="-";for(var f=0;f<6;f++)a+=$(t.getUint8(r+f));r+=6,a=a.toLowerCase(),r+=4,n.push(a),r=i}else r=i}else r=i}return n}(e),n=[],t.forEach(function(e){Object.keys(G).forEach(function(t){var r=G[t];r.uuid.toLowerCase()===e.toLowerCase()&&n.push(r)})}),n}(t.initData)),void 0!==this.mediaKeys){e.next=24;break}return this.mediaKeys=null,e.prev=9,e.next=12,this.createKeySystemSupportChain();case 12:return n=e.sent,this.selectedCDM=H[n.keySystem],e.next=16,n.createMediaKeys();case 16:return r=e.sent,e.next=19,this.setMediaKeys(r);case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(9),this.handleError(e.t0);case 24:this.addSession(t);case 25:case"end":return e.stop()}},e,this,[[9,21]])})),a.handleEncrypted=function(e){return t.apply(this,arguments)},a.setMediaKeys=function(e){var t=this;return this.mediaKeys=e,this.pendingSessions.forEach(function(e){return t.createSessionRequest(e).catch(function(){t.handleError(Q.KEY_SESSION_CREATION)})}),this.pendingSessions=[],this.video.setMediaKeys(this.mediaKeys)},a.addSession=function(e){var t=this;this.mediaKeys?this.createSessionRequest(e).catch(function(){t.handleError(Q.KEY_SESSION_CREATION)}):this.pendingSessions.push(e)},a.createSessionRequest=function(e){var t,n=this,r=e.initDataType,i=e.initData,o=null==(t=this.mediaKeys)?void 0:t.createSession();return o?(o.addEventListener("message",function(e){return n.handleMessage(e)}),o.addEventListener("keystatuseschange",function(e){return n.handleKeyStatusesChange(e,i)}),o.generateRequest(r,i)):Promise.reject()},a.handleKeyStatusesChange=function(e,t){var n=this,r=e.target,i=!1;r.keyStatuses.forEach(function(e){switch(e){case"expired":i=!0;break;case"internal-error":n.handleError(Q.KEY_SESSION_INTERNAL)}}),i&&r.close().then(function(){return n.removeSession(t)})},a.removeSession=function(e){for(var t=0;t<this.sessions.length;t++)if(this.sessions[t].initData===e)return void this.sessions.splice(t,1)},n=k()(P().mark(function e(t){var n,r,i=this;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target,e.next=3,this.generateLicense(t.message);case 3:(r=e.sent)&&n.update(r).catch(function(){i.handleError(Q.SESSION_UPDATE)});case 5:case"end":return e.stop()}},e,this)})),a.handleMessage=function(e){return n.apply(this,arguments)},r=k()(P().mark(function e(t){var n,r,i;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.selectedCDM!==G.CLEARKEY){e.next=5;break}return n=JSON.parse((new TextDecoder).decode(t)).kids.map(function(e){return{kty:"oct",alg:"A128KW",kid:e,k:e}}),r=(new TextEncoder).encode(JSON.stringify({keys:n})),e.abrupt("return",Promise.resolve(r));case 5:if(!this.authXml){e.next=10;break}return e.next=8,this.authXml;case 8:return i=e.sent,e.abrupt("return",this.requestLicense(t,i));case 10:this.handleError(Q.AUTH_XML_REQUEST);case 11:case"end":return e.stop()}},e,this)})),a.generateLicense=function(e){return r.apply(this,arguments)},i=k()(P().mark(function e(t,n){var r,i,o,a=this;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i={method:"POST",responseType:"arraybuffer",body:t,headers:{customdata:n,"Content-Type":"application/octet-stream"}},this.selectedCDM===G.PLAYREADY&&(i.body=(o=function(e){var t,n,r=String.fromCharCode.apply(null,new Uint16Array(e)),i=(new DOMParser).parseFromString(r,"application/xml");return{headers:Array.from(i.querySelectorAll("HttpHeader")).reduce(function(e,t){var n,r,i=null==(n=t.querySelector("name"))?void 0:n.textContent,o=null==(r=t.querySelector("value"))?void 0:r.textContent;return i&&o&&(e[i]=o),e},{}),body:(n=null==(t=i.querySelector("Challenge"))?void 0:t.textContent)?atob(n):""}}(t)).body,i.headers=Object.assign(i.headers,o.headers)),e.abrupt("return",Z((null==(r=this.selectedCDM)?void 0:r.licenseUrl)||"",i).catch(function(e){var t;switch(e){case 0:t=Q.LICENSE_REQUEST;break;case 404:t=Q.LICENSE_REQUEST_NOT_AVAILABLE;break;case 403:t=Q.LICENSE_REQUEST_AUTHORIZATION;break;default:t=Q.LICENSE_SERVER}a.handleError(Object.assign({code:e},t))}));case 3:case"end":return e.stop()}},e,this)})),a.requestLicense=function(e,t){return i.apply(this,arguments)},o=k()(P().mark(function e(t){var n,r=this;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.selectedCDM=G.FAIRPLAY,e.prev=1,e.next=4,Z(G.FAIRPLAY.certUrl||"",{method:"GET",responseType:"arraybuffer",headers:{Pragma:"Cache-Control: no-cache","Cache-Control":"max-age=0"}});case 4:n=e.sent,this.setupWebKitMediaKeys(t,n).catch(function(e){return r.handleError(e)}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.handleError(Object.assign({code:e.t0},Q.CERT_REQUEST));case 11:case"end":return e.stop()}},e,this,[[1,8]])})),a.handleWebKitEncrypted=function(e){return o.apply(this,arguments)},a.setupWebKitMediaKeys=function(e,t){var n,r,i=this;if(!e.initData)return Promise.reject("Missing initData on MediaEncryptedEvent");this.video.webkitKeys||this.video.webkitSetMediaKeys(new window.WebKitMediaKeys(G.FAIRPLAY.keySystem));var o=(n=e.initData,r=J(ee(JSON.parse(String.fromCharCode.apply(null,n)).sinf[0]),"schi"),function(e){for(var t,n="",r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return q(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q(e,void 0):void 0}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e);!(t=r()).done;)n+=$(t.value);return n}(J(r,"tenc").subarray(8,24))),a=this.video.webkitKeys.createSession("video/mp4",e.initData);return a.contentId=o,new Promise(function(e,n){if(i.video.webkitKeys||n("Issue setting fairplay media keys"),!a)return n("Could not create key session");a.addEventListener("webkitkeymessage",function(e){var r=e.target;"certificate"===String.fromCharCode.apply(null,e.message)?r.update(new Uint8Array(t)):i.getWebkitLicense(e.message,o).then(function(e){var t=e.trim();"<ckc>"===t.substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6)),r.update(ee(t))}).catch(n)}),a.addEventListener("webkitkeyadded",e),a.addEventListener("webkitkeyerror",n)})},a.getWebkitLicense=function(e,t){return this.authXml?this.authXml.then(function(n){return Z(G.FAIRPLAY.licenseUrl||"",{method:"POST",body:"spc="+btoa(String.fromCharCode.apply(null,new Uint16Array(e)))+"&assetId="+t,responseType:"text",headers:{"Content-Type":"application/x-www-form-urlencoded",customdata:n}}).catch(function(e){return Promise.reject(Object.assign({code:e},Q.LICENSE_REQUEST))})}):Promise.reject(Q.AUTH_XML_REQUEST)},e}(),eu=n(53911),ec=r.n(eu),el=function(){function e(){}var t=e.prototype;return t.addTrack=function(e){},t.bufferDuration=function(){return 0},t.buffered=function(){return{start:0,end:0}},t.getBufferedRanges=function(e){return[]},t.captureGesture=function(){},t.configure=function(e){},t.delete=function(){},t.endOfStream=function(){},t.enqueue=function(e){},t.getCurrentTime=function(){return 0},t.getPlaybackRate=function(){return 0},t.getVolume=function(){return 0},t.invoke=function(e){this[e.name].call(this,e.arg)},t.isMuted=function(){return!1},t.onSourceDurationChanged=function(e){},t.onPlayerConfigurationChanged=function(e){},t.pause=function(){},t.play=function(){},t.reinit=function(){},t.remove=function(e){},t.seekTo=function(e){},t.setMuted=function(e){},t.setPlaybackRate=function(e){},t.setTimestampOffset=function(e){},t.setVolume=function(e){},t.changeSrc=function(e){},t.changeSrcObj=function(e){},t.onSegmentDiscontinuity=function(){},e}(),ef="pc-chromecast-sender",ed=function(e){function t(n){var r;return(r=e.call(this)||this).remotePlayer=void 0,r.remotePlayerController=void 0,r.listener=void 0,r.seekTime=void 0,r.currentDuration=void 0,r.listener=n,r.currentDuration=0,t.prepareCastContext().then(function(){r.remotePlayer=new cast.framework.RemotePlayer,r.remotePlayerController=new cast.framework.RemotePlayerController(r.remotePlayer)}).catch(function(){r.listener.onSessionError()}),r}ec()(t,e),t.canCast=function(){return(0,m.cp)().chrome},t.stopLookingForRemotePlaybackDevices=function(e){void 0!==window.cast&&window.cast&&window.cast.framework&&cast.framework.CastContext.getInstance().removeEventListener(cast.framework.CastContextEventType.CAST_STATE_CHANGED,e)},n=k()(P().mark(function e(n){var r,i;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.prepareCastContext();case 3:return r=e.sent,i=function(e){switch(e.castState){case cast.framework.CastState.NO_DEVICES_AVAILABLE:break;case cast.framework.CastState.NOT_CONNECTED:n.onRemoteDevice(!0);break;case cast.framework.CastState.CONNECTED:var t=r.getCurrentSession();t&&t.getSessionState()===cast.framework.SessionState.SESSION_RESUMED&&n.onRemoteReconnect()}},r.addEventListener(cast.framework.CastContextEventType.CAST_STATE_CHANGED,i),r.setOptions({receiverApplicationId:"B3DCF968",autoJoinPolicy:chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED}),e.abrupt("return",i);case 10:e.prev=10,e.t0=e.catch(0),n.onRemoteDevice(!1);case 13:case"end":return e.stop()}},e,null,[[0,10]])})),t.lookForRemotePlaybackDevices=function(e){return n.apply(this,arguments)},i=k()(P().mark(function e(){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===window.cast||!window.cast||!window.cast.framework){e.next=2;break}return e.abrupt("return",Promise.resolve(cast.framework.CastContext.getInstance()));case 2:return e.abrupt("return",new Promise(function(e,t){if(r.g.__onGCastApiAvailable=function(n){n?e(cast.framework.CastContext.getInstance()):t()},!document.getElementById(ef)){var n=document.createElement("script");n.id=ef,n.onerror=function(){document.body.removeChild(n),r.g.__onGCastApiAvailable=function(){},t()},n.async=!0,n.src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1",document.body.appendChild(n)}}));case 3:case"end":return e.stop()}},e)})),t.prepareCastContext=function(){return i.apply(this,arguments)};var n,i,o,a,s,u=t.prototype;return o=k()(P().mark(function e(n){var r,i,o,a,s,u;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.path,e.prev=1,e.next=4,t.prepareCastContext();case 4:if(a=(o=e.sent).getCurrentSession()){e.next=13;break}return e.next=9,o.requestSession();case 9:a=o.getCurrentSession(),this.setupRemotePlayerListeners(a),e.next=14;break;case 13:a.getSessionState()===cast.framework.SessionState.SESSION_RESUMED&&this.setupRemotePlayerListeners(a);case 14:return(s=new chrome.cast.media.MediaInfo(r,"")).streamType=chrome.cast.media.StreamType.BUFFERED,s.metadata=new chrome.cast.media.GenericMediaMetadata,s.customData={analytics:{chromecast_sender:"player-core",platform:"web"}},this.remotePlayerController.stop(),u=new chrome.cast.media.LoadRequest(s),this.seekTime>0&&(u.currentTime=this.seekTime,this.seekTime=0),this.currentDuration=0,e.next=25,null==(i=a)?void 0:i.loadMedia(u);case 25:e.next=30;break;case 27:return e.prev=27,e.t0=e.catch(1),e.abrupt("return",this.handleError(e.t0));case 30:case"end":return e.stop()}},e,this,[[1,27]])})),u.configure=function(e){return o.apply(this,arguments)},a=k()(P().mark(function e(n){var r;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=!0),e.next=3,t.prepareCastContext();case 3:(r=e.sent.getCurrentSession())&&r.getSessionState()!==cast.framework.SessionState.SESSION_RESUMED&&r.endSession(n);case 6:case"end":return e.stop()}},e)})),u.stopMedia=function(e){return a.apply(this,arguments)},u.invoke=function(e){this[e.name].call(this,e.arg)},u.play=function(){this.remotePlayer&&this.remotePlayer.isPaused&&this.remotePlayerController.playOrPause()},u.pause=function(){this.remotePlayer&&!this.remotePlayer.isPaused&&this.remotePlayerController.playOrPause()},u.seekTo=function(e){this.remotePlayer&&(this.remotePlayer.playerState!==chrome.cast.media.PlayerState.IDLE?(this.remotePlayer.currentTime=e,this.remotePlayerController.seek()):this.seekTime=e)},u.getCurrentTime=function(){return this.remotePlayer?this.remotePlayer.currentTime:0},u.delete=function(){this.remotePlayer&&this.stopMedia()},u.setMuted=function(e){this.remotePlayer&&e!==this.remotePlayer.isMuted&&this.remotePlayerController.muteOrUnmute()},u.isMuted=function(){return!!this.remotePlayer&&this.remotePlayer.isMuted},u.setVolume=function(e){this.remotePlayer&&(this.remotePlayer.volumeLevel=e,this.remotePlayerController.setVolumeLevel())},u.getVolume=function(){return this.remotePlayer?this.remotePlayer.volumeLevel:0},s=k()(P().mark(function e(){var n;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.prepareCastContext();case 2:return n=e.sent.getCurrentSession(),e.abrupt("return",(null==n?void 0:n.getCastDevice().friendlyName)||"");case 5:case"end":return e.stop()}},e)})),u.getDevice=function(){return s.apply(this,arguments)},u.setupRemotePlayerListeners=function(e){var t,n=this,r=(t=k()(P().mark(function t(){var r,i;return P().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:(r=e.getMediaSession())&&(i=r.media,0===n.currentDuration&&null===i.duration&&(n.currentDuration=1/0,n.listener.onSinkDurationChanged(n.currentDuration)),n.listener.onSinkTimeUpdate());case 2:case"end":return t.stop()}},t)})),function(){return t.apply(this,arguments)}),i=function(){switch(n.remotePlayer.playerState){case chrome.cast.media.PlayerState.BUFFERING:n.listener.onSinkBuffering();break;case chrome.cast.media.PlayerState.PLAYING:n.listener.onSinkPlaying(!1);break;case chrome.cast.media.PlayerState.IDLE:var t=e.getMediaSession();t&&t.idleReason===chrome.cast.media.IdleReason.FINISHED&&n.listener.onSinkEnded()}},o=function(){n.listener.onSinkVolumeChanged(n.remotePlayer.volumeLevel,!0)},a=function(){n.listener.onSinkMutedChanged(n.remotePlayer.isMuted)},s=function(){0!==n.remotePlayer.duration&&(n.currentDuration=n.remotePlayer.duration,n.listener.onSinkDurationChanged(n.currentDuration))},u=function(){n.remotePlayerController.removeEventListener(cast.framework.RemotePlayerEventType.CURRENT_TIME_CHANGED,r),n.remotePlayerController.removeEventListener(cast.framework.RemotePlayerEventType.PLAYER_STATE_CHANGED,i),n.remotePlayerController.removeEventListener(cast.framework.RemotePlayerEventType.VOLUME_LEVEL_CHANGED,o),n.remotePlayerController.removeEventListener(cast.framework.RemotePlayerEventType.IS_MUTED_CHANGED,a),n.remotePlayerController.removeEventListener(cast.framework.RemotePlayerEventType.DURATION_CHANGED,s),n.listener.onSessionStop()};e.addEventListener(cast.framework.SessionEventType.MEDIA_SESSION,function(){n.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.CURRENT_TIME_CHANGED,r),n.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.PLAYER_STATE_CHANGED,i),n.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.VOLUME_LEVEL_CHANGED,o),n.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.IS_MUTED_CHANGED,a),n.remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.DURATION_CHANGED,s),n.listener.onSessionStarted(e.getCastDevice().friendlyName)});var c=e.getSessionObj();c.addUpdateListener(function(){c.status===chrome.cast.SessionStatus.STOPPED&&u()}),c.addMediaListener(u)},u.handleError=function(e){if(chrome.cast)switch(e){case chrome.cast.ErrorCode.SESSION_ERROR:this.listener.onSessionError();break;case chrome.cast.ErrorCode.RECEIVER_UNAVAILABLE:this.listener.onRemoteDevice(!1);break;case chrome.cast.ErrorCode.LOAD_MEDIA_FAILED:this.listener.onLoadMediaError();break;case chrome.cast.ErrorCode.CANCEL:this.listener.onUserCancel();break;default:this.listener.onSinkError({value:1,code:0,message:"Error requesting chromecast session"})}else this.listener.onSinkError({value:1,code:0,message:"Error loading chromecast SDK"})},t}(el),eh=r(623),ep=function(e){function t(t,n){var r;return(r=e.call(this)||this).listener=t,r.video=n,r.unsubscribe=void 0,r.unsubscribe=(0,eh.B1)(n,"error",r.onVideoError.bind(r)),r}ec()(t,e);var n=t.prototype;return n.onVideoError=function(){var e,t,n=null!=(e=null==this||null==(t=this.video)?void 0:t.error)?e:{},r=n.code,i=void 0===r?-1:r,o=n.message;this.listener.onSinkError({value:i,code:i,message:void 0===o?"":o})},n.seekTo=function(e){this.video.currentTime=e},n.setPlaybackRate=function(e){this.video.playbackRate=e},n.setVolume=function(e){this.video.volume=e},n.getVolume=function(){return this.video.volume},n.isMuted=function(){return this.video.muted},n.setMuted=function(e){this.video.muted=e},n.getPlaybackRate=function(){return this.video.playbackRate},n.delete=function(){var e;null==(e=this.unsubscribe)||e.call(this),this.unsubscribe=void 0},t}(el),ev=function(){function e(e,t){this.muted=void 0,this.video=void 0,this.listener=void 0,this.unsubscribes=[],this.expectingMutedChanged=!1,this.expectingVolumeChanged=!1,this.expectedRateChange=void 0,this.video=e,this.listener=t,this.muted=e.muted,this.unsubscribes.push((0,eh.B1)(e,"volumechange",this.volumeChange.bind(this))),this.unsubscribes.push((0,eh.B1)(e,"ratechange",this.rateChange.bind(this)))}var t=e.prototype;return t.volumeChange=function(){var e=!this.expectingVolumeChanged;this.expectingMutedChanged=!1,this.expectingVolumeChanged=!1;var t=this.video.muted;this.muted!==t?(this.muted=t,this.listener.onSinkMutedChanged(t)):this.listener.onSinkVolumeChanged(this.video.volume,e)},t.rateChange=function(){this.video.playbackRate!==this.expectedRateChange&&this.listener.onSinkPlaybackRateChanged(this.video.playbackRate)},t.unsubscribe=function(){this.unsubscribes.forEach(function(e){return e()})},t.onConfigure=function(){this.expectingVolumeChanged&&(this.listener.onSinkVolumeChanged(this.video.volume,!1),this.expectingVolumeChanged=!1),this.expectingMutedChanged&&(this.muted=this.video.muted,this.listener.onSinkMutedChanged(this.video.muted),this.expectingMutedChanged=!1),this.expectedRateChange=void 0},t.trackRPC=function(e){var t=e.name,n=e.arg;"setVolume"===t&&this.video.volume!==n?this.expectingVolumeChanged=!0:"setMuted"===t&&this.video.muted!==n?this.expectingMutedChanged=!0:"setPlaybackRate"===t&&this.video.playbackRate!==n&&(this.expectedRateChange=n)},e}(),eg=n(2813),em=r.n(eg),ey=("undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r.g?r.g:void 0).Promise||em(),e_=function(e){function t(t,n){var r;return(r=e.call(this)||this).paused=!0,r.listener=void 0,r.video=void 0,r.unsubscribers=void 0,r.lastVolumeChangeEvent=void 0,r.video=t,r.listener=n,r.paused=!0,r.unsubscribers=[],r.addListener("volumechange",r.recordMuteChange.bind(r)),r.recordMuteChange(),r}ec()(t,e);var n=t.prototype;return n.pause=function(){this.paused=!0,this.video.pause()},n.setPlaybackRate=function(e){this.video.playbackRate=e},n.delete=function(){this.unsubscribers.forEach(function(e){return e()})},n.addListener=function(e,t,n){void 0===n&&(n=this.video),this.unsubscribers.push((0,eh.B1)(n,e,t))},n.recordMuteChange=function(){this.lastVolumeChangeEvent={time:this.video.currentTime,muted:this.video.muted}},n.checkStopped=function(e){return!this.video.paused||this.video.ended||this.video.error||this.paused||this.listener.onSinkStop(e||this.unmuteAutopause()),!1},n.unmuteAutopause=function(){var e=this.lastVolumeChangeEvent;return!this.video.muted&&!e.muted&&this.video.currentTime===e.time},t}(el),eb=r(789),eE=r(223),eS=function(e){function t(t,n,r){var i;return void 0===r&&(r={}),(i=e.call(this,t,n)||this).onSinkIdle=void 0,i.logger=void 0,i.intervalId=void 0,i.idle=void 0,i.lastPlayhead=void 0,i.lastBufferEnd=void 0,i.idleTimeout=void 0,i.playAttempt=!1,i.seeking=!1,i.audioBufferList=void 0,i.awaitingAutoplayCompletion=!1,i.config=void 0,i.config=r,i.logger=(0,eE.createLogger)({name:"playback-monitor",enabled:!0,levels:{debug:!1,log:!0,info:!0,warn:!0,error:!0}}),i.intervalId=0,i.idle=!0,i.lastPlayhead=0,i.lastBufferEnd=0,i.idleTimeout=-1,i.audioBufferList=[],i.bindEvents(),i}ec()(t,e);var n=t.prototype;return n.bindEvents=function(){var e=this;this.addListener("play",function(){return e.onVideoPlay()}),this.addListener("pause",function(){return e.onVideoPause()}),this.addListener("timeupdate",function(){return e.onVideoTimeUpdate()}),this.addListener("ended",function(){return e.onVideoEnded()}),this.addListener("error",function(){return e.onVideoError()}),this.addListener("playing",function(){return e.onVideoPlaying()}),this.addListener("seeking",function(){return e.onVideoSeeking()})},n.delete=function(){e.prototype.delete.call(this),this.audioBufferList=[],clearInterval(this.intervalId)},n.play=function(){this.paused=!1;var e=this.video.buffered,t=this.video.currentTime;if(0===e.length)return this.logger.debug("Nothing buffered on play call"),void this.playInternal();this.logger.canLog("debug")&&this.logger.debug("Play - currentTime "+this.video.currentTime+" buffer ranges "+(0,eh.uD)(this.video.buffered));var n=(0,eh.xE)(e,t);n!==t&&(this.logger.log("Play - moving to buffered region",n,t),console.warn("Moving to buffered region",n,t),this.listener.onSinkGapJump(n-t),this.seekTo(n)),this.playInternal()},n.endOfStream=function(){this.idle=!1,clearTimeout(this.idleTimeout),this.idleTimeout=-1},n.seekTo=function(e){this.video.seekable.length?e!==this.video.currentTime?(this.logger.debug("Seeking from "+this.video.currentTime+" to "+e),this.seeking=!0,this.video.currentTime=e):this.logger.debug("Seek called at current time"):this.logger.debug("Seek called, but no seekable ranges")},n.addSourceBuffer=function(e,t){(t.indexOf("mp4a")>-1||t.indexOf("opus")>-1)&&(this.audioBufferList=[e])},n.clearSourceBuffers=function(){this.audioBufferList=[]},n.onIdle=function(){var e;this.listener.onSinkIdle(),null==(e=this.onSinkIdle)||e.call(this)},n.onBuffering=function(){this.listener.onSinkBuffering()},n.onVideoPlay=function(){var e=this;this.playAttempt?(this.logger.debug("onVideoPlay - handling Core play call"),this.lastPlayhead=this.video.currentTime,clearInterval(this.intervalId),this.intervalId=self.setInterval(function(){return e.heartbeat()},eb.HJ)):(this.logger.debug("onVideoPlay - handling native play call"),this.pause(),this.listener.play()),this.playAttempt=!1},n.onVideoPause=function(){this.logger.debug("onVideoPause - awaitingAutoplayCompletion: "+this.awaitingAutoplayCompletion),this.awaitingAutoplayCompletion||(this.logger.debug("onVideoPause handled, clearing heartbeatInterval and stalledPlayheadTimeout"),this.checkStopped(!1),clearInterval(this.intervalId))},n.onVideoTimeUpdate=function(){this.logger.canLog("debug")&&this.logger.debug("Time update\n"+this.getPlayheadDebugLogString()),clearTimeout(this.idleTimeout),this.idleTimeout=-1,this.listener.onSinkTimeUpdate();var e=(0,eh.vG)(this.video.buffered,this.video.currentTime,eb.de);this.checkBufferUpdate(e),this.updateIdle(e)},n.onVideoEnded=function(){this.listener.onSinkEnded()},n.onVideoPlaying=function(){this.logger.debug("onVideoPlaying - video.paused: "+this.video.paused),this.video.paused||this.listener.onSinkPlaying(this.paused)},n.onVideoSeeking=function(){if(this.seeking)return this.logger.debug("onVideoSeeking - already in a seek"),void(this.seeking=!1);this.logger.debug("onVideoSeeking - seeking to "+this.video.currentTime),this.listener.seekTo(this.video.currentTime)},n.onVideoError=function(){var e,t,n=null!=(e=null==this||null==(t=this.video)?void 0:t.error)?e:{},r=n.code,i=void 0===r?-1:r,o=n.message;this.listener.onSinkError({value:i,code:i,message:void 0===o?"":o})},n.heartbeat=function(){var e=(0,eh.vG)(this.video.buffered,this.video.currentTime,eb.de);if(this.video.paused)clearInterval(this.intervalId);else if(this.video.currentTime===this.lastPlayhead){var t=(0,eh.tX)(this.video.buffered,this.video.currentTime,eb.de);this.logger.debug("Heartbeat - playhead stall detected, currentPosition "+this.video.currentTime+" nextPlayablePosition "+t),t!==this.video.currentTime&&(this.audioBufferList.map(function(e){(0,eh.gd)("Audio Buffer",e.buffered)}),(0,eh.gd)("<video> Buffer",this.video.buffered),console.warn("jumping "+(t-this.video.currentTime)+"s gap, current position "+this.video.currentTime+", new position "+t),this.listener.onSinkGapJump(t-this.video.currentTime),this.seekTo(t)),this.updateIdle(e)}else this.logger.debug("Heartbeat - playhead not stalled"),this.checkBufferUpdate(e),this.lastPlayhead=this.video.currentTime},n.checkBufferUpdate=function(e){var t=e.end;t!==this.lastBufferEnd&&(this.lastBufferEnd=t,this.listener.onSinkBufferUpdate())},n.updateIdle=function(e){var t=this,n=e.end,r=void 0===n?0:n,i=this.video,o=i.currentTime,a=i.paused;if(a&&!this.idle)this.idle=!0,this.onIdle();else if(!a){var s=r-o<eb.de;s&&!this.idle&&(console.warn("Playhead stalling at "+o+", buffer end "+r),clearTimeout(this.idleTimeout),this.idleTimeout=self.setTimeout(function(){return t.onBufferingTimeout()},eb.Pp),this.onBuffering()),this.idle=s}},n.updateConfig=function(e){this.config=_()({},this.config,e),this.logger.info("Config changed",this.config)},n.onBufferingTimeout=function(){clearTimeout(this.idleTimeout),this.idleTimeout=-1,this.listener.onSinkError({value:N.yY,code:N.yY,message:"Buffering timeout"})},n.playInternal=function(){var e=this;this.logger.debug("playInternal"),this.playAttempt=!0,this.awaitingAutoplayCompletion=!0,ey.resolve(this.video.play()).then(function(){e.logger.debug("Play promise resolved"),e.awaitingAutoplayCompletion=!1}).catch(function(){e.logger.debug("Play promise rejected"),e.playAttempt=!1,e.checkStopped(!0)})},n.getPlayheadDebugLogString=function(){var e=(0,eh.vG)(this.video.buffered,this.video.currentTime,eb.de);return"current buffer start: "+e.start+"\ncurrent time: "+this.video.currentTime+"\ncurrent buffer end: "+e.end+"\nbuffer ranges: "+(0,eh.uD)(this.video.buffered)+"\nlastPlayhead: "+this.lastPlayhead+"\nlastBufferEnd: "+this.lastBufferEnd+"\nvideo.paused: "+this.video.paused+"\nthis.paused: "+this.paused+"\nthis.idle: "+this.idle+"\nthis.seeking: "+this.seeking},t}(e_),eT=function(e){function t(t,n){var r;return(r=e.call(this)||this).listener=t,r.video=n,r.playbackMonitor=void 0,r.controlsObserver=void 0,r.playbackMonitor=new eS(n,t,{}),r.observeControlsChange(),r}ec()(t,e);var n=t.prototype;return n.configure=function(e){var t=e.srcObj;this.video.srcObject||(this.video.srcObject=t)},n.invoke=function(e){this[e.name].call(this,e.arg)},n.play=function(){this.playbackMonitor.play()},n.pause=function(){this.playbackMonitor.pause()},n.seekTo=function(e){this.playbackMonitor.seekTo(e)},n.endOfStream=function(){this.playbackMonitor.endOfStream()},n.setVolume=function(e){this.video.volume!==e&&(this.video.volume=e)},n.getVolume=function(){return this.video.volume},n.isMuted=function(){return this.video.muted},n.setMuted=function(e){this.video.muted!==e&&(this.video.muted=e)},n.setPlaybackRate=function(e){this.playbackMonitor.setPlaybackRate(e)},n.getPlaybackRate=function(){return this.video.playbackRate},n.getCurrentTime=function(){return this.video.currentTime},n.buffered=function(){return(0,eh.vG)(this.video.buffered,this.video.currentTime,eb.de)},n.bufferDuration=function(){var e=this.buffered(),t=e.start;return e.end-Math.max(t,this.video.currentTime)},n.captureGesture=function(){this.playbackMonitor.play(),this.playbackMonitor.pause()},n.changeSrcObj=function(e){var t=this.video,n=t.playbackRate;t.srcObject=e,t.playbackRate=n},n.delete=function(){var e;this.playbackMonitor.delete(),this.video.srcObject=null,(0,eh.v8)(this.video),null==(e=this.controlsObserver)||e.disconnect()},n.onPlayerConfigurationChanged=function(e){var t;null==(t=this.playbackMonitor)||t.updateConfig({})},n.observeControlsChange=function(){var e=this.listener,t=this.video;try{(this.controlsObserver=new MutationObserver(function(){e.onSinkControlsChanged(t.controls)})).observe(t,{attributeFilter:["controls"]}),e.onSinkControlsChanged(t.controls)}catch(e){}},t}(el),ew=r(998),eC=function(){function e(e,t,n){void 0===n&&(n=new eS(t,e,{})),this.listener=e,this.video=t,this.playbackMonitor=n,this.controlsObserver=void 0,this.mseSink=void 0,this.awaitSink=void 0,this.playerConfig=void 0,this.observeControlsChange(),this.awaitSink=void 0,(0,eh.B1)(t,"error",this.onVideoError.bind(this))}var t=e.prototype;return t.invoke=function(e){var t=this.awaitSink,n=this.mseSink;t&&n?["enqueue","addTrack","setTimestampOffset"].includes(e.name)?this.invokeAsync(e):this.invokeSync(e):t?this.invokeAsync(e):n&&this.invokeSync(e)},t.initSink=function(e,t){var n=this,r=this.awaitSink;if(!this.mseSink&&!r){var i=ew.Z.create(this.onMediaSourceEnded.bind(this),this.onMediaSourceError.bind(this));this.awaitSink=new ey(function(r,o){i.sink.then(function(i){i.setExpectedTracks(e),n.handleCreateSuccess(i),n.onSourceDurationChanged(t),r()}).catch(function(e){n.handleCreateError(e),o()})}),this.changeSrc(URL.createObjectURL(i.ms))}},t.configure=function(e){var t,n=e.expectedTracks,r=e.duration;this.initSink(n,r),this.awaitSink||!0===(null==(t=this.mseSink)?void 0:t.isTrackCompatible(e))||this.queueNewSink(n,r),this.invoke({name:"addTrack",arg:_()({},ek,e)})},t.queueNewSink=function(e,t){var n=this;this.awaitSink=new ey(function(r,i){n.deferUntilIdle().then(function(){var e=ew.Z.create(n.onMediaSourceEnded.bind(n),n.onMediaSourceError.bind(n));return n.changeSrc(URL.createObjectURL(e.ms)),e.sink}).then(function(i){i.setExpectedTracks(e),n.destroyMSESink(),n.handleCreateSuccess(i),n.onSourceDurationChanged(t),n.play(),r()}).catch(function(e){n.handleCreateError(e),i()})})},t.addTrack=function(e){var t=e.trackID,n=e.codec,r=e.group,i=e.isProtected,o=this.mseSink;try{var a=null==o?void 0:o.addTrack(t,n,r,i);a&&this.playbackMonitor.addSourceBuffer(a,n)}catch(e){this.handleCreateError(e)}},t.enqueue=function(e){var t,n=e.trackID,r=e.buffer;null==(t=this.mseSink)||t.append(n,r)},t.endOfStream=function(){var e,t=this;null==(e=this.mseSink)||e.scheduleUpdate().then(function(){return t.playbackMonitor.endOfStream()})},t.setTimestampOffset=function(e){var t,n=e.trackID,r=e.offset;null==(t=this.mseSink)||t.setTimestampOffset(n,r)},t.onSourceDurationChanged=function(e){var t;null==(t=this.mseSink)||t.updateDuration(e,this.video.controls)},t.onPlayerConfigurationChanged=function(e){var t,n;this.playerConfig=e,null==(t=this.mseSink)||t.setSupportsChangeType(e.media.supportsMixedCodec),null==(n=this.playbackMonitor)||n.updateConfig({})},t.play=function(){var e,t=this;null==(e=this.mseSink)||e.scheduleUpdate().then(function(){return t.playbackMonitor.play()})},t.pause=function(){var e,t=this;null==(e=this.mseSink)||e.scheduleUpdate().then(function(){return t.playbackMonitor.pause()})},t.remove=function(e){var t,n=e.start,r=e.end;null==(t=this.mseSink)||t.remove(n,r)},t.seekTo=function(e){var t=this.mseSink,n=this.playbackMonitor,r=this.video,i=(0,eh.vG)(r.buffered,r.currentTime,eb.de),o=i.start,a=i.end;e>=o&&e<a?null==t||t.scheduleUpdate().then(function(){return n.seekTo(e)}):n.seekTo(e)},t.setVolume=function(e){this.video.volume!==e&&(this.video.volume=e)},t.getVolume=function(){return this.video.volume},t.isMuted=function(){return this.video.muted},t.setMuted=function(e){this.video.muted!==e&&(this.video.muted=e)},t.setPlaybackRate=function(e){this.playbackMonitor.setPlaybackRate(e)},t.getPlaybackRate=function(){return this.video.playbackRate},t.getCurrentTime=function(){return this.video.currentTime},t.buffered=function(){return(0,eh.vG)(this.video.buffered,this.video.currentTime,eb.de)},t.getBufferedRanges=function(e){var t,n;return null!=(t=null==(n=this.mseSink)?void 0:n.getBufferedRanges(e))?t:[]},t.bufferDuration=function(){var e=this.buffered(),t=e.start;return e.end-Math.max(t,this.video.currentTime)},t.captureGesture=function(){this.playbackMonitor.play(),this.playbackMonitor.pause()},t.changeSrc=function(e){(0,eh.GX)(this.video,e)},t.changeSrcObj=function(e){},t.delete=function(){var e;this.playbackMonitor.delete(),null==(e=this.controlsObserver)||e.disconnect(),this.destroyMSESink(),(0,eh.v8)(this.video)},t.invokeSync=function(e){this[e.name].call(this,e.arg)},t.invokeAsync=function(e){var t,n=this;null==(t=this.awaitSink)||t.then(function(){return n.invokeSync(e)}).catch(function(){})},t.onMediaSourceEnded=function(){this.video.load(),this.listener.onSinkReset()},t.destroyMSESink=function(){var e=this,t=function(){e.mseSink&&e.mseSink.destroy(),e.awaitSink=void 0,e.mseSink=void 0};this.mseSink?t():this.awaitSink&&this.awaitSink.then(function(){return t()}),this.playbackMonitor&&this.playbackMonitor.clearSourceBuffers()},t.deferUntilIdle=function(){var e=this,t=this.mseSink,n=this.playbackMonitor;return new ey(function(r){t&&!e.video.paused?n.onSinkIdle=function(){n.onSinkIdle=void 0,r()}:r()})},t.handleCreateSuccess=function(e){this.mseSink=e,this.awaitSink=void 0,this.playerConfig&&this.mseSink.setSupportsChangeType(this.playerConfig.media.supportsMixedCodec),this.mseSink.setLiveSeekableRange(0,eb.Sf)},t.handleCreateError=function(e){this.listener.onSinkError({value:N.Pt,code:N.Pt,message:e.toString()})},t.onMediaSourceError=function(e,t,n,r){var i={value:e,code:t,message:n};r?this.listener.onSinkError(i):this.listener.onSinkRecoverableError(i)},t.onVideoError=function(){this.destroyMSESink()},t.observeControlsChange=function(){var e=this,t=this.video;try{(this.controlsObserver=new MutationObserver(function(){e.invoke({name:"onSourceDurationChanged",arg:t.duration})})).observe(t,{attributeFilter:["controls"]})}catch(e){}},t.onSegmentDiscontinuity=function(){},e}(),ek={trackID:0,codec:'codecs="magic"',mode:"mse",isProtected:!1,path:"",group:"",srcObj:null,expectedTracks:1,duration:1/0},eI=n(19087),eP=function(){function e(){this.emitter=void 0,this.emitter=new eI.EventEmitter}var t=e.prototype;return t.on=function(e,t){this.emitter.on(String(e),t)},t.removeListener=function(e,t){this.emitter.removeListener(String(e),t)},t.emit=function(e){for(var t,n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(t=this.emitter).emit.apply(t,[String(e)].concat(r))},t.removeAllListeners=function(){this.emitter.removeAllListeners()},e}(),eA=((eN={}).Pending="pending",eN.Ready="ready",eN.Configuring="configuring",eN.Active="active",eN.Error="error",eN),eM=((eU={}).Heartbeat="heartbeat",eU.Configure="configure",eU.Set_Log_Config="setLogConfig",eU.Debug="debug",eU.Destroy="destroy",eU),eL=((eF={}).State_Changed="stateChanged",eF.Manifest_Load_Analytics="manifestLoadAnalytics",eF.Available_Segments="availableSegments",eF),eD=(0,eE.createLogger)({name:"sw-host-config"});function ex(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return eR(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eR(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function eR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var eO,eN,eU,eF,eB,eV,eG=(0,eE.createLogger)({name:"sw-host"}),eH=function(){return eV},eW=((eB=eW||{})[eB.Pending=0]="Pending",eB[eB.Installing=1]="Installing",eB[eB.Ready=2]="Ready",eB[eB.Error=3]="Error",eB),ej=function(e){var t=function(){return{isMSESupported:(0,O.aP)()}};if((e?e.url||(eD.error("Service worker config must specify a url"),0):(eD.error("Service worker config is required"),0))&&(n=t(),!(!e.forceActivate&&n.isMSESupported))){var n,r,i,o,a,s,u,c,l,f,d,h,p,v,g,m,y,b,E,S,T,w,C,I,A,M,L,D,x,R,N,U,F,B,V=new eP,G=!0,H=eW.Pending,W=[],j=[],z=[],K=eA.Pending,Q=!1,q=(C=k()(P().mark(function t(){var n,r;return P().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,J(eW.Installing),navigator.serviceWorker.addEventListener("message",$),t.prev=3,t.next=6,Y(e.url);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(3),eG.error("[registerAndActivate] Failed to unregister service worker instances: "+t.t0);case 11:return n=void 0!==e.scope?{scope:e.scope}:void 0,t.next=14,navigator.serviceWorker.register(e.url,n);case 14:return(r=t.sent).installing?eG.log("Service worker installing"):r.waiting?eG.log("Service worker installed"):r.active&&eG.log("Service worker active"),t.next=18,Z(r);case 18:J(eW.Ready),t.next=25;break;case 21:t.prev=21,t.t1=t.catch(0),eG.error("Registration failed with "+t.t1),J(eW.Error);case 25:case"end":return t.stop()}},t,null,[[0,21],[3,8]])})),function(){return C.apply(this,arguments)}),Y=(I=k()(P().mark(function e(t){var n;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new RegExp(t),e.next=3,navigator.serviceWorker.getRegistrations().then(function(){var e=k()(P().mark(function e(t){var r,i,o;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:eG.debug("[unregisterOtherWorkerInstances] registrations",t),r=ex(t);case 2:if((i=r()).done){e.next=16;break}if(null===(o=i.value).active||!n.test(o.active.scriptURL)){e.next=14;break}return eG.debug("[unregisterOtherWorkerInstances] unregistering:",o),e.prev=6,e.next=9,o.unregister();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),eG.error("[unregisterOtherWorkerInstances] Failed to unregister service worker: "+e.t0);case 14:e.next=2;break;case 16:case"end":return e.stop()}},e,null,[[6,11]])}));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}},e)})),function(e){return I.apply(this,arguments)}),Z=(A=k()(P().mark(function e(t){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){null!==t.installing||null!==t.waiting?(t.installing||t.waiting).addEventListener("statechange",function(t){var r=t.target;eG.debug("sw registration, statechange",r.state),"activated"===r.state?(eG.log("Service worker activated"),e()):"redundant"===r.state&&n()}):e()}));case 1:case"end":return e.stop()}},e)})),function(e){return A.apply(this,arguments)}),J=function(e){if(eG.log("[changeHostState] host state changed from "+H+" to "+e),(H=e)===eW.Ready){var t=W.slice();W=[];for(var n,r=ex(t);!(n=r()).done;)(0,n.value)();var i=j.slice();j=[];for(var o,a=ex(i);!(o=a()).done;)ee(o.value)}else if(H===eW.Error){var s=z.slice();z=[];for(var u,c=ex(s);!(u=c()).done;)(0,u.value)()}},X=function(e){H===eW.Error?e():z.push(e)},$=function(e){var t=e.data;switch(t.type){case eL.State_Changed:var n=t.state;K===eA.Configuring&&(Q=!1),n===eA.Ready&&K!==eA.Pending&&eG.warn("[handleMessage] worker was restarted by the browser"),K=n;break;case eL.Manifest_Load_Analytics:eG.debug("Manifest_Load_Analytics",t)}V.emit(t.type,t)},ee=(M=k()(P().mark(function e(t){var n;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return eG.log("[sendMessage] sending message: ",t),e.abrupt("return",null==(n=navigator.serviceWorker.controller)?void 0:n.postMessage(t));case 2:case"end":return e.stop()}},e)})),function(e){return M.apply(this,arguments)}),et=(L=k()(P().mark(function e(t){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(K!==eA.Pending){e.next=4;break}return eG.log("[sendMessageWhenReady] worker is not ready, queueing message",t),j.push(t),e.abrupt("return");case 4:ee(t);case 5:case"end":return e.stop()}},e)})),function(e){return L.apply(this,arguments)}),en=function(){B&&clearTimeout(B),B=setTimeout(function(){er()},1e4)},er=function(){G&&K!==eA.Pending&&(ee({type:eM.Heartbeat}),en())},ei=function(e,t){var n=function(r){r.type===eL.State_Changed&&r.state===e&&(V.removeListener(eL.State_Changed,n),t(r))};V.on(eL.State_Changed,n)},eo=(D=k()(P().mark(function e(){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(H!==eW.Ready){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise(function(e,t){var n;n=function(){eG.log("[ensureHostReady] host state changed to ready"),e()},H===eW.Ready?n():W.push(n),X(function(){eG.log("[ensureHostReady] host state changed to error"),t()})}));case 3:case"end":return e.stop()}},e)})),function(){return D.apply(this,arguments)}),ea=(x=k()(P().mark(function e(){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(K===eA.Pending){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",new Promise(function(e,t){ei(eA.Ready,function(t){eG.log("[ensureWorkerReady] worker state changed to ready",t),e()})}));case 3:case"end":return e.stop()}},e)})),function(){return x.apply(this,arguments)}),es=(R=k()(P().mark(function e(){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,eo();case 2:return e.next=4,ea();case 4:case"end":return e.stop()}},e)})),function(){return R.apply(this,arguments)}),eu=(N=k()(P().mark(function e(t){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return Q=!0,F=ec(null!=t?t:{}),e.next=4,es();case 4:ee({type:eM.Configure,config:F});case 5:case"end":return e.stop()}},e)})),function(e){return N.apply(this,arguments)}),ec=function(e){return _()({},F,e)},el=(U=k()(P().mark(function e(){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Q||K!==eA.Active){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,es();case 4:return e.abrupt("return",new Promise(function(e,t){ei(eA.Active,function(t){eG.log("[ensureConfigured] worker state changed to active",t),e()})}));case 5:case"end":return e.stop()}},e)})),function(){return U.apply(this,arguments)});return w=t().isMSESupported?{cacheMultivariant:!1,transformTargetDuration:!1,lowLatencyMode:{enabled:!1,useLocalSegment:!1,convertPrefetchSegment:!1,preloadPrefetchSegments:!1},driftDetection:{enabled:!1,maxPlaylistPosition:0,triggerDetectionThreshold:0,minDurationBetweenCorrections:0},debug:{addMultivariantDelay:void 0,addFirstVariantDelay:void 0}}:{cacheMultivariant:!0,transformTargetDuration:!1,lowLatencyMode:{enabled:!0,useLocalSegment:!0,convertPrefetchSegment:!0,preloadPrefetchSegments:!1},driftDetection:{enabled:!0,maxPlaylistPosition:3,triggerDetectionThreshold:10,minDurationBetweenCorrections:60},debug:{addMultivariantDelay:void 0,addFirstVariantDelay:void 0}},F={cacheMultivariant:null!=(r=e.cacheMultivariant)?r:w.cacheMultivariant,transformTargetDuration:null!=(i=e.transformTargetDuration)?i:w.transformTargetDuration,lowLatencyMode:{enabled:null!=(o=null==(a=e.lowLatencyMode)?void 0:a.enabled)?o:w.lowLatencyMode.enabled,useLocalSegment:null!=(s=null==(u=e.lowLatencyMode)?void 0:u.useLocalSegment)?s:w.lowLatencyMode.useLocalSegment,convertPrefetchSegment:null!=(c=null==(l=e.lowLatencyMode)?void 0:l.convertPrefetchSegment)?c:w.lowLatencyMode.convertPrefetchSegment,preloadPrefetchSegments:null!=(f=null==(d=e.lowLatencyMode)?void 0:d.preloadPrefetchSegments)?f:w.lowLatencyMode.preloadPrefetchSegments},driftDetection:{enabled:null!=(h=null==(p=e.driftDetection)?void 0:p.enabled)?h:w.driftDetection.enabled,maxPlaylistPosition:null!=(v=null==(g=e.driftDetection)?void 0:g.maxPlaylistPosition)?v:w.driftDetection.maxPlaylistPosition,triggerDetectionThreshold:null!=(m=null==(y=e.driftDetection)?void 0:y.triggerDetectionThreshold)?m:w.driftDetection.triggerDetectionThreshold,minDurationBetweenCorrections:null!=(b=null==(E=e.driftDetection)?void 0:E.minDurationBetweenCorrections)?b:w.driftDetection.minDurationBetweenCorrections},debug:{addMultivariantDelay:null==(S=e.debug)?void 0:S.addMultivariantDelay,addFirstVariantDelay:null==(T=e.debug)?void 0:T.addFirstVariantDelay}},eG.info("[init] instantiating with config",F),void 0!==e.debug&&(e.debug.api={delayNextMediaManifest:function(e){var t={api:"delayNextMediaManifest",delayInMs:e};if("delayNextMediaManifest"===t.api){var n=t.delayInMs;eG.log("[handleDebugApiMessage] delaying next manifest by "+n+"ms")}ee(_()({type:eM.Debug},t))}}),en(),{registerAndActivate:q,addListener:function(e,t){V.on(e,t)},removeListener:function(e,t){V.removeListener(e,t)},sendMessage:ee,ensureReady:es,configure:eu,ensureConfigured:el,getConfig:function(){return F},getDriftDetectionConfig:function(){var e;return null==(e=F)?void 0:e.driftDetection},setLogConfig:function(e){et({type:eM.Set_Log_Config,config:e})},destroy:function(){eG.log("[destroy] destroying"),G=!1,B&&clearTimeout(B),V.removeAllListeners(),navigator.serviceWorker.removeEventListener("message",$),ee({type:eM.Destroy})},debugPassthroughAnalytics:function(t){var n;null==(n=e.debug)||null==n.onPassthroughAnalytics||n.onPassthroughAnalytics(t)}}}},ez=r(796),eK=r(898),eQ=r.n(eK),eq=function(){function e(){this.serverOffsetVal=e.SERVER_OFFSET_DEFAULT,this.liveLatencyVal=0,this.lastTranscodeReceive=-1}var t=e.prototype;return t.tryGenerateServerOffset=function(t){var n;return this.serverOffsetVal!==e.SERVER_OFFSET_DEFAULT?(console.warn("[generateServerOffset] the server offset has already been generated, skipping"),!1):(this.serverOffsetVal=(n=Date.now(),new Date(1e3*t).getTime()-n),!0)},t.tryUpdateLatency=function(t){var n;return this.serverOffsetVal!==e.SERVER_OFFSET_DEFAULT&&(t<this.lastTranscodeReceive?(console.warn("[updateLatency] received latency values too old, ignoring. previous: "+this.lastTranscodeReceive+" current: "+t),!1):(this.liveLatencyVal=(n=Date.now(),(n+this.serverOffsetVal-t)/1e3),this.lastTranscodeReceive=t,!0))},eQ()(e,[{key:"serverOffset",get:function(){return this.serverOffsetVal}},{key:"liveLatency",get:function(){return this.liveLatencyVal}}])}();eq.SERVER_OFFSET_DEFAULT=-1;var eY=function(e){var t=parseFloat(e);if(!isNaN(t))return t},eZ=((i={}).Live_Latency_Load="liveLatencyLoad",i.Live_Latency_Stats="liveLatencyStats",i),eJ=((o={}).Trigger_Drift_Correction="triggerDriftCorrection",o),eX=((a=eX||{}).ID3="org.id3",a.APPLE_HLS="com.apple.quicktime.HLS",a),e$=((s=e$||{}).PRIV="PRIV",s.TXXX="TXXX",s.TDEN="TDEN",s.STREAM_LEVEL_SERVER_TIME="X-SERVER-TIME",s),e0=(0,eE.createLogger)({name:"sink"}),e1=function(e){function t(t,n){(r=e.call(this,n,t)||this).intervalId=void 0,r.bufferingTimeoutId=void 0,r.attemptingToPlay=void 0,r.hasPlayedSrc=void 0,r.hasReloadedOnDecodeError=void 0,r.unsubscribersForTrackEvents=void 0,r.latencyStatistics=void 0,r.processedInitialCues=void 0,r.serviceWorker=void 0,r.serviceWorkerHandler=void 0,r.positionTracker=void 0,r.driftDetector=void 0,r.driftDetectorHandler=void 0,r.analytics=void 0,r.analyticsHandler=void 0,r.intervalId=-1,r.bufferingTimeoutId=-1,r.attemptingToPlay=!1,r.hasPlayedSrc=!1,r.hasReloadedOnDecodeError=!1,r.unsubscribersForTrackEvents=[],r.latencyStatistics=new eq,r.processedInitialCues=!1,r.addListener("waiting",function(){return r.onVideoWaiting()},r.video),r.addListener("timeupdate",function(){return r.onVideoTimeUpdate()},r.video),r.addListener("durationchange",function(){return r.onVideoDurationChange()},r.video),r.addListener("error",function(){return r.onVideoError()},r.video),r.addListener("play",function(){return r.onVideoPlay()},r.video),r.addListener("pause",function(){return r.onVideoPause()},r.video),r.addListener("ended",function(){return r.onVideoEnded()},r.video),r.addListener("playing",function(){return r.onVideoPlaying()},r.video);var r,i,o,a,s,u,c,l,f,d,h,p,v,g,m,y=(0,ez.sQ)(document).visibilityChange;if(r.addListener(y,function(){return r.onVisibilityChange()},document),r.serviceWorker=eH(),r.serviceWorkerHandler=function(e){return r.onServiceWorkerMessage(e)},r.addServiceWorkerListeners(),void 0!==r.serviceWorker){p=[],v=-1,g=function(){return 0===p.length||void 0===h?(v=-1,!1):-1!==(v=m(h))},m=function(e){var t=RegExp("^"+e);if(p){var n=p.findIndex(function(e){return t.test(e.pdt)});if(-1===n)for(var r=new Date(e+"Z"),i=0;i<p.length;i++){var o=p[i],a=new Date(o.pdt);if(a.getTime()<=r.getTime()&&a.getTime()+1e3*o.duration>r.getTime()){n=i;break}}if(-1!==n)return n}return console.warn("Couldn't find segment for PDT "+e),-1},r.positionTracker={processAvailableSegments:function(e){return p=e,g()},processTDEN:function(e){return h=e,g()},getCurrentPosition:function(){return v}};var b,E,S,T,w,C,k,I,P,A,M,L,D,x=null==(D=r.serviceWorker)?void 0:D.getDriftDetectionConfig();void 0!==x&&x.enabled&&(i={maxPlaylistPosition:x.maxPlaylistPosition,triggerDetectionThreshold:x.triggerDetectionThreshold,minDurationBetweenCorrections:x.minDurationBetweenCorrections},u=new eP,c=0,l=0,f=function(){if(void 0!==o&&void 0!==a){if(o<=i.maxPlaylistPosition)l=0;else if((l+=1)>i.triggerDetectionThreshold){console.debug("[handleDriftDetection] above detection threshold");var e=Date.now();(void 0===s||e-s>i.minDurationBetweenCorrections)&&(console.debug("[handleDriftDetection] within min duration, triggering rebuffer-to-live"),d(e,o,a))}}},d=function(e,t,n){c+=1,s=e,l=0;var r={type:eJ.Trigger_Drift_Correction,playlistPosition:t,playhead:n,rebufferCount:c};u.emit(eJ.Trigger_Drift_Correction,r)},r.driftDetector={addListener:function(e,t){u.on(e,t)},removeListener:function(e,t){u.removeListener(e,t)},processPlaylistPosition:function(e){o=e},processTimeUpdate:function(e){var t=Math.floor(e);void 0!==a&&t===a||(a=t,f())}},r.driftDetectorHandler=function(e){return r.onDriftDetectorEvent(e)},r.addDriftDetectorListeners()),w=new eP,C={},k={duration:0},I={min:0,avg:0,max:0,last:0},P={first:void 0,last:void 0},A={count:0},M=function(){if((e=eZ.Live_Latency_Load)===eZ.Live_Latency_Load&&void 0===C[e]&&void 0!==b&&void 0!==E){var e,t=C[eZ.Live_Latency_Load]||0;C[eZ.Live_Latency_Load]=t+1,w.emit(eZ.Live_Latency_Load,{type:eZ.Live_Latency_Load,serverOffset:b,manifestLoadAnalytics:E})}},L=function(){var e=C[eZ.Live_Latency_Stats]||0;C[eZ.Live_Latency_Stats]=e+1,w.emit(eZ.Live_Latency_Stats,{type:eZ.Live_Latency_Stats,playlistPosition:_()({},I),liveLatencyTiming:_()({},P),driftCorrection:_()({},A)})},r.analytics={addListener:function(e,t){w.on(e,t)},removeListener:function(e,t){w.removeListener(e,t)},processServerOffset:function(e){b={serverTime:1e3*e.serverTime,clientTime:e.clientTime,serverOffset:e.serverOffset},M()},processManifestLoadAnalytics:function(e){E=e,M()},processSinkState:function(e){"playing"===S&&"pause"===e&&L(),S=e},processTimeUpdate:function(e){var t=Math.floor(e);void 0!==T&&t===T||(k.duration+=1,T=t,k.duration%10==0&&L())},processPlaylistPosition:function(e){e<I.min&&(I.min=e),e>I.max&&(I.max=e),0===I.avg?I.avg=e:I.avg=(I.avg*k.duration+e)/(k.duration+1),I.last=e},processLiveLatencyUpdate:function(e){void 0===P.first&&(P.first=_()({},e)),P.last=_()({},e)},processDriftCorrectionStart:function(){A.count+=1}},r.analyticsHandler=function(e){return r.onAnalyticsEvent(e)},r.addAnalyticsListeners()}return r}ec()(t,e);var n=t.prototype;return n.invoke=function(e){this[e.name].call(this,e.arg)},n.configure=function(e){var t=e.path;this.handleTrackEvents(),this.hasReloadedOnDecodeError=!1,this.hasPlayedSrc=!1,this.video.src=t},n.play=function(){var e=this,t=this.video.buffered;if(t.length>0){var n=t.start(t.length-1),r=t.end(t.length-1);this.video.duration===1/0&&(r<this.video.currentTime||this.video.currentTime<n)&&(this.listener.onSinkGapJump(n-this.video.currentTime),console.warn("Moving to buffered region"),this.video.currentTime=n)}this.paused=!1,this.attemptingToPlay=!0,(void 0===e.serviceWorker||e.hasPlayedSrc?Promise.resolve(e.video.play()):e.serviceWorker.ensureConfigured().catch(function(e){e0.warn("sw, ensureConfigured failed",e)}).then(function(){return Promise.resolve(e.video.play())})).then(function(){e.attemptingToPlay=!1,e.hasPlayedSrc=!0}).catch(function(){e.attemptingToPlay=!1,e.checkStopped(!0)})},n.pause=function(){e.prototype.pause.call(this),clearTimeout(this.intervalId)},n.seekTo=function(e){this.video.currentTime=e},n.setVolume=function(e){this.video.volume=e},n.getVolume=function(){return this.video.volume},n.buffered=function(){return(0,eh.vG)(this.video.buffered,this.video.currentTime,eb.de)},n.decodedFrames=function(){return(0,eh.xB)(this.video)},n.droppedFrames=function(){return(0,eh.ld)(this.video)},n.delete=function(){e.prototype.delete.call(this),this.removeTrackListeners(),this.removeServiceWorkerListeners(),this.removeDriftDetectorListeners(),this.removeAnalyticsListeners(),(0,eh.v8)(this.video)},n.isMuted=function(){return this.video.muted},n.setMuted=function(e){this.video.muted=e},n.getPlaybackRate=function(){return this.video.playbackRate},n.getCurrentTime=function(){return this.video.currentTime},n.bufferDuration=function(){var e=this.buffered(),t=e.start;return e.end-Math.max(t,this.video.currentTime)},n.captureGesture=function(){Promise.resolve(this.video.play()).catch(function(){}),this.video.pause()},n.addServiceWorkerListeners=function(){void 0!==this.serviceWorker&&(this.serviceWorker.addListener(eL.Manifest_Load_Analytics,this.serviceWorkerHandler),this.serviceWorker.addListener(eL.Available_Segments,this.serviceWorkerHandler))},n.onServiceWorkerMessage=function(e){var t,n;switch(e.type){case eL.Manifest_Load_Analytics:null==(t=this.analytics)||t.processManifestLoadAnalytics(e.data);break;case eL.Available_Segments:null==(n=this.positionTracker)||n.processAvailableSegments(e.segments)}},n.removeServiceWorkerListeners=function(){void 0!==this.serviceWorker&&(this.serviceWorker.removeListener(eL.Manifest_Load_Analytics,this.serviceWorkerHandler),this.serviceWorker.removeListener(eL.Available_Segments,this.serviceWorkerHandler))},n.addDriftDetectorListeners=function(){var e;null==(e=this.driftDetector)||e.addListener(eJ.Trigger_Drift_Correction,this.driftDetectorHandler)},n.onDriftDetectorEvent=function(e){var t;e.type===eJ.Trigger_Drift_Correction&&(e0.debug("triggering drift correction",e),null==(t=this.analytics)||t.processDriftCorrectionStart(),this.resumeAtLive())},n.resumeAtLive=function(){this.pause(),this.configure({path:this.video.src}),this.play()},n.removeDriftDetectorListeners=function(){var e;null==(e=this.driftDetector)||e.removeListener(eJ.Trigger_Drift_Correction,this.driftDetectorHandler)},n.addAnalyticsListeners=function(){var e,t;null==(e=this.analytics)||e.addListener(eZ.Live_Latency_Load,this.analyticsHandler),null==(t=this.analytics)||t.addListener(eZ.Live_Latency_Stats,this.analyticsHandler)},n.onAnalyticsEvent=function(e){var t;switch(null==(t=this.serviceWorker)||t.debugPassthroughAnalytics(e),e.type){case eZ.Live_Latency_Load:e0.debug("analytics event, Live Latency Load",e.serverOffset,e.manifestLoadAnalytics);break;case eZ.Live_Latency_Stats:e0.debug("analytics event, Live Latency Stats",e.playlistPosition,e.liveLatencyTiming,e.driftCorrection)}},n.removeAnalyticsListeners=function(){var e,t;null==(e=this.analytics)||e.removeListener(eZ.Live_Latency_Load,this.analyticsHandler),null==(t=this.analytics)||t.removeListener(eZ.Live_Latency_Stats,this.analyticsHandler)},n.addTrackListener=function(e,t,n){this.unsubscribersForTrackEvents.push((0,eh.B1)(n,e,t))},n.removeTrackListeners=function(){this.unsubscribersForTrackEvents.forEach(function(e){return e()})},n.checkTracksStatus=function(){for(var e=this.video.textTracks,t=0;t<e.length;t++){var n=e[t];"metadata"===n.kind&&"disabled"===n.mode&&(n.mode="hidden")}},n.handleTDENDataReceived=function(e){if(void 0!==this.positionTracker&&this.positionTracker.processTDEN(e)){var t,n,r=this.positionTracker.getCurrentPosition();null==(t=this.analytics)||t.processPlaylistPosition(r),null==(n=this.driftDetector)||n.processPlaylistPosition(r)}},n.handleTXXXSegmentDataReceived=function(e){var t,n=function(e){var t=(0,ez.N8)(e);if("transc_r"in t)return{transc_r:parseInt(t.transc_r)}}(e);void 0!==n&&(n.transc_r>0&&this.listener.onPassthroughSinkPropertyChanged("transcodeReceiveInSecs",n.transc_r/1e3),this.latencyStatistics.tryUpdateLatency(n.transc_r)&&(this.listener.onPassthroughSinkPropertyChanged("liveLatency",this.latencyStatistics.liveLatency),null==(t=this.analytics)||t.processLiveLatencyUpdate({transc_r:n.transc_r,latency:this.latencyStatistics.liveLatency})))},n.handleInitialCues=function(e){for(var t,n,r=0;r<e.length;++r){var i=e[r];i.type===eX.APPLE_HLS&&i.value.key===e$.STREAM_LEVEL_SERVER_TIME&&(t=eY(i.value.data))}this.processedInitialCues=!0,void 0!==t&&this.latencyStatistics.tryGenerateServerOffset(t)&&(null==(n=this.analytics)||n.processServerOffset({serverTime:t,clientTime:Date.now(),serverOffset:this.latencyStatistics.serverOffset}))},n.shouldPropagateCue=function(e){var t=e.type,n=e.value;return!(t!==eX.ID3||!n||(n.key!==e$.TXXX||"segmentmetadata"===n.info)&&(n.key!==e$.PRIV||n.info!==en._.METADATA_ID)&&(n.key!==e$.PRIV||n.info!==en._.INBAND_METADATA_ID))},n.handleCueChange=function(e){var t=this,n=new Set;this.addTrackListener("cuechange",function(){!t.processedInitialCues&&e.cues&&t.handleInitialCues(e.cues);var r,i=null!=(r=e.activeCues)?r:[];if(i.length>0){for(var o=new Set,a=0;a<i.length;++a){var s=i[a];if(!n.has(s)){var u=s.value;if(t.listener.onPassthroughSinkDataCue(s),u.key===e$.TXXX&&"segmentmetadata"===u.info&&t.handleTXXXSegmentDataReceived(u.data),u.key===e$.TDEN&&t.handleTDENDataReceived(u.data),t.shouldPropagateCue(s)){var c=u.key===e$.PRIV?new TextDecoder("utf-8").decode(u.data):u.data||"",l=u.info||"";t.listener.onPassthroughSinkMetadata(s.startTime,s.endTime,c,l,l)}}o.add(s)}n=o}},e)},n.handleTrackEvents=function(){var e=this;this.removeTrackListeners(),void 0===window.DataCue&&void 0===window.WebKitDataCue||(this.addTrackListener("change",function(){e.checkTracksStatus()},this.video.textTracks),this.addTrackListener("addtrack",function(t){var n=t.track;"metadata"===n.kind&&"disabled"===n.mode&&(n.mode="hidden",e.handleCueChange(n))},this.video.textTracks))},n.onVideoWaiting=function(){var e=this;if((0,eh.vG)(this.video.buffered,this.video.currentTime,eb.de).end-this.video.currentTime<eb.de){this.listener.onSinkBuffering(),clearTimeout(this.bufferingTimeoutId),this.bufferingTimeoutId=self.setTimeout(function(){e.listener.onSinkError({value:N.yY,code:N.yY,message:"Buffering timeout"})},eb.Pp);var t=(0,eh.B1)(this.video,"timeupdate",function(){t(),clearTimeout(e.bufferingTimeoutId)})}var n=(0,eh.B1)(this.video,"timeupdate",function(){4===e.video.readyState&&(n(),e.onVideoPlaying())})},n.onVideoTimeUpdate=function(){var e,t;this.listener.onSinkTimeUpdate(),null==(e=this.analytics)||e.processTimeUpdate(this.getCurrentTime()),null==(t=this.driftDetector)||t.processTimeUpdate(this.getCurrentTime())},n.onVideoDurationChange=function(){this.listener.onSinkDurationChanged(this.video.duration)},n.onVideoError=function(){var e=this.video.error,t=e.code,n=e.message,r=void 0===n?"":n,i=-1!==this.video.src.indexOf(".m3u8");if(t===N.Pt&&!this.hasPlayedSrc&&i)return clearTimeout(this.bufferingTimeoutId),void this.listener.onSinkError({value:N.$_,code:N.$_,message:r});t!==N.ok||this.hasReloadedOnDecodeError?this.listener.onSinkError({value:t,code:t,message:r}):this.hasReloadedOnDecodeError||(this.hasReloadedOnDecodeError=!0,console.warn("Reload video element on MEDIA_ERR_DECODE 3"),this.video.load())},n.onVideoPlay=function(){var e=this,t=this.video.currentTime;clearTimeout(this.intervalId),this.intervalId=self.setTimeout(function(){return e.heartbeat(t)},eb.HJ)},n.onVideoPause=function(){var e;clearTimeout(this.intervalId),this.attemptingToPlay||(null==(e=this.analytics)||e.processSinkState("pause"),this.checkStopped(!1))},n.onVideoEnded=function(){this.listener.onSinkEnded()},n.onVideoPlaying=function(){var e;null==(e=this.analytics)||e.processSinkState("playing"),this.listener.onSinkPlaying(this.paused),this.trackBufferUpdate((0,eh.vG)(this.video.buffered,this.video.currentTime,eb.de).end)},n.onVisibilityChange=function(){var e=(0,ez.sQ)(document).hidden;document[e]&&(this.hasReloadedOnDecodeError=!1)},n.heartbeat=function(e){var t=this,n=this.video.currentTime;if(n===e){if((0,eh.V3)(this.video,eb.de))return void this.listener.onSinkBuffering();var r=(0,eh.tX)(this.video.buffered,n,eb.de);r!==n&&(console.warn("jumping "+(r-n)+"s gap"),this.listener.onSinkGapJump(r-this.video.currentTime),this.video.currentTime=r,n=this.video.currentTime)}this.intervalId=self.setTimeout(function(){return t.heartbeat(n)},eb.HJ)},n.trackBufferUpdate=function(e){var t=this,n=this.buffered().end;n!==e&&this.listener.onSinkBufferUpdate();var r=(0,eh.B1)(this.video,"timeupdate",function(){r(),t.trackBufferUpdate(n)})},t}(e_),e2=function(e){function t(){return e.apply(this,arguments)||this}return ec()(t,e),t.prototype.onIdle=function(){this.onSinkIdle?this.onSinkIdle():this.listener.onSinkIdle()},t}(eS),e3=function(e){function t(t,n,r){var i;return(i=e.call(this,t,n,new e2(n,t))||this).listener=t,i.video=n,i.adjustments=r,i}ec()(t,e);var n=t.prototype;return n.isChangingContentProtection=function(e){var t,n;return(null!=(t=null==(n=this.mseSink)?void 0:n.isDrmProtected())&&t)!==e.isProtected},n.configure=function(e){var t=e.expectedTracks,n=e.duration;if(this.initSink(t,n),this.isChangingContentProtection(e)&&this.queueNewSink(t,n),this.isNewSinkNeeded(e)){this.queueNewSink(t,n);var r=this.getTrack(eb.kD.audio);r&&this.invoke({name:"addTrack",arg:r})}this.invoke({name:"addTrack",arg:_()({},e4,e)})},n.queueNewSink=function(e,t){var n=this;this.awaitSink=new Promise(function(r,i){n.deferUntilIdle().then(function(){var e=ew.Z.create(n.onMediaSourceEnded.bind(n),n.onMediaSourceError.bind(n));return n.changeSrc(URL.createObjectURL(e.ms)),e.sink}).then(function(i){i.setExpectedTracks(e),n.invokeAsync({name:"play",arg:void 0}),n.destroyMSESink(),n.handleCreateSuccess(i),n.onSourceDurationChanged(t),r()}).catch(function(e){n.handleCreateError(e),i()})})},n.deferUntilIdle=function(){var e=this,t=this.mseSink,n=this.playbackMonitor;return new Promise(function(r){t&&!e.video.paused?(n.onSinkIdle=function(){},e.video.addEventListener("waiting",function(){n.onSinkIdle=void 0,r()},{once:!0})):r()})},n.onSegmentDiscontinuity=function(){var e=this.adjustments,t=this.awaitSink,n=this.mseSink;e.rebuildMediaSinkOnDiscontinuity&&n&&!t&&this.queueNewSink(n.getExpectedTracks(),n.duration)},n.isSinkVideoSourceQualityChangeRequired=function(e,t){return!!this.adjustments.rebuildMediaSinkOnSourceQualityChange&&"chunked"===e!=("chunked"===t)},n.isNewSinkNeeded=function(e){var t=this.adjustments,n=this.mseSink,r=this.awaitSink;if(e.trackID!==eb.kD.video||!t.rebuildMediaSinkOnSourceQualityChange||!n||r)return!1;var i=this.getTrack(eb.kD.video),o=this.getTrack(eb.kD.audio);return!(!i||!o)&&this.isSinkVideoSourceQualityChangeRequired(i.group,e.group)},n.getTrack=function(e){var t,n=this.mseSink;return null!=(t=null==n?void 0:n.bufferProperties.find(function(t){return t.trackID===e}))?t:null},t}(eC),e4={trackID:0,codec:'codecs="magic"',mode:"mse",isProtected:!1,path:"",group:"",srcObj:null,expectedTracks:1,duration:1/0},e8=function(){function e(e,t,n,r){this.listener=e,this.adjustments=n,this.video=void 0,this.drmManager=void 0,this.codecs=void 0,this.sink=void 0,this.observer=void 0,this.playerConfig=void 0,this.remoteDevicesListener=void 0,this.video=r,this.listener=e,this.drmManager=new es({video:this.video,listener:e}),this.codecs=Object.create(null),this.sink=new ep(this.listener,this.video),t&&(this.remoteDevicesListener=ed.lookForRemotePlaybackDevices(this.listener)),this.observer=new ev(this.video,e)}var t=e.prototype;return t.videoElement=function(){return this.video},t.delete=function(){var e;this.reset(),null==(e=this.remoteDevicesListener)||e.then(function(e){e&&ed.stopLookingForRemotePlaybackDevices(e)})},t.configure=function(e){var t=e.mode,n=e.codec,r=e.trackID;this.sink instanceof ep&&this.updateSinkByMode(t),n?this.codecs[r]=n:e.codec=this.codecs[r],this.sink.configure(e);var i=e.path,o=e.isProtected;i&&o&&this.drmManager.configure(i),this.observer.onConfigure()},t.applyRPC=function(e){this.observer.trackRPC(e),this.sink.invoke(e)},t.getCurrentSink=function(){return this.sink},t.reset=function(){this.sink.delete(),this.drmManager.reset(),this.sink=new ep(this.listener,this.video),this.listener.onSinkTimeUpdate(),this.listener.onSinkBufferUpdate()},t.isProtected=function(){return this.drmManager.isProtected()},t.captureGesture=function(){this.video.played.length||this.sink.captureGesture()},t.destroy=function(){this.observer.unsubscribe(),this.delete()},t.isLowLatencyCapable=function(){return this.sink instanceof eC},t.onSegmentDiscontinuity=function(){this.sink.onSegmentDiscontinuity()},t.onPlayerConfigurationChanged=function(e){this.playerConfig=e,this.sink.onPlayerConfigurationChanged(e)},t.updateSinkByMode=function(e){switch(this.sink.delete(),e){case"chromecast":this.sink=new ed(this.listener);break;case"mse-worker":this.sink=new eT(this.listener,this.video);break;case"passthrough":this.sink=new e1(this.listener,this.video);break;case"webview":this.sink=new e3(this.listener,this.video,this.adjustments);break;default:this.sink=new eC(this.listener,this.video)}this.playerConfig&&this.sink.onPlayerConfigurationChanged(this.playerConfig)},e}(),e6=1111,e5=[{CLASS:"timestamp",attributes:new Set(["X-SERVER-TIME"])},{CLASS:"twitch-session",attributes:new Set(["X-TV-TWITCH-SESSIONID"])},{CLASS:"twitch-stitched-ad",attributes:new Set(["X-TV-TWITCH-AD-URL","X-TV-TWITCH-AD-LINE-ITEM-ID","X-TV-TWITCH-AD-AD-FORMAT","X-TV-TWITCH-AD-DSA-VERSION","X-TV-TWITCH-AD-CLICK-BEACON-ID","X-TV-TWITCH-AD-POD-LENGTH","X-TV-TWITCH-AD-POD-POSITION","X-TV-TWITCH-AD-ROLL-TYPE","X-TV-TWITCH-AD-RADS-TOKEN","X-TV-TWITCH-AD-AD-SESSION-ID","X-TV-TWITCH-AD-ADVERTISER-ID","X-TV-TWITCH-AD-CREATIVE-ID","X-TV-TWITCH-AD-ORDER-ID","X-TV-TWITCH-AD-CLICK-TRACKING-URL","X-TV-TWITCH-AD-DSA-SS-CONTEXT","X-TV-TWITCH-AD-DSA-SS-LOCATION","X-TV-TWITCH-AD-POD-FILLED-DURATION","X-TV-TWITCH-AD-AF-ICR-AD-ID","X-TV-TWITCH-AD-AF-ICR-CREATIVE-ID","X-TV-TWITCH-AD-AF-ICR-MEDIA-DURATION","X-TV-TWITCH-AD-LOUDNESS"])},{CLASS:"twitch-stream-source",attributes:new Set(["X-TV-TWITCH-STREAM-SOURCE"])},{CLASS:"twitch-trigger",attributes:new Set(["X-TV-TWITCH-TRIGGER-URL"])},{CLASS:"twitch-ad-quartile",attributes:new Set(["X-TV-TWITCH-AD-QUARTILE"])}],e7=function(){return{autoQualityMode:!0,averageBitrate:0,bandwidthEstimate:0,bufferedPosition:0,catchUpMode:"",channelMetadata:[],duration:0,initialBufferDuration:0,liveLatency:0,liveLowLatency:!1,liveLowLatencyEnabled:!0,looping:!1,path:"",position:0,protocol:"",qualities:[],quality:{name:"",group:"",codecs:"",bitrate:0,width:0,height:0,framerate:0,isDefault:!1},sessionData:{},sessionId:void 0,sourceGroup:void 0,sourceGroups:[],startOffset:0,state:ei.p.IDLE,statistics:{bitrate:0,framerate:0,droppedFrames:0,decodedFrames:0,renderedFrames:0},syncTime:0,trackBufferedRanges:{audio:[],video:[]},unavailableQualities:[],volume:1}},e9=((u={})[u.STATE_CHANGED=0]="STATE_CHANGED",u[u.CONFIGURE=1]="CONFIGURE",u[u.RESET=2]="RESET",u[u.ADD_CUE=3]="ADD_CUE",u[u.GET_DECODE_INFO=4]="GET_DECODE_INFO",u[u.MEDIA_SINK_RPC=5]="MEDIA_SINK_RPC",u[u.GET_EXPERIMENTS=6]="GET_EXPERIMENTS",u[u.LOG_MESSAGE=7]="LOG_MESSAGE",u[u.DATA_CHANNEL_CREATE=8]="DATA_CHANNEL_CREATE",u[u.DATA_CHANNEL_CLOSE=9]="DATA_CHANNEL_CLOSE",u[u.DATA_CHANNEL_SEND=10]="DATA_CHANNEL_SEND",u[u.RTC_SET_REMOTE_DESCRIPTION=11]="RTC_SET_REMOTE_DESCRIPTION",u[u.PROPERTY_CHANGED=12]="PROPERTY_CHANGED",u[u.SYNC_TIME_CHANGED=13]="SYNC_TIME_CHANGED",u[u.BUFFERED_RANGES=14]="BUFFERED_RANGES",u[u.DESTROY=15]="DESTROY",u),te={rebuildMediaSinkOnSourceQualityChange:!1,rebuildMediaSinkOnDiscontinuity:!1,abrTranscodesOnly:!1},tt=n(42773),tn=r.n(tt),tr=((c={}).AVC="avc1",c.HEVC="hev1",c.AV1="av01",c),ti=function(){function e(e){this.emitAnalytics=void 0,this.emitAnalytics=e}var t=e.prototype;return t.onValue=function(e){this.emit("ivs_devconf_value",e)},t.onError=function(e){this.emit("ivs_devconf_error",e)},t.onTrace=function(e){this.emit("ivs_devconf_trace",e)},t.emit=function(e,t){this.emitAnalytics(e,t)},e}(),to=((l={}).GPU="8b0cb43a-720b-4775-9f98-21da360d60b1",l.GPUStaff="59d57100-3c9c-4f13-aeff-9b1c1b6b4c66",l.DeviceConfigTest="a5c3a8f0-d293-4597-af87-f0352c58d1b3",l.SafariMSEInWorkers="4f4511c5-588d-4a39-8ca1-4b95149a00d2",l.EdgeMSEInWorkers="2caeb3ea-ae9e-4a3c-b675-de3eb85c6ddb",l.OperaMSEInWorkers="c704aec0-73be-4ce5-9872-2ce674c5ccb2",l.PassthroughDaterangeTags="46d7d385-62a6-4aff-bb08-ca35fbadd8e6",l.DroppedFrameFilter="171673d5-bd3f-438c-b9da-70ca99609b25",l.WebReaderUpdate="bbedb433-bf1d-4d47-afb6-ca5f882d7cc1",l.NewUpdateIdle="ivs-client-web-new-updateidle",l),ta=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return tn().apply(void 0,[{},e].concat(n,[function(e,t){Array.isArray(t)&&[].concat(t)}]))},ts=function(){function e(e,t){var n;void 0===e&&(e={}),this.onConfigChanged=t,this.mainConfig=void 0,this.experimentHandler=void 0,this.defaultConfig={media:{abr:{},codecConfigs:[],supportsMixedCodec:!0},logLevel:"",features:{gpu:{flags:{enable_render_surface:!1,add_canvas_to_surface:!1,allow_canvas_visible:!1,init_transformer:!1,run_transformer:!1},render:{},module:{},configured:!1},mseInWorkers:{enable:!0,supportedBrowsers:((n={})[m.mC.CHROME]=!0,n[m.mC.EDGE]=!1,n[m.mC.FIREFOX]=!1,n[m.mC.SAFARI]=!1,n[m.mC.OPERA]=!1,n)},supportsMuxedFMP4:!0,sink:{}},experiments:{}},this.deviceConfigManager=void 0,this.deviceConfigAnalyticsHandler=void 0,this.resetMainConfig(),this.setupExperimentHandlers(),this.mainConfig=ta(this.mainConfig,function(e){var t,n=tn()({},e),r=Object.entries(null!=(t=n.experiments)?t:{});n.experiments={};for(var i=0;i<r.length;i++){var o=r[i],a=(o[0],o[1]);null!=a&&a.id&&(n.experiments[a.id]=a)}return n}(e));for(var r=0,i=Object.values(null!=(o=this.mainConfig.experiments)?o:[]);r<i.length;r++){var o,a=i[r];a&&this.setExperiment(a)}}var t=e.prototype;return t.initDeviceConfigManager=function(e){var t;this.shouldEnableDeviceConfigManager()&&(this.deviceConfigManager||(this.deviceConfigManager=eE.DeviceConfigManager.getInstance(window,{fileKey:"player-web-v1",standardEnv:eE.DeviceConfigEnv.PROD,refresh:{canRefreshNow:e.canRefreshNow},emitMetrics:e.emitMetrics,enableConsoleLog:"localhost"==window.location.hostname||(null==(t=window.location.hostname)?void 0:t.startsWith("localhost."))}),this.deviceConfigManager&&(this.deviceConfigAnalyticsHandler=new ti(e.emitAnalytics))))},t.shouldEnableDeviceConfigManager=function(){var e;return"treatment"===(null==(e=this.mainConfig.experiments[to.DeviceConfigTest])?void 0:e.assignment)},t.setupExperimentHandlers=function(){var e=this,t=this.handleExperiment(function(){return e.mainConfig.features.gpu},function(e,t){if(e.configured)return e;var n=ta(e,tu(t));return n.configured=!0,n},function(t){e.mainConfig.features.gpu=t}),n=function(e,t,n){if("treatment"===n){var r=_()({},t);return r.supportedBrowsers[e]=!0,r}return t},r=function(t){return e.handleExperiment(function(){return e.mainConfig.features.mseInWorkers},n.bind(e,t),function(t){e.mainConfig.features.mseInWorkers=t})},i=this.handleExperiment(function(){var t;return null!=(t=e.mainConfig.features.passthroughDaterangeTags)&&t},function(e,t){return"treatment"===t},function(t){e.mainConfig.features.passthroughDaterangeTags=t}),o=this.handleExperiment(function(){var t,n;return[null==(t=e.mainConfig.features.supportsMuxedFMP4)||t,null!=(n=e.mainConfig.media.codecConfigs)?n:[]]},function(e,t){var n=e[0],r=e[1];return!1==(!1===(0,m.cp)().supportsMuxedFMP4&&"treatment"===t||"variant"===t)?[n,r]:[!1,[].concat(r,[{codecString:tr.HEVC,setting:{disableUse:!0}}])]},function(t){var n=t[0],r=t[1];e.mainConfig.features.supportsMuxedFMP4=n,e.mainConfig.media.codecConfigs=r}),a=this.handleExperiment(function(){return e.mainConfig.media.abr.droppedFrameFilterThresholdCoefficient},function(e,t){var n=t.split("_"),r=n[0],i=n[1];if("treatment"===r){var o=parseInt(i);if(!Number.isNaN(o))return o}},function(t){e.mainConfig.media.abr.droppedFrameFilterThresholdCoefficient=t});this.experimentHandler=new Map([[to.GPU,t],[to.GPUStaff,t],[to.SafariMSEInWorkers,r(m.mC.SAFARI)],[to.EdgeMSEInWorkers,r(m.mC.EDGE)],[to.OperaMSEInWorkers,r(m.mC.OPERA)],[to.PassthroughDaterangeTags,i],[to.WebReaderUpdate,o],[to.DroppedFrameFilter,a]])},t.getDeviceConfigPropertyHolder=function(){if(this.deviceConfigManager&&this.deviceConfigAnalyticsHandler)return this.deviceConfigManager.getConfigurationHolder({analytics:this.deviceConfigAnalyticsHandler})},t.getConfigSnapshot=function(){return _()({},this.mainConfig)},t.setExperiment=function(e){var t,n=e.id,r=e.assignment;this.mainConfig.experiments[n]=e,null!==r&&(null==(t=this.experimentHandler.get(n))||t(r))},t.delete=function(){this.resetMainConfig()},t.resetMainConfig=function(){this.mainConfig=_()({},this.defaultConfig)},t.handleExperiment=function(e,t,n){var r=this;return function(i){var o=e(),a=t(o,i);a!==o&&(n(a),r.onConfigChanged())}},e}(),tu=function(e){var t={};try{var n=e.split("_config_"),r=(n[0],n[1]);t=JSON.parse(atob(r))}catch(t){console.warn("[ConfigManager]: Invalid assignment config provided",e,t)}return t},tc=n(13131),tl=function(e){function t(t,n,r,i){var o;return(o=e.call(this,r)||this).source=t,o.code=n,o.message=r,o.fatal=i,o}return ec()(t,e),t}(r.n(tc)()(Error)),tf=((f={})[f.WebGPUNotAvailable=-1e3]="WebGPUNotAvailable",f[f.WebGPUAdapterNotAvailable=-1001]="WebGPUAdapterNotAvailable",f[f.WebGPUDeviceNotAvailable=-1002]="WebGPUDeviceNotAvailable",f[f.WebGPUAdapterInfoUndefined=-1003]="WebGPUAdapterInfoUndefined",f[f.ShaderCompilationFailed=-1100]="ShaderCompilationFailed",f[f.PipelineCreationFailed=-1101]="PipelineCreationFailed",f[f.SamplerCreationFailed=-1102]="SamplerCreationFailed",f[f.StreamCreationFailed=-1103]="StreamCreationFailed",f[f.ModelInitFailed=-1104]="ModelInitFailed",f[f.OutOfMemory=-1200]="OutOfMemory",f[f.InvalidBuffer=-1201]="InvalidBuffer",f[f.InvalidBufferSize=-1202]="InvalidBufferSize",f[f.BufferCopyFailed=-1203]="BufferCopyFailed",f[f.DeviceLost=-1300]="DeviceLost",f[f.DeviceLostTooManyRetries=-1301]="DeviceLostTooManyRetries",f[f.CanvasCreationFailed=-1400]="CanvasCreationFailed",f[f.InferenceFailed=-1500]="InferenceFailed",f[f.FetchFailed=-1600]="FetchFailed",f[f.Render=-1700]="Render",f[f.Init=-1800]="Init",f[f.FrameCaptureFailed=-1900]="FrameCaptureFailed",f[f.Performance=-2e3]="Performance",f[f.PerformanceLowRenderFramerate=-2001]="PerformanceLowRenderFramerate",f[f.PerformanceLowCaptureFramerate=-2002]="PerformanceLowCaptureFramerate",f[f.PerformanceTooManyOverbudgetFrames=-2010]="PerformanceTooManyOverbudgetFrames",f[f.PerformanceTooManySkippedFrames=-2011]="PerformanceTooManySkippedFrames",f[f.PerformanceTooManyDroppedSourceFrames=-2012]="PerformanceTooManyDroppedSourceFrames",f[f.PerformanceTooManyMissedFrames=-2013]="PerformanceTooManyMissedFrames",f[f.ResourceClosed=-9998]="ResourceClosed",f[f.BadParameters=-9999]="BadParameters",f),td=function(){function e(){this.frameStats=void 0,this.resetStats()}var t=e.prototype;return t.init=function(){var e=this;return new WritableStream({write:function(t){t&&Promise.resolve().then(function(){e.onFrameRecord(t)}).catch(function(e){x.error(e)})}})},t.stats=function(){return _()({},this.frameStats)},t.resetStats=function(){this.frameStats={received:0,overBudget:0,skipped:0,failed:0,transformed:0,rendered:0,transformTime:0,renderTime:0,receiveDelay:0,endToEnd:0}},t.onFrameRecord=function(e){var t={receive:e.timings.received-e.timings.captured,transform:e.timings.transformEnd-e.timings.transformStart,render:e.timings.renderEnd-e.timings.renderStart,endToEnd:e.timings.renderEnd-e.timings.captured};this.frameStats.received++,this.frameStats.receiveDelay+=t.receive,e.skipped&&(this.frameStats.skipped++,x.warn("[FrameRecordSink]: Frame "+e.number+" was skipped. Frame receive delay: "+t.receive+", Initial budget: "+e.budget+"ms, Min budget: "+e.minBudget+"ms",t,e)),e.transformed&&(this.frameStats.transformed++,this.frameStats.transformTime+=t.transform),e.rendered&&(this.frameStats.rendered++,this.frameStats.renderTime+=t.render),e.failed&&(this.frameStats.failed++,x.warn("[FrameRecordSink]: Frame "+e.number+" failed to to transform or render. See error log for details.",t,e)),t.endToEnd>=e.budget&&(this.frameStats.overBudget++,x.warn("[FrameRecordSink]: Frame "+e.number+" was overbudget. End to end time: "+t.endToEnd+"ms Budget: "+e.budget+"ms",t,e)),this.frameStats.endToEnd+=t.endToEnd},e}(),th=function(){function e(e,t,n,r){this.inputFrameStream=e,this.sink=t,this.listeners=n,this.config=r,this.pipeline=void 0,this.transformer=void 0,this.frameRecordSink=void 0,this.frameRecordSink=new td}var t,n,r,i=e.prototype;return t=k()(P().mark(function e(t){var n,r=this;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.transformer=t,e.prev=1,n=this.frameRecordSink.init(),this.pipeline=this.createPipeline(),this.pipeline.readable.pipeTo(n).catch(function(e){r.listeners.error(new tl("VideoFramePipeline",tf.PipelineCreationFailed,"Failed to pipe to frameRecordStream: "+(null==e?void 0:e.message),!0))}),this.inputFrameStream.pipeThrough(this.pipeline),e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",new tl("VideoFramePipeline",tf.PipelineCreationFailed,"Failed to init pipeline: "+(null==e.t0?void 0:e.t0.message),!0));case 11:return e.abrupt("return",void 0);case 12:case"end":return e.stop()}},e,this,[[1,8]])})),i.init=function(e){return t.apply(this,arguments)},i.stats=function(){return this.frameRecordSink.stats()},i.resetStats=function(){this.frameRecordSink.resetStats()},i.createPipeline=function(){var e,t=this;return new TransformStream({transform:(e=k()(P().mark(function e(n,r){var i,o,a,s,u,c,l,f,d,h;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.frame,o=n.record,a=performance.now(),s=void 0,u=[],c=Math.min(a-o.timings.captured,0),o.timings.received=a,l=1e3/t.config.minimumFramerate-(t.config.includeReceiveDelay?c:0),o.budget=l,o.minBudget=0,f=function(){var e=k()(P().mark(function e(){var n;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.render(i,o,s);case 2:(n=e.sent.renderError)&&u.push(n),i.close(),o.failed=!!u.length,r.enqueue(o),u.forEach(function(e){return t.handleErrorInternal(e)});case 9:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),!(l<=0)){e.next=16;break}return o.skipped=!0,e.next=15,f();case 15:return e.abrupt("return");case 16:return e.next=18,t.frameToTexture(i,o,l);case 18:return h=(d=e.sent).transformError,s=d.texture,h&&u.push(h),e.next=25,f();case 25:case"end":return e.stop()}},e)})),function(t,n){return e.apply(this,arguments)})})},n=k()(P().mark(function e(t,n,r){var i,o,a,s,u;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=performance.now(),o=void 0,n.timings.transformStart=i,e.next=5,this.transformer.transform(t,n,r);case 5:return s=(a=e.sent).texture,(u=a.error)?(x.warn("[VideoFramePipeline]: Failed to transform frame "+n.number),o=u):s&&(n.transformed=!0),n.timings.transformEnd=performance.now(),e.abrupt("return",{transformError:o,texture:s});case 11:case"end":return e.stop()}},e,this)})),i.frameToTexture=function(e,t,r){return n.apply(this,arguments)},r=k()(P().mark(function e(t,n,r){var i,o,a,s,u,c;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=performance.now(),n.timings.renderStart=i,o=void 0,e.prev=3,u=null!=(a=null==r?void 0:r.width)?a:t.displayWidth,c=null!=(s=null==r?void 0:r.height)?s:t.displayHeight,this.sink.setDimensions(u,c),e.next=9,this.sink.render(null!=r?r:t);case 9:(o=e.sent)||(n.rendered=!0),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(3),x.warn("[VideoFramePipeline]: Failed to render frame "+n.number),o=e.t0;case 17:return n.timings.renderEnd=performance.now(),e.abrupt("return",{renderError:o});case 19:case"end":return e.stop()}},e,this,[[3,13]])})),i.render=function(e,t,n){return r.apply(this,arguments)},i.handleErrorInternal=function(e){x.warn("[VideoFramePipeline]: Error transforming frame",e),this.listeners.error(e)},e}(),tp=function(){function e(e,t){this.config=e,this.onError=t,this.active=!1,this.frameStream=void 0,this.frameWriter=void 0,this.stopCapture=void 0,this.captureStats=void 0,this.frameMetadata={pipelineId:"",match:{width:-1,height:-1}},this.resetStats()}var t=e.prototype;return t.init=function(){try{this.frameStream=new TransformStream({},{highWaterMark:this.config.maxQueueSize}),this.frameWriter=this.frameStream.writable.getWriter()}catch(e){return new tl("VideoFrameCaptureStream",tf.StreamCreationFailed,e.message,!0)}},t.start=function(e){this.active?x.warn("[VideoFrameCaptureStream]: Start called, but already capturing"):(this.startRVFC(e),this.active=!0)},t.stop=function(){var e;this.active=!1,null==(e=this.stopCapture)||e.call(this)},t.setVideoFrameMetadata=function(e){this.frameMetadata=e},t.stats=function(){return this.captureStats},t.resetStats=function(){this.captureStats={captured:0,missed:0,blocked:0,rVFCDelay:0}},t.getStream=function(){return this.frameStream.readable},t.startRVFC=function(e){var t,n,r=this,i=void 0,o=-1;null==(n=this.stopCapture)||n.call(this),this.stopCapture=function(){return e.cancelVideoFrameCallback(o)};var a=(t=k()(P().mark(function t(n,s){var u,c,l,f;return P().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r.active){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,c=performance.now(),r.captureStats.rVFCDelay+=c-n,l=new VideoFrame(e),(f={pipelineId:"",number:0,budget:0,minBudget:0,blocked:!1,skipped:!1,transformed:!1,rendered:!1,overbudget:!1,failed:!1,timings:{composited:0,captured:0,received:0,transformStart:0,transformEnd:0,renderStart:0,renderEnd:0}}).number=s.presentedFrames,f.timings.composited=n,f.timings.captured=c,l.displayWidth===r.frameMetadata.match.width&&l.displayHeight===r.frameMetadata.match.height&&(f.pipelineId=r.frameMetadata.pipelineId),!((null!=(u=r.frameWriter.desiredSize)?u:0)<1)){t.next=18;break}return r.captureStats.blocked++,f.blocked=!0,t.next=16,r.frameWriter.write({frame:l,record:f});case 16:t.next=19;break;case 18:r.frameWriter.write({frame:l,record:f}).catch(function(e){r.onError(new tl("CaptureStream",tf.FrameCaptureFailed,"Failed to write frame to stream: "+((null==e?void 0:e.message)||"unknown error"),!0))});case 19:void 0===i?i=s.presentedFrames:s.presentedFrames-i>1&&(r.captureStats.missed+=s.presentedFrames-i),i=s.presentedFrames,r.captureStats.captured++,o=e.requestVideoFrameCallback(a),t.next=28;break;case 25:t.prev=25,t.t0=t.catch(2),r.errorHandler(new tl("CaptureStream",tf.FrameCaptureFailed,"Failed to write frame to stream: "+((null==t.t0?void 0:t.t0.message)||"unknown error"),!0));case 28:case"end":return t.stop()}},t,null,[[2,25]])})),function(e,n){return t.apply(this,arguments)});x.log("[VideoFrameCaptureStream]: Started",e),o=e.requestVideoFrameCallback(a)},t.errorHandler=function(e){this.stop(),this.onError(e)},e}(),tv=function(){function e(e,t){this.windowContext=e,this.config=t,this.adapter=void 0,this.adapterInfo=void 0,this.device=void 0,this.queue=void 0,this.timingInfoEnabled=void 0,this.storageFormat=void 0}var t,n,r,i,o=e.prototype;return t=k()(P().mark(function e(){var t,n,r,i,o,a;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.windowContext.navigator.gpu){e.next=2;break}return e.abrupt("return",new tl("WebGPUContext",tf.WebGPUNotAvailable,"WebGPU not available",!0));case 2:return e.next=4,this.windowContext.navigator.gpu.requestAdapter({});case 4:if(t=e.sent){e.next=7;break}return e.abrupt("return",new tl("WebGPUContext",tf.WebGPUAdapterNotAvailable,"WebGPU Adapter not available",!0));case 7:if(t.info){e.next=9;break}return e.abrupt("return",new tl("WebGPUContext",tf.WebGPUAdapterInfoUndefined,"WebGPU adapter.info is undefined",!0));case 9:return n=[].concat(this.config.requiredFeatures),r={},i="bgra8unorm"===this.windowContext.navigator.gpu.getPreferredCanvasFormat()&&t.features.has("bgra8unorm-storage"),o=this.config.timingInfoEnabled&&t.features.has("timestamp-query"),i&&n.push("bgra8unorm-storage"),o&&n.push("timestamp-query"),r.requiredFeatures=n,e.next=18,this.tryGetDevice(t,r);case 18:if(a=e.sent){e.next=21;break}return e.abrupt("return",new tl("WebGPUContext",tf.WebGPUDeviceNotAvailable,"WebGPU Device not available",!0));case 21:this.adapterInfo=t.info,this.timingInfoEnabled=o,this.storageFormat=i?"bgra8unorm":"rgba8unorm",this.adapter=t,this.device=a,this.queue=a.queue,x.info("[WebGPUContext]: WebGPU context initialized",this.properties());case 28:case"end":return e.stop()}},e,this)})),o.init=function(){return t.apply(this,arguments)},o.properties=function(){if(!this.adapterInfo)return{architecture:"",description:"",device:"",vendor:"",adapterFeatures:"",deviceFeatures:"",wgslFeatures:""};var e,t="";this.adapter.features.forEach(function(e){t+=e+","});var n="";this.device.features.forEach(function(e){n+=e+","});var r="";return null==(e=navigator.gpu.wgslLanguageFeatures)||e.forEach(function(e){r+=e+","}),{architecture:this.adapterInfo.architecture,description:this.adapterInfo.description,device:this.adapterInfo.device,vendor:this.adapterInfo.vendor,adapterFeatures:t,deviceFeatures:n,wgslFeatures:r}},o.createBuffer=function(e,t){return this.device.pushErrorScope("out-of-memory"),this.device.createBuffer({size:e,usage:t})},n=k()(P().mark(function e(t,n,r){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===r&&(r=!0),this.device.queue.writeBuffer(t,0,n),!r){e.next=5;break}return e.next=5,this.device.queue.onSubmittedWorkDone();case 5:case"end":return e.stop()}},e,this)})),o.setBufferData=function(e,t,r){return n.apply(this,arguments)},r=k()(P().mark(function e(t){var n,r;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.device.createShaderModule({code:t}),e.next=3,n.getCompilationInfo();case 3:if(!((r=e.sent).messages.length>0)){e.next=7;break}return x.error("[WebGPUContext]: Error compiling shader",r.messages),e.abrupt("return",{err:new tl("WebGPUContext",tf.ShaderCompilationFailed,"Compilation failed: "+r.messages.join(),!0)});case 7:return e.abrupt("return",{module:n});case 8:case"end":return e.stop()}},e,this)})),o.createShaderModule=function(e){return r.apply(this,arguments)},i=k()(P().mark(function e(t,n){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.requestDevice(n);case 3:case 11:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.prev=8,e.next=11,t.requestDevice(null);case 14:return e.prev=14,e.t1=e.catch(8),e.abrupt("return",void 0);case 17:case"end":return e.stop()}},e,null,[[0,6],[8,14]])})),o.tryGetDevice=function(e,t){return i.apply(this,arguments)},e}(),tg=function(){function e(e,t,n){this.canvasEl=e,this.gpuContext=t,this.onError=n,this.canvas=void 0,this.device=void 0,this.canvasContext=void 0,this.pipelines=void 0,this.device=t.device,this.pipelines=new Map}var t,n,r,i,o,a,s=e.prototype;return t=k()(P().mark(function e(){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.setCanvas(this.canvasEl.transferControlToOffscreen());case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",new tl("CanvasSink",tf.CanvasCreationFailed,e.t0.message,!0));case 8:return e.abrupt("return",void 0);case 9:case"end":return e.stop()}},e,this,[[0,5]])})),s.init=function(){return t.apply(this,arguments)},n=k()(P().mark(function e(t){var n,r,i,o,a,s,u,c,l;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canvasContext&&this.canvas){e.next=2;break}return e.abrupt("return",new tl("CanvasSink",tf.Render,"Failed to get WebGPU Canvas context",!0));case 2:return n=t instanceof VideoFrame,e.next=5,this.getPipeline(this.canvas.width,this.canvas.height,n);case 5:if(i=(r=e.sent).pipeline,!(o=r.error)&&i){e.next=10;break}return e.abrupt("return",o);case 10:a=n?this.device.importExternalTexture({source:t}):t.createView(),s=i.getBindGroupLayout(0),u=this.device.createBindGroup({layout:s,entries:[{binding:0,resource:this.canvasContext.getCurrentTexture().createView()},{binding:1,resource:a}]}),this.device.pushErrorScope("validation"),(l=(c=this.device.createCommandEncoder()).beginComputePass()).setPipeline(i),l.setBindGroup(0,u),l.dispatchWorkgroups(Math.ceil(this.canvas.width/16),Math.ceil(this.canvas.height/16),1),l.end(),this.device.queue.submit([c.finish()]),this.checkForErrorsAsync();case 22:case"end":return e.stop()}},e,this)})),s.render=function(e){return n.apply(this,arguments)},s.setDimensions=function(e,t){this.canvas&&(e!==this.canvas.width||t!==this.canvas.height)&&(this.canvas.width=e,this.canvas.height=t)},r=k()(P().mark(function e(t){var n,r;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.canvas=t,this.canvasContext=t.getContext("webgpu"),this.canvasContext){e.next=4;break}return e.abrupt("return",new tl("CanvasSink",tf.Render,"Failed to get WebGPU Canvas context",!0));case 4:return n=this.gpuContext.storageFormat,r={device:this.device,format:n,usage:GPUTextureUsage.STORAGE_BINDING,viewFormats:[n],alphaMode:"opaque"},this.device.pushErrorScope("validation"),this.canvasContext.configure(r),e.next=10,this.device.popErrorScope();case 10:if(!e.sent){e.next=13;break}return e.abrupt("return",new tl("CanvasSink",tf.Render,"Failed to configure Canvas context",!0));case 13:return e.abrupt("return",void 0);case 14:case"end":return e.stop()}},e,this)})),s.setCanvas=function(e){return r.apply(this,arguments)},i=k()(P().mark(function e(t,n,r){var i,o=this;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r+"_"+t+"_"+n,!this.pipelines.has(i)||!this.pipelines.get(i)){e.next=3;break}return e.abrupt("return",{pipeline:this.pipelines.get(i),error:void 0});case 3:return e.abrupt("return",this.makePipeline(t,n,r).then(function(e){return e.pipeline&&o.pipelines.set(i,e.pipeline),e}));case 4:case"end":return e.stop()}},e,this)})),s.getPipeline=function(e,t,n){return i.apply(this,arguments)},o=k()(P().mark(function e(t,n,r){var i,o,a,s,u,c;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.getShader(t,n,r),e.next=3,this.createShaderModule(i);case 3:if(a=(o=e.sent).module,s=o.error,a&&!s){e.next=8;break}return e.abrupt("return",{error:s});case 8:return this.device.pushErrorScope("validation"),u=this.device.createComputePipeline({layout:"auto",compute:{module:a,entryPoint:"main"},label:"canvas-sink_"+t+"_"+n+"_"+r}),e.next=12,this.device.popErrorScope();case 12:if(!(c=e.sent)){e.next=15;break}return e.abrupt("return",{error:new tl("CanvasSink",tf.PipelineCreationFailed,""+c.message,!0)});case 15:return e.abrupt("return",{pipeline:u});case 16:case"end":return e.stop()}},e,this)})),s.makePipeline=function(e,t,n){return o.apply(this,arguments)},a=k()(P().mark(function e(t){var n,r;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.device.createShaderModule({code:t}),e.next=3,n.getCompilationInfo();case 3:if(!((r=e.sent).messages.length>0)){e.next=7;break}return x.error("[CanvasSink]: Error compiling shader",r.messages),e.abrupt("return",{error:new tl("CanvasSink",tf.ShaderCompilationFailed,"Shader compilation failed: "+r.messages.join(),!0)});case 7:return e.abrupt("return",{module:n});case 8:case"end":return e.stop()}},e,this)})),s.createShaderModule=function(e){return a.apply(this,arguments)},s.getShader=function(e,t,n){return"\n        @group(0) @binding(0) var outputTexture: texture_storage_2d<"+this.gpuContext.storageFormat+", write>;\n        @group(0) @binding(1) var inputTexture: "+(n?"texture_external":"texture_2d<f32>")+";\n\n        @compute @workgroup_size(16,16,1)\n        fn main(@builtin(global_invocation_id) global_id : vec3<u32>) {\n            if (global_id.x >= "+e+" || global_id.y >= "+t+") {\n                return;\n            }\n            let color = "+(n?"textureLoad(inputTexture, global_id.xy);":"textureLoad(inputTexture, global_id.xy, 0);")+";\n            textureStore(outputTexture, global_id.xy, color);\n        }\n        "},s.checkForErrorsAsync=function(){var e=this;this.device.popErrorScope().then(function(t){t&&(x.warn("[CanvasSink]: WebGPU error encountered",t),e.onErrorInternal(new tl("CanvasSink",tf.Render,"Failed to render: "+t.message,!0)))}).catch(function(t){e.onError(new tl("CanvasSink",tf.BadParameters,"Failed to popErrorScope: "+((null==t?void 0:t.message)||"unknown error"),!0))})},s.onErrorInternal=function(e){this.onError(e)},e}(),tm=function(){function e(e,t){this.name=e,this.listeners=t,this.frameBudgetTimeout=-1}var t,n,r,i,o,a=e.prototype;return t=k()(P().mark(function e(){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve(void 0));case 1:case"end":return e.stop()}},e)})),a.init=function(){return t.apply(this,arguments)},n=k()(P().mark(function e(t,n,r){var i,o=this;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.race([this.doTransform(t,n),this.frameBudgetExceededPassthrough(r)]).catch(function(e){return clearTimeout(o.frameBudgetTimeout),{frame:t,error:e}});case 2:return i=e.sent,clearTimeout(this.frameBudgetTimeout),e.abrupt("return",i);case 5:case"end":return e.stop()}},e,this)})),a.transform=function(e,t,r){return n.apply(this,arguments)},r=k()(P().mark(function e(t,n){var r;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.transformFn(t,n);case 2:return r=e.sent,e.abrupt("return",{texture:r});case 4:case"end":return e.stop()}},e,this)})),a.doTransform=function(e,t){return r.apply(this,arguments)},i=k()(P().mark(function e(t){var n=this;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e){return n.frameBudgetTimeout=window.setTimeout(function(){e({})},t)}));case 1:case"end":return e.stop()}},e)})),a.frameBudgetExceededPassthrough=function(e){return i.apply(this,arguments)},o=k()(P().mark(function e(t,n){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}},e)})),a.transformFn=function(e,t){return o.apply(this,arguments)},e}(),ty=function(e){var t;function n(){return e.call(this,"PassthroughTransformer",{error:function(){}})||this}return ec()(n,e),n.prototype.transform=(t=k()(P().mark(function e(t){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{});case 1:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),n}(tm);function t_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var tb=function(){function e(e,t,n){var r,i,o;this.config=e,this.getStats=t,this.listeners=n,this.monitorInterval=-1,this.active=!1,this.validators=[],x.log("[PerformanceMontior]: Config",this.config),this.validators.push((r={maxDroppedFramesPct:e.frameRateDiffPercentage},{validate:function(e){var t=1-e.source_presented/e.source;if(t>=r.maxDroppedFramesPct)return{code:tf.PerformanceTooManyDroppedSourceFrames,fatal:!0,reason:"Too many dropped source frames. Dropped: "+(100*t).toFixed(0)+"%, Max: "+100*r.maxDroppedFramesPct+"% Presented frames: "+e.source_presented+", Total frames: "+e.source}}}),(i={frameCountDiffPercentage:this.config.frameCountDiffPercentage,captureRateDiffPercentage:this.config.frameRateDiffPercentage},{validate:function(e){var t=e.captured,n=e.source_presented,r=n-n*i.frameCountDiffPercentage;if(t<r)return{code:tf.PerformanceLowRenderFramerate,fatal:!0,reason:"Capture framerate is too low. Source Presented: "+n+" Min: "+r+" Captured: "+t+" Config: "+100*i.frameCountDiffPercentage+"%"}}}),(o={frameCountDiffPercentage:this.config.frameCountDiffPercentage,renderFramerateDiffPercentage:this.config.frameRateDiffPercentage},{validate:function(e){var t=e.source,n=e.rendered,r=e.received;if(e.overBudget>r*o.frameCountDiffPercentage)return{code:tf.PerformanceTooManyOverbudgetFrames,fatal:!0,reason:"Too many overbudget frames. Received: "+r+" Max: "+r*o.frameCountDiffPercentage+" Have: "+e.overBudget+" Config: "+100*o.frameCountDiffPercentage+"%"};if(e.skipped>r*o.frameCountDiffPercentage)return{code:tf.PerformanceTooManySkippedFrames,fatal:!0,reason:"Too many skipped frames. Received: "+r+" Max: "+r*o.frameCountDiffPercentage+" Have: "+e.skipped+" Config: "+100*o.frameCountDiffPercentage+"%"};var i=t-t*o.renderFramerateDiffPercentage;return n<i?{code:tf.PerformanceLowRenderFramerate,fatal:!0,reason:"Render framerate is too low. Source: "+t+" Min: "+i+" Rendered: "+n+" Config: "+100*o.renderFramerateDiffPercentage+"%"}:void 0}}))}var t=e.prototype;return t.start=function(){var e=this;if(this.config.enable)if(this.monitoring())x.log("[PerformanceMonitor]: Resume called on active instance");else{x.log("[PerformanceMonitor]: Monitoring started");var t=this.getStats();window.clearInterval(this.monitorInterval),this.monitorInterval=window.setInterval(function(){var n=e.getStats(),r=e.validatePerformance(t,n);r&&e.listeners.performanceBreach(r),t=n},this.config.monitorIntervalMs)}},t.stop=function(){window.clearInterval(this.monitorInterval),this.monitorInterval=-1},t.monitoring=function(){return this.monitorInterval>0},t.validatePerformance=function(e,t){var n=this.diffFrameStats(e.frames,t.frames);x.log("[PerformanceMonitor] Stats:",e,t),x.log("[PerformanceMonitor] Stats diff:",n);var r=this.config.monitorIntervalMs/1e3*20;if(n.source<=r)x.log("[PerformanceMonitor]: Not enough source frames to validate. Have: "+n.source+" Need: "+r);else for(var i,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return t_(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t_(e,void 0):void 0}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(this.validators);!(i=o()).done;){var a=i.value.validate(n);if(a)return a}},t.diffFrameStats=function(e,t){for(var n={source:0,source_presented:0,captured:0,missed:0,blocked:0,received:0,skipped:0,transformed:0,rendered:0,failed:0,overBudget:0},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r],a=o[0],s=o[1];n[a]=s-e[a]}return n},e}(),tE=((d={})[d.External=0]="External",d[d.Texture=1]="Texture",d[d.Buffer=2]="Buffer",d);function tS(e,t,n){return Array.from({length:e},function(e,t){return t}).map(n).join(t)}var tT=((h={})[h.Default=0]="Default",h[h.HostToDevice=1]="HostToDevice",h[h.DeviceToHost=4]="DeviceToHost",h[h.TimingQuery=8]="TimingQuery",h),tw=function(){function e(e,t,n){void 0===n&&(n=tT.Default),this.bytesize=t,this.usage=n,this.deviceBuffer=void 0,this.stagingBuffer=void 0,this.closed=!1;var r=GPUBufferUsage.STORAGE;n===tT.HostToDevice?r|=GPUBufferUsage.COPY_DST:n===tT.DeviceToHost?(r|=GPUBufferUsage.COPY_SRC,this.stagingBuffer=e.createBuffer(t,GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ)):n===tT.TimingQuery&&(r|=GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC,this.stagingBuffer=e.createBuffer(t,GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ)),this.deviceBuffer=e.createBuffer(t,r)}var t,n,r=e.prototype;return t=k()(P().mark(function e(t,n){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.closed){e.next=2;break}return e.abrupt("return",new tl("Buffer",tf.ResourceClosed,"Buffer has been closed",!0));case 2:return e.prev=2,e.next=5,t.setBufferData(this.deviceBuffer,n,!1);case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(2),e.abrupt("return",new tl("Buffer",tf.BadParameters,"Failed to copy to host: "+((null==e.t0?void 0:e.t0.message)||"unknown"),!0));case 10:case"end":return e.stop()}},e,this,[[2,7]])})),r.copyToDevice=function(e,n){return t.apply(this,arguments)},n=k()(P().mark(function e(t){var n,r;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.closed){e.next=2;break}return e.abrupt("return",{err:new tl("Buffer",tf.ResourceClosed,"Buffer has been closed",!0)});case 2:if(this.stagingBuffer&&this.usage!==tT.DeviceToHost){e.next=4;break}return e.abrupt("return",{err:new tl("Buffer",tf.BadParameters,"Buffer usage is "+this.usage+", but should be BufferUsage.DeviceToHost",!0)});case 4:return e.prev=4,(n=t.createCommandEncoder()).copyBufferToBuffer(this.deviceBuffer,0,this.stagingBuffer,0,this.bytesize),t.queue.submit([n.finish()]),e.next=10,t.queue.onSubmittedWorkDone();case 10:return e.next=12,this.stagingBuffer.mapAsync(GPUMapMode.READ);case 12:return r=structuredClone(this.stagingBuffer.getMappedRange()),this.stagingBuffer.unmap(),e.abrupt("return",{buffer:r});case 17:return e.prev=17,e.t0=e.catch(4),e.abrupt("return",{err:new tl("Buffer",tf.BufferCopyFailed,"Failed to copy to host: "+((null==e.t0?void 0:e.t0.message)||"unknown"),!0)});case 20:case"end":return e.stop()}},e,this,[[4,17]])})),r.copyToHost=function(e){return n.apply(this,arguments)},r.close=function(){var e;this.closed=!0,this.deviceBuffer.destroy(),null==(e=this.stagingBuffer)||e.destroy()},e}(),tC=function(){function e(e,t,n,r,i){void 0===i&&(i=tT.Default),this.usage=i,this.stagingBuffer=void 0,this.deviceTexture=void 0,this.closed=!1;var o=GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.TEXTURE_BINDING;i===tT.HostToDevice?o|=GPUTextureUsage.COPY_DST:i===tT.DeviceToHost?(x.warn("[Buffer]: Copying texture to host buffer only supports 32bpp formats."),o|=GPUTextureUsage.COPY_SRC,this.stagingBuffer=e.createBuffer(256*Math.ceil(4*t/256)*n,GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ)):i===tT.TimingQuery&&x.warn("[Buffer]: BufferUsage.TimingQuery is not valid for Texture"),this.deviceTexture=e.device.createTexture({size:{width:t,height:n},format:r,usage:o})}var t,n=e.prototype;return t=k()(P().mark(function e(t){var n,r;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.closed){e.next=2;break}return e.abrupt("return",{err:new tl("Texture",tf.ResourceClosed,"Texture has been closed",!0)});case 2:if(this.stagingBuffer&&this.usage!==tT.DeviceToHost){e.next=4;break}return e.abrupt("return",{err:new tl("Texture",tf.BadParameters,"Buffer usage is "+this.usage+", but should be BufferUsage.DeviceToHost",!0)});case 4:return x.debug("[Buffer]: copying texture",this.deviceTexture),e.prev=5,(n=t.createCommandEncoder()).copyTextureToBuffer({texture:this.deviceTexture,mipLevel:0,origin:[0,0,0],aspect:"all"},{buffer:this.stagingBuffer,offset:0,bytesPerRow:256*Math.ceil(4*this.deviceTexture.width/256),rowsPerImage:this.deviceTexture.height},[this.deviceTexture.width,this.deviceTexture.height,1]),t.queue.submit([n.finish()]),e.next=11,t.queue.onSubmittedWorkDone();case 11:return e.next=13,this.stagingBuffer.mapAsync(GPUMapMode.READ);case 13:return r=structuredClone(this.stagingBuffer.getMappedRange()),this.stagingBuffer.unmap(),e.abrupt("return",{buffer:r});case 19:return e.prev=19,e.t0=e.catch(5),e.abrupt("return",{err:new tl("Texture",tf.BufferCopyFailed,"Failed to copy to host: "+((null==e.t0?void 0:e.t0.message)||"unknown"),!0)});case 22:case"end":return e.stop()}},e,this,[[5,19]])})),n.copyToHost=function(e){return t.apply(this,arguments)},n.close=function(){var e;this.closed=!0,this.deviceTexture.destroy(),null==(e=this.stagingBuffer)||e.destroy()},e}(),tk=((p={}).F16="f16",p.F32="f32",p),tI=function(){function e(e,t,n,r,i,o,a){void 0===i&&(i=1),void 0===o&&(o=!0),void 0===a&&(a=!1),this.inFilters=e,this.outFilters=t,this.kernelSize=n,this.scaleFactor=r,this.outPadding=i,this.convertToYuv=o,this.hostReadableOutput=a,this._configuration=void 0,this._activation=void 0,this._weights=void 0,this._biases=void 0,this._inputs=void 0,this._outputs=void 0,this._pipeline=void 0,this._outputShape=void 0,this._sampler=void 0}var t,n,r=e.prototype;return t=k()(P().mark(function e(t,n){var r,i,o,a,s,u,c;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.device.pushErrorScope("validation"),this._outputShape=[Math.ceil(n.inputShape[0]*this.scaleFactor),Math.ceil(n.inputShape[1]*this.scaleFactor),this.outFilters],r=(this._outputShape[0]+2*this.outPadding)*(this._outputShape[1]+2*this.outPadding)*this.outFilters,x.debug("[Conv2dEntry_Upscale]: Creating output buffer of size",r),i=n.dataType===tk.F32?4:2,this._configuration=n,this._activation=n.activation,this._outputs=new tw(t,r*i,this.hostReadableOutput?tT.DeviceToHost:tT.Default),o=this._createShader(n.expectedInputType),this._sampler=t.device.createSampler({magFilter:"linear",minFilter:"linear"}),e.next=12,t.createShaderModule(o);case 12:if(s=(a=e.sent).module,!(u=a.err)&&s){e.next=17;break}return e.abrupt("return",u||new tl("Conv2dEntry_Upscale",tf.PipelineCreationFailed,"Failed to create shader module",!0));case 17:return this._pipeline=t.device.createComputePipeline({layout:"auto",compute:{module:s,entryPoint:"main"},label:"conv2d_entry_upscale"}),e.next=20,t.device.popErrorScope();case 20:if(!(c=e.sent)){e.next=23;break}return e.abrupt("return",new tl("Conv2dEntry_Upscale",tf.PipelineCreationFailed,"Error creating compute pipeline: "+c.message,!0));case 23:case"end":return e.stop()}},e,this)})),r.configure=function(e,n){return t.apply(this,arguments)},r.setWeights=function(e){this._weights=e},r.setBiases=function(e){this._biases=e},r.setInputs=function(e){this._inputs=e},r.setQuantOffsets=function(e){},n=k()(P().mark(function e(){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._outputs);case 1:case"end":return e.stop()}},e,this)})),r.getOutputs=function(){return n.apply(this,arguments)},r.close=function(){var e;this._weights.close(),null==(e=this._biases)||e.close(),this._outputs.close()},r.createFinalizedPass=function(e,t,n){try{var r,i={label:"conv2d_entry_upscale"},o=this._pipeline.getBindGroupLayout(0);if(this._inputs instanceof GPUTexture)r=this._inputs.createView();else if(this._inputs instanceof VideoFrame)r=e.device.importExternalTexture({source:this._inputs});else{if(!(this._inputs instanceof GPUExternalTexture))return x.error("Conv2d_entry_upscale invalid input type"),{err:new tl("Conv2d_Entry_Upscale",tf.BadParameters,"Input type is not one of GPUTexture, GPUExternalTexture, VideoFrame",!0)};r=this._inputs}var a=[{binding:0,resource:{buffer:this._outputs.deviceBuffer}},{binding:1,resource:r},{binding:2,resource:this._sampler},{binding:3,resource:{buffer:this._weights.deviceBuffer}}];this._biases&&a.push({binding:4,resource:{buffer:this._biases.deviceBuffer}});var s=e.device.createBindGroup({layout:o,entries:a});n&&(i.timestampWrites={querySet:n,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1});var u=t.beginComputePass(i);return u.setPipeline(this._pipeline),u.setBindGroup(0,s),u.dispatchWorkgroups(Math.ceil(this._outputShape[1]/12),Math.ceil(this._outputShape[0]/12),1),u.end(),{pass:u}}catch(e){return{err:new tl("Conv2d_Entry_Upscale",tf.InferenceFailed,"Failed to create finalized pass: "+((null==e?void 0:e.message)||"unknown"),!0)}}},r._createShader=function(e){var t=e===tE.External?"texture_external":"texture_2d<fT>",n=this._configuration.dataType,r="sum;";this._activation&&(r=this._activation.getWGSL("x",n)+";");var i=4,o="";return this._biases&&(o="@group(0) @binding("+i+") var<storage, read> biases: array<fT, M * N>;",i++),"\n        "+(this._configuration.dataType===tk.F16?"enable f16;":"")+"\n        const GROUP_SIDE: u32 = 12;\n        const GROUP_LIMIT: u32 = 14;\n        const GROUP_THREADS: u32 = GROUP_SIDE * GROUP_SIDE;\n        const WARP_SIZE = 32;\n        const IN_FILTERS: u32 = "+this.inFilters+";\n        const OUT_FILTERS: u32 = "+this.outFilters+";\n        const OUT_PADDING: u32 = "+this.outPadding+";\n        const IN_PADDING: u32 = 1;\n\n        const TOTAL_FILTERS = IN_FILTERS * OUT_FILTERS;\n\n        const TILE_OFFSET: u32 = (GROUP_LIMIT - GROUP_SIDE) / 2;\n        const KERNEL_SIZE: u32 = 3;\n        const OUT_WIDTH: u32 = "+this._outputShape[1]+";\n        const OUT_HEIGHT: u32 = "+this._outputShape[0]+";\n        const Y_COEF = vec3<fT>(0.299, 0.587, 0.114);\n\n        alias fT = "+this._configuration.dataType+";\n\n        @group(0) @binding(0) var<storage, read_write> outputBuffer: array<fT, (OUT_HEIGHT + OUT_PADDING * 2) * (OUT_WIDTH + OUT_PADDING * 2) * OUT_FILTERS>;\n        @group(0) @binding(1) var inputTexture: "+t+";\n        @group(0) @binding(2) var inputSampler: sampler;\n        @group(0) @binding(3) var<storage, read> weightsBuffer: array<fT, KERNEL_SIZE * KERNEL_SIZE * TOTAL_FILTERS>;\n\n        "+o+"\n\n        var<workgroup> weights: array<fT, KERNEL_SIZE * KERNEL_SIZE * TOTAL_FILTERS>;\n        var<workgroup> scratch1: array<fT, GROUP_LIMIT*GROUP_LIMIT>; // Handles input to convolution\n\n        fn activate(x: fT) -> fT {\n            return "+r+";\n        }\n\n        @compute @workgroup_size(GROUP_SIDE,GROUP_SIDE,1)\n        fn main(@builtin(global_invocation_id) global_id: vec3<u32>,\n                @builtin(local_invocation_index) tid: u32,\n                @builtin(local_invocation_id) thread_id: vec3<u32>,\n                @builtin(workgroup_id) group_id: vec3<u32>) {\n            let texSize = vec2<f32>(f32(OUT_WIDTH), f32(OUT_HEIGHT));\n            let texelSize = 1.0 / texSize;\n            let cRow = group_id.y * GROUP_SIDE;\n            let cCol = group_id.x * GROUP_SIDE ;\n\n            // 1. load weights\n            for (var i: u32 = 0 ; i < (TOTAL_FILTERS*KERNEL_SIZE*KERNEL_SIZE+GROUP_THREADS-1)/GROUP_THREADS; i++) {\n                let idx: u32 = i * GROUP_THREADS + tid;\n                if (idx < TOTAL_FILTERS*KERNEL_SIZE*KERNEL_SIZE) {\n                    weights[idx] = weightsBuffer[idx];\n                }\n            }\n\n            // 2. load pixels from input texture into shared scratch\n            if (thread_id.x * 2 < GROUP_LIMIT && thread_id.y * 2 < GROUP_LIMIT) {\n                let sRow = i32(cRow) - i32(TILE_OFFSET);\n                let sCol = i32(cCol) - i32(TILE_OFFSET);\n                let lRow = i32(thread_id.y * 2) + sRow;\n                let lCol = i32(thread_id.x * 2) + sCol;\n                var s: array<vec3<fT>, 4>;\n                let curPos = vec2<f32>(f32(lCol), f32(lRow)) * texelSize;\n                let cInc = vec2<f32>(texelSize.x, 0.0);\n                let rInc = vec2<f32>(0.0, texelSize.y);\n\n                // Collect the pixels this thread should collect, storing in registers\n                s[0] = vec3<fT>(textureSampleBaseClampToEdge(inputTexture, inputSampler, curPos).rgb);\n                s[1] = vec3<fT>(textureSampleBaseClampToEdge(inputTexture, inputSampler, curPos+cInc).rgb);\n                s[2] = vec3<fT>(textureSampleBaseClampToEdge(inputTexture, inputSampler, curPos+rInc).rgb);\n                s[3] = vec3<fT>(textureSampleBaseClampToEdge(inputTexture, inputSampler, curPos+texelSize).rgb);\n\n                // Do YUV conversion and store in workgroup memory.\n                // Doing the YUV conversion here instead of when storing to registers seems to be more performant (on M2 macbook anyway)\n                //\n                let row = thread_id.y * 2;\n                let col = thread_id.x * 2;\n\n                // Convert RGB to YUV and compress from full range to video range [16-236]. Not doing this will result in artifacts.\n                scratch1[row * GROUP_LIMIT + col] = dot(s[0] * 0.8627 + 0.0627, Y_COEF);\n                if (col+1 < GROUP_LIMIT) {\n                    scratch1[row * GROUP_LIMIT + col + 1] = dot(s[1] * 0.8627 + 0.0627, Y_COEF);\n                }\n                if (row+1 < GROUP_LIMIT) {\n                    scratch1[(row+1) * GROUP_LIMIT + col] = dot(s[2] * 0.8627 + 0.0627, Y_COEF);\n                    if (col+1 < GROUP_LIMIT) {\n                        scratch1[(row+1) * GROUP_LIMIT + col + 1] = dot(s[3] * 0.8627 + 0.0627, Y_COEF);\n                    }\n                }\n            }\n            workgroupBarrier();\n\n            // Each thread will perform OUT_FILTERS convolutions\n            var centers: array<u32, OUT_FILTERS>;\n            var results: array<fT, OUT_FILTERS>;\n            for (var i: u32 = 0; i < OUT_FILTERS; i++) {\n                let z = thread_id.z + i;\n                // let y = thread_id.y;\n                // let x = thread_id.x;\n                centers[i] = z;//vec3<u32>(x,y,z);\n            }\n            {\n\n                let row = thread_id.y + 1;\n                let col = thread_id.x + 1;\n\n                // Load values. There will probably be bank conflicts here that we can optimize in the future.\n                // TODO: Batch this into array<fT,9*4>;\n                var v: array<fT, 9>;\n                v[0] = scratch1[(row-1) * GROUP_LIMIT + (col-1)];\n                v[3] = scratch1[(row) * GROUP_LIMIT + (col-1)];\n                v[6] = scratch1[(row+1) * GROUP_LIMIT + (col-1)];\n                v[1] = scratch1[(row-1) * GROUP_LIMIT + (col)];\n                v[4] = scratch1[(row) * GROUP_LIMIT + (col)];\n                v[7] = scratch1[(row+1) * GROUP_LIMIT + (col)];\n                v[2] = scratch1[(row-1) * GROUP_LIMIT + (col+1)];\n                v[5] = scratch1[(row) * GROUP_LIMIT + (col+1)];\n                v[8] = scratch1[(row+1) * GROUP_LIMIT + (col+1)];\n                for (var i: u32 = 0; i < OUT_FILTERS; i++) {\n                    // Load weights\n                    var w: array<fT, 9>;\n                    let off = centers[i] * KERNEL_SIZE * KERNEL_SIZE;\n                    for (var j: u32 = 0; j < KERNEL_SIZE * KERNEL_SIZE; j++) {\n                        w[j] = weights[off + j];\n                    }\n\n                    // Do dots\n                    var sum: fT = 0.0;\n                    sum += v[0] * w[0];\n                    sum += v[1] * w[1];\n                    sum += v[2] * w[2];\n                    sum += v[3] * w[3];\n                    sum += v[4] * w[4];\n                    sum += v[5] * w[5];\n                    sum += v[6] * w[6];\n                    sum += v[7] * w[7];\n                    sum += v[8] * w[8];\n                    results[i] = activate(sum);\n                }\n            }\n\n            // write results\n            for (var i: u32 = 0; i < OUT_FILTERS; i++) {\n                let x = thread_id.x + cCol;\n                let y = thread_id.y + cRow;\n                let z = centers[i];\n                // reliniarize\n                let idx = (y+OUT_PADDING) * (OUT_WIDTH + OUT_PADDING * 2) * OUT_FILTERS + x * OUT_FILTERS + z;\n                outputBuffer[idx] = results[i];\n            }\n        }\n        "},e}(),tP=function(){function e(e,t,n){void 0===n&&(n=!1),this.inFilters=e,this.outFilters=t,this.hostReadableOutput=n,this._configuration=void 0,this._activation=void 0,this._weights=void 0,this._biases=void 0,this._inputs=void 0,this._outputs=void 0,this._pipeline=void 0,this._inputShape=void 0,this._outputShape=void 0}var t,n,r=e.prototype;return t=k()(P().mark(function e(t,n){var r,i,o,a,s,u,c,l;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t.device.pushErrorScope("validation"),r=Math.floor(1),this._outputShape=[n.inputShape[0]-r+1,n.inputShape[1]-r+1,this.outFilters],this._inputShape=n.inputShape,i=(this._outputShape[0]+2)*(this._outputShape[1]+2)*this.outFilters,x.debug("GPURenderPipeline hidden output shape: "+this._outputShape+", size: "+i+" hostReadable "+this.hostReadableOutput),o=n.dataType===tk.F32?4:2,this._configuration=n,this._activation=n.activation,this._outputs=new tw(t,i*o,this.hostReadableOutput?tT.DeviceToHost:tT.Default),a=this.createShader(),e.next=14,t.createShaderModule(a);case 14:if(u=(s=e.sent).module,!(c=s.err)&&u){e.next=19;break}return e.abrupt("return",new tl("Conv2d_3x3s1p1",tf.PipelineCreationFailed,"Pipeline creation failed: "+(null==c?void 0:c.message),!0));case 19:return this._pipeline=t.device.createComputePipeline({layout:"auto",compute:{module:u,entryPoint:"main"},label:"conv2d_entry_upscale"}),e.next=22,t.device.popErrorScope();case 22:if(!(l=e.sent)){e.next=25;break}return e.abrupt("return",new tl("Conv2d_3x3s1p1",tf.PipelineCreationFailed,"Pipeline creation failed: "+(null==l?void 0:l.message),!0));case 25:e.next=30;break;case 27:return e.prev=27,e.t0=e.catch(0),e.abrupt("return",new tl("Conv2d_3x3s1p1",tf.PipelineCreationFailed,"Pipeline creation failed: "+(null==e.t0?void 0:e.t0.message),!0));case 30:case"end":return e.stop()}},e,this,[[0,27]])})),r.configure=function(e,n){return t.apply(this,arguments)},r.close=function(){var e;this._weights.close(),null==(e=this._biases)||e.close(),this._outputs.close()},r.setWeights=function(e){this._weights=e},r.setBiases=function(e){this._biases=e},r.setInputs=function(e){this._inputs=e},n=k()(P().mark(function e(){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._outputs);case 1:case"end":return e.stop()}},e,this)})),r.getOutputs=function(){return n.apply(this,arguments)},r.createFinalizedPass=function(e,t,n){if(!(this._inputs instanceof tw))return{err:new tl("Conv2d_3x3s1p1",tf.BadParameters,"ModelLayerInput is not a Buffer",!0)};try{var r={label:"conv2d_mid_basic"},i=this._pipeline.getBindGroupLayout(0),o=[{binding:0,resource:{buffer:this._outputs.deviceBuffer}},{binding:1,resource:{buffer:this._inputs.deviceBuffer}},{binding:2,resource:{buffer:this._weights.deviceBuffer}}];this._biases&&o.push({binding:3,resource:{buffer:this._biases.deviceBuffer}});var a=e.device.createBindGroup({layout:i,entries:o});n&&(r.timestampWrites={querySet:n,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1});var s=t.beginComputePass(r);return s.setPipeline(this._pipeline),s.setBindGroup(0,a),s.dispatchWorkgroups(Math.ceil(this._outputShape[1]/12),Math.ceil(this._outputShape[0]/8),this._outputShape[2]/8),s.end(),{pass:s}}catch(e){return{err:new tl("Conv2d_3x3s1p1",tf.InferenceFailed,"Layer pass failed: "+((null==e?void 0:e.message)||"unknown"),!0)}}},r.createShader=function(){var e=this._configuration.dataType,t="sum;";this._activation&&(t=this._activation.getWGSL("x",e)+";");var n="";return this._biases&&(n="@group(0) @binding(3) var<storage, read> biases: array<fT, M * N>;"),"\n            "+(this._configuration.dataType===tk.F16?"enable f16;":"")+"\n            const IN_FILTERS: u32 = "+this.inFilters+";\n            const OUT_FILTERS: u32 = "+this.outFilters+";\n            const TOTAL_FILTERS: u32 = IN_FILTERS * OUT_FILTERS;\n            const OUT_WIDTH: u32 = "+this._outputShape[1]+";\n            const OUT_HEIGHT: u32 = "+this._outputShape[0]+";\n            const IN_WIDTH: u32 = "+this._inputShape[1]+";\n            const IN_HEIGHT: u32 = "+this._inputShape[0]+";\n            const PADDING: u32 = 1;\n            const KERNEL_SIZE: u32 = 3;\n            const GROUP_SIDE_W: u32 = 12;\n            const GROUP_SIDE_H: u32 = 8;\n            const GROUP_DEPTH: u32 = 8;\n            const THREAD_DEPTH: u32 = 8;\n            const GROUP_LIMIT_W: u32 = GROUP_SIDE_W + PADDING * 2;\n            const GROUP_LIMIT_H: u32 = GROUP_SIDE_H + PADDING * 2;\n            const GROUP_THREADS: u32 = GROUP_SIDE_W * GROUP_SIDE_H;\n\n            const WARP_SIZE: u32 = 32;\n            alias fT = "+this._configuration.dataType+";\n            @group(0) @binding(0) var<storage, read_write> outputBuffer: array<fT, (OUT_HEIGHT + PADDING * 2) * (OUT_WIDTH + PADDING * 2) * OUT_FILTERS>;\n            @group(0) @binding(1) var<storage, read> inputBuffer: array<fT, (IN_HEIGHT + PADDING * 2) * (IN_WIDTH + PADDING * 2) * IN_FILTERS>;\n            @group(0) @binding(2) var<storage, read> weightsBuffer: array<fT, TOTAL_FILTERS * KERNEL_SIZE * KERNEL_SIZE>;\n            "+n+"\n            var<workgroup> weights: array<fT, KERNEL_SIZE * KERNEL_SIZE * TOTAL_FILTERS>;\n            var<workgroup> inputs: array<fT, GROUP_LIMIT_W * GROUP_LIMIT_H * IN_FILTERS>;\n\n            fn activate(x: fT) -> fT {\n                return "+t+";\n            }\n\n            @compute @workgroup_size(GROUP_SIDE_W, GROUP_SIDE_H, GROUP_DEPTH/THREAD_DEPTH)\n            fn main(@builtin(global_invocation_id) global_id: vec3<u32>,\n                    @builtin(local_invocation_index) tid: u32,\n                    @builtin(local_invocation_id) thread_id: vec3<u32>,\n                    @builtin(workgroup_id) group_id: vec3<u32>) {\n\n                let tileCol = group_id.x * GROUP_SIDE_W ;\n                let tileRow = group_id.y * GROUP_SIDE_H ;\n\n                // Load weights\n                for (var i: u32 = 0 ; i < ((TOTAL_FILTERS*KERNEL_SIZE*KERNEL_SIZE+GROUP_THREADS-1)/GROUP_THREADS); i++) {\n                    let idx: u32 = i * GROUP_THREADS + tid;\n                    if (idx < TOTAL_FILTERS*KERNEL_SIZE*KERNEL_SIZE) {\n                        weights[idx] = weightsBuffer[idx];\n                    }\n                }\n\n                // Load activations. This will be GROUP_LIMIT*GROUP_LIMIT*IN_FILTERS in size.\n                // Buffers are in (H,W,C) format\n\n                if (thread_id.x * 2 < GROUP_LIMIT_W && thread_id.y * 2 < GROUP_LIMIT_H) {\n                    for (var c: u32 = 0; c < IN_FILTERS; c++) {\n                        for (var n: u32 = 0; n < 2; n++) {\n                            for (var m: u32 = 0; m < 2; m++) {\n                                let sCol: u32 = (thread_id.x*2+m) * IN_FILTERS + c;\n                                let sRow: u32 = (thread_id.y*2+n) * IN_FILTERS * GROUP_LIMIT_W;\n                                let gIdx: u32 = (tileRow + thread_id.y*2 + n) * IN_FILTERS * (IN_WIDTH + PADDING * 2) + (tileCol + thread_id.x*2 + m) * IN_FILTERS + c;\n                                inputs[sRow + sCol] = inputBuffer[gIdx];\n                            }\n                        }\n                    }\n                }\n                workgroupBarrier();\n                var centers: array<vec3<u32>, THREAD_DEPTH>;\n                var results: array<fT, THREAD_DEPTH>;\n                for (var i: u32 = 0; i < THREAD_DEPTH; i++) {\n                    let z = group_id.z * GROUP_DEPTH + thread_id.z * THREAD_DEPTH + i;\n                    let y = thread_id.y;\n                    let x = thread_id.x;\n                    centers[i] = vec3<u32>(x,y,z);\n                    results[i] = 0.0;\n                }\n                for (var z: u32 = 0; z < IN_FILTERS; z++) {\n                    let row = thread_id.y + PADDING;\n                    let col = thread_id.x + PADDING;\n                    let c: u32 = (tid + z) % IN_FILTERS;\n                    // Load values. There will probably be bank conflicts here that we can optimize in the future.\n                    var v: array<fT, 9>;\n                    v[0] = inputs[(row-1) * GROUP_LIMIT_W * IN_FILTERS + (col-1) * IN_FILTERS + c];\n                    v[3] = inputs[(row) * GROUP_LIMIT_W * IN_FILTERS + (col-1) * IN_FILTERS + c];\n                    v[6] = inputs[(row+1) * GROUP_LIMIT_W * IN_FILTERS + (col-1) * IN_FILTERS + c];\n                    v[1] = inputs[(row-1) * GROUP_LIMIT_W * IN_FILTERS + (col) * IN_FILTERS + c];\n                    v[4] = inputs[(row) * GROUP_LIMIT_W * IN_FILTERS + (col) * IN_FILTERS + c];\n                    v[7] = inputs[(row+1) * GROUP_LIMIT_W * IN_FILTERS + (col) * IN_FILTERS + c];\n                    v[2] = inputs[(row-1) * GROUP_LIMIT_W * IN_FILTERS + (col+1) * IN_FILTERS + c];\n                    v[5] = inputs[(row) * GROUP_LIMIT_W * IN_FILTERS + (col+1) * IN_FILTERS + c];\n                    v[8] = inputs[(row+1) * GROUP_LIMIT_W * IN_FILTERS + (col+1) * IN_FILTERS + c];\n\n                    // Do dots\n                    for (var i: u32 = 0; i < THREAD_DEPTH; i++) {\n                        let weightBase = centers[i].z * IN_FILTERS * KERNEL_SIZE * KERNEL_SIZE ;\n                        var w: array<fT, 9>;\n                        let off = weightBase + c * KERNEL_SIZE * KERNEL_SIZE;\n                        for (var j: u32 = 0; j < KERNEL_SIZE * KERNEL_SIZE; j++) {\n                            w[j] = weights[off + j];\n                        }\n\n                        var sum: fT = 0.0;\n                        sum += v[0] * w[0];\n                        sum += v[1] * w[1];\n                        sum += v[2] * w[2];\n                        sum += v[3] * w[3];\n                        sum += v[4] * w[4];\n                        sum += v[5] * w[5];\n                        sum += v[6] * w[6];\n                        sum += v[7] * w[7];\n                        sum += v[8] * w[8];\n                        results[i] += sum;\n                    }\n                }\n\n                // write results\n                for (var i: u32 = 0; i < GROUP_DEPTH; i++) {\n                    let x = centers[i].x + PADDING;\n                    let y = centers[i].y + PADDING;\n                    let z = centers[i].z;\n\n                    let outIdx = (tileRow + y) * (OUT_WIDTH + PADDING * 2) * OUT_FILTERS + (tileCol + x) * OUT_FILTERS + z ;\n                    if (tileRow + y < (OUT_HEIGHT - PADDING) && tileCol + x < (OUT_WIDTH - PADDING)) {\n                        outputBuffer[outIdx] = activate(results[i]);\n                    }\n                }\n            };\n        "},e}(),tA=((v={})[v.Bits16=0]="Bits16",v[v.Bits32=1]="Bits32",v[v.Vec2_Bits16=2]="Vec2_Bits16",v[v.Vec4_Bits16=3]="Vec4_Bits16",v[v.Vec2_Bits32=4]="Vec2_Bits32",v[v.Vec4_Bits32=5]="Vec4_Bits32",v);function tM(e){switch(e){case tA.Bits16:case tA.Vec2_Bits16:case tA.Vec4_Bits16:return 2;default:return 4}}function tL(e){switch(e){case tA.Bits16:case tA.Bits32:return 1;case tA.Vec2_Bits16:case tA.Vec2_Bits32:return 2;case tA.Vec4_Bits16:case tA.Vec4_Bits32:return 4}}function tD(e){return tM(e)*tL(e)}function tx(e,t,n){void 0===n&&(n=!1);var r=tD(e),i=2===tM(e)?"f16":n?"f32":"u32",o="";switch(tL(e)){case 4:o="vec4<"+i+">";break;case 2:o="vec2<"+i+">";break;default:o=i}return r===t?o:"array<"+o+", "+Math.floor(t/r)+">"}function tR(e,t,n,r,i,o,a,s,u){var c=tD(u.bufferMemoryLayout);if(1===r||t===e&&n===e)return tN(e,r,i,o,a,s,u);if(e>=u.numberThreads*c){for(var l="",f=0;f<r;f++)l+="{\n                let src_off_"+f+" = "+i+" + "+f*t+";\n                let dst_off_"+f+" = "+o+" + "+f*n+";\n                "+tN(e,1,"src_off_"+f,"dst_off_"+f,a,s,u)+"\n            }";return l}return function(e,t,n,r,i,o,a,s,u){var c,l,f,d=tD(u.bufferMemoryLayout),h=(c=tD(u.bufferMemoryLayout),{subgroupsPerLoadgroup:l=Math.ceil(e/(u.subgroupSize*c)),loadgroups:Math.floor(u.numberThreads/(u.subgroupSize*l))}),p=h.subgroupsPerLoadgroup,v=h.loadgroups,g=Math.floor(r/v),m=r%v,y="{\n";y+="let loadgroupId = i32("+u.subgroupIdName+") / "+p+";\nlet loadgroupTid = i32("+u.threadIdName+") % ("+p*u.subgroupSize+");\n"+("if (loadgroupTid < "+e/d+") {");for(var _=0;_<g;_++){var b=tO(0,0,n,g,0,"loadgroupId","loadgroupTid",0,o,_,u),E=tO(0,0,t,g,0,"loadgroupId","loadgroupTid",0,i,_,u);y+="{\n            "+b.registers+"\n            "+E.registers+"\n            "+s+b.indices+" = "+a+E.indices+";\n        }"}if(m>0){var S=tO(0,0,n,1,0,"loadgroupId","loadgroupTid",g*v*n,o,0,u),T=tO(0,0,t,1,0,"loadgroupId","loadgroupTid",g*v*t,i,0,u);y+="\n        if (loadgroupId < "+m+") {\n            "+S.registers+"\n            "+T.registers+"\n            "+s+S.indices+" = "+a+T.indices+";\n        }"}return y+"}}\n"}(e,t,n,r,i,o,a,s,u)}function tO(e,t,n,r,i,o,a,s,u,c,l){l.subgroupThreadIdName,0===r&&(l.threadIdName,l.numberThreads,l.subgroupSize);var f=l.bufferMemoryLayout,d=(tM(f),tL(f),tD(f)),h="[";return{registers:"",indices:h+="("+u+" / "+d+") + "+s/d+" + "+("("+c+" + "+r+" * "+o+") * "+n/d)+" +"+("("+a)+")]"}}function tN(e,t,n,r,i,o,a){var s=e*t,u=tD(a.bufferMemoryLayout),c=Math.floor(s/(u*a.numberThreads)),l=s%(u*a.numberThreads)/u,f="{\n";f+="let loadgroupId = 1;\n",f+="let loadgroupTid = i32("+a.threadIdName+");\n";for(var d=0;d<c;d++){var h=tO(0,a.numberThreads,u*a.numberThreads,0,0,"loadgroupId","loadgroupTid",0,r,d,a),p=tO(0,a.numberThreads,u*a.numberThreads,0,0,"loadgroupId","loadgroupTid",0,n,d,a);f+="{",f+=""+h.registers,f+=""+p.registers,f+=""+o+h.indices+" = "+i+p.indices+";",f+="}\n"}if(l>0){f+="\n              if ("+a.threadIdName+" < "+l+") {\n";var v=tO(0,0,l*u,0,0,"loadgroupId","loadgroupTid",c*u*a.numberThreads,r,0,a),g=tO(0,0,l*u,0,0,"loadgroupId","loadgroupTid",c*u*a.numberThreads,n,0,a);f+=v.registers,f+=g.registers,f+=""+o+v.indices+" = "+i+g.indices+";",f+="}"}return f+"}\n"}var tU=function(){function e(e,t,n){void 0===n&&(n=!1),this.inChannels=e,this.outChannels=t,this.hostReadableOutput=n,this._configuration=void 0,this._activation=void 0,this._weights=void 0,this._biases=void 0,this._inputs=void 0,this._outputs=void 0,this._pipeline=void 0,this._inputShape=void 0,this._outputShape=void 0}var t,n,r=e.prototype;return t=k()(P().mark(function e(t,n){var r,i,o,a,s,u,c;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.device.pushErrorScope("validation"),this._outputShape=[n.inputShape[0]-1+1,n.inputShape[1]-1+1,this.outChannels],this._inputShape=n.inputShape,r=(this._outputShape[0]+2)*(this._outputShape[1]+2)*this.outChannels,x.debug("[Conv2d_igemm_f16_Nx3x3x8]: Hidden output shape: "+this._outputShape+", size: "+r+" hostReadable "+this.hostReadableOutput),i=n.dataType===tk.F32?4:2,this._configuration=n,this._activation=n.activation,this._outputs=new tw(t,r*i,this.hostReadableOutput?tT.DeviceToHost:tT.Default),o=this._createShader(),x.debug("[Conv2d_igemm_f16_Nx3x3x8]: Shader",o),e.next=14,t.createShaderModule(o);case 14:if(s=(a=e.sent).module,!(u=a.err)&&s){e.next=19;break}return e.abrupt("return",u||new tl("Conv2d_igemm_f16_Nx3x3x8",tf.PipelineCreationFailed,"Failed to create shader module",!0));case 19:return this._pipeline=t.device.createComputePipeline({layout:"auto",compute:{module:s,entryPoint:"main"},label:"conv2d_igemm_f16_Nx3x3x8"}),e.next=22,t.device.popErrorScope();case 22:if(!(c=e.sent)){e.next=25;break}return e.abrupt("return",new tl("conv2d_igemm_f16_Nx3x3x8",tf.PipelineCreationFailed,"Failed to create compute pipeline: "+c.message,!0));case 25:case"end":return e.stop()}},e,this)})),r.configure=function(e,n){return t.apply(this,arguments)},r.setWeights=function(e){this._weights=e},r.setBiases=function(e){this._biases=e},r.setInputs=function(e){this._inputs=e},r.setQuantOffsets=function(e){},n=k()(P().mark(function e(){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._outputs);case 1:case"end":return e.stop()}},e,this)})),r.getOutputs=function(){return n.apply(this,arguments)},r.close=function(){var e;this._weights.close(),null==(e=this._biases)||e.close(),this._outputs.close()},r.createFinalizedPass=function(e,t,n){if(!(this._inputs instanceof tw))return{err:new tl("Conv2d_igemm_f16_Nx3x3x8",tf.BadParameters,"ModelLayerInput is not a Buffer",!0)};try{var r={label:"conv2d_mid_basic"},i=this._pipeline.getBindGroupLayout(0),o=[{binding:0,resource:{buffer:this._outputs.deviceBuffer}},{binding:1,resource:{buffer:this._inputs.deviceBuffer}},{binding:2,resource:{buffer:this._weights.deviceBuffer}}];this._biases&&o.push({binding:3,resource:{buffer:this._biases.deviceBuffer}});var a=e.device.createBindGroup({layout:i,entries:o});n&&(r.timestampWrites={querySet:n,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1});var s=t.beginComputePass(r);return s.setPipeline(this._pipeline),s.setBindGroup(0,a),s.dispatchWorkgroups(Math.ceil(this._outputShape[1]/16),Math.ceil(this._outputShape[0]/8),1),s.end(),{pass:s}}catch(e){return{err:new tl("Conv2d_igemm_f16_Nx3x3x8",tf.InferenceFailed,"Finalized pass failed: "+((null==e?void 0:e.message)||"unknown"),!0)}}},r._createShader=function(){var e,t=this,n=this._configuration.dataType,r="sum;";this._activation&&(r=this._activation.getWGSL("x",n)+";");var i="";this._biases&&(i="@group(0) @binding(3) var<storage, read> biases: array<fT, M * N>;");var o={bufferMemoryLayout:(e=0,tA.Vec4_Bits32),numberThreads:64,subgroupSize:32,threadIdName:"tid",subgroupThreadIdName:"wtid",subgroupIdName:"wid",subgroupSizeName:"32"},a=tD(o.bufferMemoryLayout),s=(this._inputShape[0]+2)*(this._inputShape[1]+2)*this.inChannels*2,u=this.inChannels*this.outChannels*18,c=18*this.inChannels*20,l=tL(o.bufferMemoryLayout),f=a/(2*l),d=Math.log2(l),h=Math.log2(f);return"\n        "+(this._configuration.dataType===tk.F16?"enable f16;":"")+"\n        // Load Width: 16\n        const IN_CHANNELS: i32 = "+this.inChannels+";\n        const OUT_CHANNELS: i32 = "+this.outChannels+";\n        const PACKED_IN_CHANNELS: i32 = IN_CHANNELS/2;\n        const PACKED_OUT_CHANNELS: i32 = OUT_CHANNELS/2;\n        const KERNEL_SIZE: i32 = 3;\n\n        const TILE_IN_W: i32 = 18;\n        const TILE_IN_H: i32 = 10;\n        const TILE_OUT_W: i32 = 16;\n        const TILE_OUT_H: i32 = 8;\n        const TILE_OUT_DEPTH: i32 = OUT_CHANNELS;\n        const PACKED_TILE_OUT_DEPTH: i32 = PACKED_OUT_CHANNELS;\n\n        const IN_PADDING: i32 = 1;\n        const OUT_PADDING: i32 = 1;\n\n        const IN_WIDTH: i32 = "+this._inputShape[1]+";\n        const IN_HEIGHT: i32 = "+this._inputShape[0]+";\n        const OUT_WIDTH: i32 = "+this._outputShape[1]+";\n        const OUT_HEIGHT: i32 = "+this._outputShape[0]+";\n\n        const K: i32 = IN_CHANNELS;\n\n        alias fT = "+this._configuration.dataType+";\n        @group(0) @binding(0) var<storage, read_write> outputBuffer: array<vec4<u32>, (OUT_HEIGHT + OUT_PADDING * 2) * (OUT_WIDTH + OUT_PADDING * 2)>;\n        @group(0) @binding(1) var<storage, read> inputBuffer: "+tx(o.bufferMemoryLayout,s)+";\n        @group(0) @binding(2) var<storage, read> weightsBuffer: "+tx(o.bufferMemoryLayout,u)+";\n        "+i+"\n\n        var<workgroup> S_WEIGHTS: "+tx(o.bufferMemoryLayout,u)+";\n        var<workgroup> S_ACTIVATIONS: "+tx(o.bufferMemoryLayout,c)+";\n\n        fn activate(x: fT) -> fT {\n            return "+r+";\n        }\n\n        @compute @workgroup_size(64,1,1)\n        fn main(@builtin(global_invocation_id) global_id: vec3<u32>,\n                @builtin(local_invocation_index) tid: u32,\n                @builtin(local_invocation_id) thread_id: vec3<u32>,\n                @builtin(workgroup_id) group_id: vec3<u32>) {\n\n            let tileCol: i32 = i32(group_id.x) * TILE_OUT_W;\n            let tileRow: i32 = i32(group_id.y) * TILE_OUT_H;\n            let wid: i32 = i32(tid) >> "+Math.log2(32)+";\n            let wtid: i32 = i32(tid) & 31;\n            let warpX: i32 = wid % 2;\n            let warpY: i32 = wid / 2;\n            let threadX: i32 = wtid % 8;\n            let threadY: i32 = wtid / 8;\n            \n            {\n                "+tR(u,0,0,1,"0","0","weightsBuffer","S_WEIGHTS",o)+"\n            }\n            \n            // Load activations to SMEM\n            {\n                let x: i32 = i32(group_id.x) * TILE_OUT_W;\n                let y: i32 = i32(group_id.y) * TILE_OUT_H;\n                let offsetBytes = (y * (IN_WIDTH+IN_PADDING*2) * IN_CHANNELS + x * IN_CHANNELS) * 2;\n                "+tR(18*this.inChannels*2,this.inChannels*(this._inputShape[1]+2)*2,18*this.inChannels*2,10,"offsetBytes","0","inputBuffer","S_ACTIVATIONS",o)+"\n            }\n            // Wait for memory operations to complete\n            workgroupBarrier();\n\n            var results: array<array<array<array<fT, 2>, PACKED_OUT_CHANNELS>, 1>, 2>;\n            for (var k_y: i32 = 0; k_y < 3; k_y ++) {\n            for (var k_x: i32 = 0; k_x < 3; k_x ++) {\n            for (var k: i32 = 0; k < K; k += 8) {\n                var weights: array<array<vec2<fT>, 4>, 4>;\n                var activations: array<array<array<vec2<fT>,4>, 1>, 2>;\n                "+tS(2,"\n			",function(e){return tS(1,"\n			",function(t){return"\n                    {\n                        let idx: i32 = ((k_y + (warpY * 8) + (threadY * 2) + "+e+") * TILE_IN_W * IN_CHANNELS\n                            + (k_x + (warpX * 8) + (threadX * 1) + "+t+") * IN_CHANNELS\n                            + k) >> "+(h+d)+";\n                        let value = S_ACTIVATIONS[idx];\n                        "+tS(l,"\n",function(n){return"activations["+e+"]["+t+"]["+n+"] = vec2<f16>(unpack2x16float(value["+n+"]));"})+"\n                    }"})})+"\n                                \n                "+tS(this.outChannels/4,"",function(e){var n=4*e;return"\n                    {\n                        let idx: i32 = (k_y * KERNEL_SIZE * IN_CHANNELS + k_x * IN_CHANNELS + k) >> "+(h+d)+";\n                        var values: array<vec4<u32>, 4>;\n                        "+tS(4,"\n",function(e){return"values["+e+"] = S_WEIGHTS["+(3*(n+e)*3*t.inChannels>>h+d)+" + idx];"})+"\n                        "+tS(4,"\n			",function(e){return"\n                        {\n                            "+tS(l,"\n			",function(t){return"weights["+e+"]["+t+"] = vec2<f16>(unpack2x16float(values["+e+"]["+t+"]));"})+"\n                        }"})+"\n                    }\n                    "+tS(2,"\n				",function(e){return tS(1,"\n				",function(t){return tS(4,"\n				",function(r){var i=r%2;return tS(8,"\n				",function(o){var a=Math.floor(o/2),s=o%2,u="results["+e+"]["+t+"]["+Math.floor((r+n)/2)+"]["+i+"]";return u+" = fma(activations["+e+"]["+t+"]["+a+"]["+s+"], weights["+r+"]["+a+"]["+s+"], "+u+");"})})})})})+" // loop c_o\n            } // for (var k = ...)\n            } // for (var k_x = ...)\n            } // for (var k_y = ...)\n            // OK we now have all of our output channels for this pixel. Write to VRAM.\n            "+tS(2,"\n			",function(e){return tS(1,"\n			",function(n){return"\n            {\n                var x: vec4<u32>;\n                "+tS(t.outChannels/2,"",function(t){return"\n                    results["+e+"]["+n+"]["+t+"][0] = activate(results["+e+"]["+n+"]["+t+"][0]);\n                    results["+e+"]["+n+"]["+t+"][1] = activate(results["+e+"]["+n+"]["+t+"][1]);\n                    "})+"\n                "+tS(t.outChannels/2,"",function(t){return"\n                    x["+t+"] = pack2x16float(vec2<f32>(f32(results["+e+"]["+n+"]["+t+"][0]),\n                                f32(results["+e+"]["+n+"]["+t+"][1])));\n                    "})+"\n                let idx: i32 = (tileRow + OUT_PADDING + (warpY * 8) + (threadY * 2) + "+e+") * (OUT_WIDTH + OUT_PADDING * 2)\n                            + (tileCol + OUT_PADDING + (warpX * 8) + (threadX * 1) + "+n+"); \n                outputBuffer[idx] = x;\n            }"})})+"\n        };\n        "},e}(),tF=function(){function e(e,t,n,r,i){void 0===i&&(i=!1),this.inFeatures=e,this.outFeatures=t,this.kernelSize=n,this.inPadding=r,this.hostReadableOutput=i,this._configuration=void 0,this._activation=void 0,this._weights=void 0,this._biases=void 0,this._inputs=void 0,this._lrImage=void 0,this._outputs=void 0,this._pipeline=void 0,this._inputShape=void 0,this._outputShape=void 0,this._sampler=void 0,this._storageFormat=void 0}var t,n,r=e.prototype;return t=k()(P().mark(function e(t,n){var r,i,o,a,s,u;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.device.pushErrorScope("validation"),r=Math.floor((this.kernelSize-1)/2),this._outputShape=[n.inputShape[0]-r+this.inPadding,n.inputShape[1]-r+this.inPadding,this.outFeatures],this._storageFormat=t.storageFormat,this._inputShape=n.inputShape,this._configuration=n,this._activation=n.activation,this._outputs=new tC(t,this._outputShape[1],this._outputShape[0],this._storageFormat,this.hostReadableOutput?tT.DeviceToHost:tT.Default),i=this._createShader(n.expectedInputType),this._sampler=t.device.createSampler({magFilter:"linear",minFilter:"linear"}),e.next=12,t.createShaderModule(i);case 12:if(a=(o=e.sent).module,!(s=o.err)&&a){e.next=17;break}return e.abrupt("return",s||new tl("Conv2d_Exit_ChromaCombine",tf.ShaderCompilationFailed,"Failed to create shader module",!0));case 17:return this._pipeline=t.device.createComputePipeline({layout:"auto",compute:{module:a,entryPoint:"main"},label:"conv2d_entry_upscale"}),e.next=20,t.device.popErrorScope();case 20:(u=e.sent)&&new tl("Conv2d_Exit_ChromaCombine",tf.PipelineCreationFailed,"Failed to create compute pipeline: "+u.message,!0);case 22:case"end":return e.stop()}},e,this)})),r.configure=function(e,n){return t.apply(this,arguments)},r.setWeights=function(e){this._weights=e},r.setBiases=function(e){this._biases=e},r.setInputs=function(e){this._inputs=e},r.setQuantOffsets=function(e){},n=k()(P().mark(function e(){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._outputs);case 1:case"end":return e.stop()}},e,this)})),r.getOutputs=function(){return n.apply(this,arguments)},r.setLowResTexture=function(e){this._lrImage=e},r.close=function(){var e;this._weights.close(),null==(e=this._biases)||e.close(),this._outputs.close()},r.createFinalizedPass=function(e,t,n){if(!(this._inputs instanceof tw))return{err:new tl("Conv2d_Exit_ChromaCombine",tf.BadParameters,"ModelLayerInput is not a Buffer",!0)};try{var r,i={label:"conv2d_exit"};if(this._lrImage instanceof GPUTexture)r=this._lrImage.createView();else if(this._lrImage instanceof VideoFrame)r=e.device.importExternalTexture({source:this._lrImage});else{if(!(this._lrImage instanceof GPUExternalTexture))return{err:new tl("Conv2d_Exit_ChromaCombine",tf.BadParameters,"Input is not one of GPUTexture, VideoFrame, GPUExternalTexture",!0)};r=this._lrImage}var o=this._pipeline.getBindGroupLayout(0),a=[{binding:0,resource:this._outputs.deviceTexture.createView()},{binding:1,resource:{buffer:this._inputs.deviceBuffer}},{binding:2,resource:{buffer:this._weights.deviceBuffer}},{binding:3,resource:r},{binding:4,resource:this._sampler}];this._biases&&a.push({binding:3,resource:{buffer:this._biases.deviceBuffer}});var s=e.device.createBindGroup({layout:o,entries:a});n&&(i.timestampWrites={querySet:n,beginningOfPassWriteIndex:0,endOfPassWriteIndex:1});var u=t.beginComputePass(i);return u.setPipeline(this._pipeline),u.setBindGroup(0,s),u.dispatchWorkgroups(Math.ceil(this._outputShape[1]/16),Math.ceil(this._outputShape[0]/16),1),u.end(),{pass:u}}catch(e){return{err:new tl("Conv2d_Exit_ChromaCombine",tf.InferenceFailed,"Failed to create finalized pass: "+((null==e?void 0:e.message)||"unknown"),!0)}}},r._createShader=function(e){var t=e===tE.External?"texture_external":"texture_2d<fT>",n=this._configuration.dataType;this._activation&&this._activation.getWGSL("sum",n);var r="";return this._biases&&(r="@group(0) @binding(5) var<storage, read> biases: array<fT, M * N>;"),"\n            "+(this._configuration.dataType===tk.F16?"enable f16;":"")+"\n\n            const OUT_FEATURES: u32 = "+this.outFeatures+";\n            const OUT_WIDTH: u32 = "+this._outputShape[1]+";\n            const OUT_HEIGHT: u32 = "+this._outputShape[0]+";\n            const IN_WIDTH: u32 = "+this._inputShape[1]+";\n            const IN_HEIGHT: u32 = "+this._inputShape[0]+";\n            const IN_FEATURES: u32 = "+this.inFeatures+";\n            const IN_PADDING: u32 = "+this.inPadding+";\n            const KERNEL_SIZE: u32 = "+this.kernelSize+";\n            const GROUP_SIDE: u32 = 16;\n            const GROUP_THREADS: u32 = GROUP_SIDE * GROUP_SIDE;\n\n            alias fT = "+this._configuration.dataType+";\n            @group(0) @binding(0) var outputTexture: texture_storage_2d<"+this._storageFormat+", write>;\n            @group(0) @binding(1) var<storage, read> inputBuffer: array<fT, (IN_HEIGHT + IN_PADDING * 2) * (IN_WIDTH + IN_PADDING * 2) * IN_FEATURES>;\n            @group(0) @binding(2) var<storage, read> weightsBuffer: array<fT, OUT_FEATURES * IN_FEATURES * KERNEL_SIZE * KERNEL_SIZE>;\n            @group(0) @binding(3) var lrTexture: "+t+";\n            @group(0) @binding(4) var inputSampler: sampler;\n            "+r+"\n            const Y_COEF = vec3<fT>(0.299, 0.587, 0.114);\n            fn rgbToYuv(x: vec3<f32>) -> vec3<f32> {\n                let y = dot(x, vec3<f32>(Y_COEF));\n                return vec3<f32>(\n                    y, 0.493*(x.b-y), 0.877*(x.r-y)\n                );\n            }\n\n            fn yuvToRgb(x: vec3<f32>) -> vec3<f32> {\n                return vec3<f32>(\n                    x.x + 1.0 / 0.877 * x.z,\n                    x.x - 0.39393 * x.y - 0.58081 * x.z,\n                    x.x + 1.0 / 0.493 * x.y\n                );\n            }\n\n            @compute @workgroup_size(GROUP_THREADS,1,1)\n            fn main(@builtin(global_invocation_id) global_id: vec3<u32>,\n                    @builtin(local_invocation_index) tid: u32,\n                    @builtin(workgroup_id) group_id: vec3<u32>) {\n                let cRow = group_id.y * GROUP_SIDE + tid / GROUP_SIDE;\n                let cCol = group_id.x * GROUP_SIDE + (tid % GROUP_SIDE);\n\n                // TODO: Optimize. First, load these into workgroup memory.\n                // assuming symmetric odd-numbered kernel size\n                var inputs: array<fT, KERNEL_SIZE * KERNEL_SIZE * IN_FEATURES>;\n                let off: u32 = (KERNEL_SIZE-1)/2;\n\n                for (var m: u32 = 0; m < KERNEL_SIZE; m++) {\n                    for (var n: u32 = 0; n < KERNEL_SIZE; n++) {\n                        for (var c: u32 = 0; c < IN_FEATURES; c++) {\n                            let in_idx = (cRow + n - off + IN_PADDING) * (IN_WIDTH + IN_PADDING * 2) * IN_FEATURES + (cCol + m - off + IN_PADDING) * IN_FEATURES + c;\n                            inputs[n * KERNEL_SIZE * IN_FEATURES + m * IN_FEATURES + c] = inputBuffer[in_idx];\n                        }\n                    }\n                }\n\n                // Should probably change the order of these loops to better map to channel ordering\n                // Also move weights loading into workgroup memory...\n                var color = vec4<f32>(0.0, 0.0, 0.0, 1.0);\n                for (var z: u32 = 0; z < OUT_FEATURES; z++) {\n                    var sum: fT = 0.0;\n                    for (var j: u32 = 0; j < IN_FEATURES; j++) {\n                        var weights: array<fT, KERNEL_SIZE * KERNEL_SIZE>;\n                        for (var m: u32 = 0; m < KERNEL_SIZE; m++) {\n                            for (var n: u32 = 0; n < KERNEL_SIZE; n++) {\n                                var weights_off = z * IN_FEATURES * KERNEL_SIZE * KERNEL_SIZE + m * KERNEL_SIZE * IN_FEATURES + n * IN_FEATURES + j;\n                                weights[m * KERNEL_SIZE + n] = weightsBuffer[weights_off];\n                            }\n                        }\n                        {\n                            {\n                                sum += inputs[0 * KERNEL_SIZE * IN_FEATURES + 0 * IN_FEATURES + j] * weights[0 * KERNEL_SIZE + 0];\n                                sum += inputs[0 * KERNEL_SIZE * IN_FEATURES + 1 * IN_FEATURES + j] * weights[0 * KERNEL_SIZE + 1];\n                                sum += inputs[0 * KERNEL_SIZE * IN_FEATURES + 2 * IN_FEATURES + j] * weights[0 * KERNEL_SIZE + 2];\n                            }\n                            {\n                                sum += inputs[1 * KERNEL_SIZE * IN_FEATURES + 0 * IN_FEATURES + j] * weights[1 * KERNEL_SIZE + 0];\n                                sum += inputs[1 * KERNEL_SIZE * IN_FEATURES + 1 * IN_FEATURES + j] * weights[1 * KERNEL_SIZE + 1];\n                                sum += inputs[1 * KERNEL_SIZE * IN_FEATURES + 2 * IN_FEATURES + j] * weights[1 * KERNEL_SIZE + 2];\n                            }\n                            {\n                                sum += inputs[2 * KERNEL_SIZE * IN_FEATURES + 0 * IN_FEATURES + j] * weights[2 * KERNEL_SIZE + 0];\n                                sum += inputs[2 * KERNEL_SIZE * IN_FEATURES + 1 * IN_FEATURES + j] * weights[2 * KERNEL_SIZE + 1];\n                                sum += inputs[2 * KERNEL_SIZE * IN_FEATURES + 2 * IN_FEATURES + j] * weights[2 * KERNEL_SIZE + 2];\n                            }\n                        }\n                    }\n                    color[z] = clamp(f32(sum), 0.0627, 1.0-0.0627);\n                }\n\n                let texSize = vec2<f32>(f32(OUT_WIDTH), f32(OUT_HEIGHT));\n                let texelSize = 1.0 / texSize;\n                let inPos = vec2<f32>(f32(cCol+1), f32(cRow)) * texelSize;\n                let lr = rgbToYuv(textureSampleBaseClampToEdge(lrTexture, inputSampler, inPos).rgb * 0.8627 + 0.0627);\n                let mixval: f32 = f32(cCol > 3) * f32(cRow > 3) * f32(cCol < OUT_WIDTH - 3) * f32(cRow < OUT_HEIGHT - 3);\n                color.x = mix(lr.x, color.x, mixval);\n                color = vec4((yuvToRgb(vec3<f32>(color.x, lr.y, lr.z)) * 1.1591) - 0.0627, 1.0);\n                textureStore(outputTexture, vec2<u32>(cCol, cRow), color);\n            };\n        "},e}(),tB=function(){function e(e){this.a=e}var t=e.prototype;return t.activationsPerFeature=function(){return 1},t.getWGSL=function(e){return this.a+" * "+e+" + (1 - "+this.a+") * max(0, "+e+")"},e}();function tV(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return tG(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tG(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function tG(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var tH=function(){function e(e,t,n){this.config=e,this.gpuContext=t,this.onError=n,this.entry=void 0,this.exit=void 0,this.hidden=[],this.timingInfoEntry=void 0,this.timingInfoExit=void 0,this.timingQueryEntry=void 0,this.timingQueryExit=void 0,this.weightsMap=void 0,this.weightsBinary=void 0,this.width=0,this.height=0,this.initialized=!1,this.initializing=!1,this.MIN_AREA=0,this.MAX_AREA=0,this.SCALE_FACTOR=0,this.models={},x.info("[ModelIVSEN]: Config",this.config)}var t,n,r,i,o,a,s=e.prototype;return s.capabilities=function(){return Object.values(this.models).map(function(e){var t=e.config;return{id:t.id,heightFrom:t.height,widthFrom:t.width,heightTo:t.height*t.scaleFactor,widthTo:t.width*t.scaleFactor,framerateFrom:t.framerate,scoreModifier:t.scoreModifier,encoder:t.encoder,codec:t.codec}})},s.addModel=function(e,t){x.log("Added "+e.id+" model",e,t),this.models[e.id]={config:e,params:t}},s.trySetActiveModel=function(e){var t=this.models[e];return!!t&&(this.MIN_AREA=t.config.width*t.config.height,this.MAX_AREA=this.MIN_AREA,this.SCALE_FACTOR=t.config.scaleFactor,this.weightsMap=t.params.weightsMap,this.weightsBinary=t.params.weightsBinary,!0)},t=k()(P().mark(function e(){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return x.info("[ModelIVSEN]: Initializing"),this.initialized=!1,this.initializing=!1,this.entry=void 0,this.exit=void 0,this.width=0,this.height=0,x.info("[ModelIVSEN]: Init complete",this.models),e.abrupt("return",void 0);case 9:case"end":return e.stop()}},e,this)})),s.init=function(){return t.apply(this,arguments)},n=k()(P().mark(function e(t,n){var r,i,o,a,s,u,c,l,f,d,h,p,v,g,m,y,_,b,E,S,T,w=this;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.initializing){e.next=2;break}return e.abrupt("return",void 0);case 2:if(this.trySetActiveModel(n.pipelineId)){e.next=4;break}return e.abrupt("return",void 0);case 4:if(r=t instanceof VideoFrame?t.displayWidth:t.width,i=t instanceof VideoFrame?t.displayHeight:t.height,!((o=r*i)<this.MIN_AREA||o>this.MAX_AREA)){e.next=11;break}return this.initialized=!1,this.initializing=!1,e.abrupt("return",void 0);case 11:if(r===this.width&&i===this.height||(this.initialized=!1),this.initialized){e.next=15;break}return this.reinit(r,i),e.abrupt("return",void 0);case 15:for(this.gpuContext.device.pushErrorScope("validation"),a=this.gpuContext.device.createCommandEncoder(),this.entry&&(this.entry.setInputs(t),this.entry.createFinalizedPass(this.gpuContext,a,this.timingQueryEntry),this.timingInfoEntry&&this.timingQueryEntry&&a.resolveQuerySet(this.timingQueryEntry,0,2,this.timingInfoEntry.deviceBuffer,0)),s=tV(this.hidden);!(u=s()).done;)(c=u.value).layer&&c.layer.createFinalizedPass(this.gpuContext,a,c.timingQuery),c.timingQuery&&c.timingInfo&&a.resolveQuerySet(c.timingQuery,0,2,c.timingInfo.deviceBuffer,0);return this.exit&&(this.exit.setLowResTexture(t),this.exit.createFinalizedPass(this.gpuContext,a,this.timingQueryExit),this.timingInfoExit&&this.timingQueryExit&&a.resolveQuerySet(this.timingQueryExit,0,2,this.timingInfoExit.deviceBuffer,0)),this.gpuContext.queue.submit([a.finish()]),e.prev=21,e.next=24,this.gpuContext.queue.onSubmittedWorkDone();case 24:e.next=30;break;case 26:return e.prev=26,e.t0=e.catch(21),this.handleError(new tl("ModelIVSEN",tf.InferenceFailed,null!=(l=null==e.t0?void 0:e.t0.message)?l:"Unknown error",!0)),e.abrupt("return",void 0);case 30:if(!this.timingInfoEntry){e.next=40;break}return e.next=33,this.timingInfoEntry.copyToHost(this.gpuContext.device);case 33:if(d=(f=e.sent).err,h=f.buffer,!d){e.next=39;break}return this.handleError(d),e.abrupt("return");case 39:x.debug("[ModelIVSEN]: entry timing="+tW(h));case 40:p=tV(this.hidden);case 41:if((v=p()).done){e.next=55;break}if(!(g=v.value).timingInfo){e.next=53;break}return e.next=46,g.timingInfo.copyToHost(this.gpuContext.device);case 46:if(y=(m=e.sent).err,_=m.buffer,!y){e.next=52;break}return this.handleError(y),e.abrupt("return");case 52:x.debug("[ModelIVSEN]: hidden["+g.idx+"] timing="+tW(_));case 53:e.next=41;break;case 55:if(!this.timingInfoExit){e.next=65;break}return e.next=58,this.timingInfoExit.copyToHost(this.gpuContext.device);case 58:if(E=(b=e.sent).err,S=b.buffer,!E){e.next=64;break}return this.handleError(E),e.abrupt("return");case 64:x.debug("[ModelIVSEN]: exit timing="+tW(S));case 65:if(this.gpuContext.device.popErrorScope().then(function(e){var t;e&&w.handleError(new tl("ModelIVSEN",tf.InferenceFailed,null!=(t=null==e?void 0:e.message)?t:"Unknown error",!0))}).catch(function(e){var t;w.handleError(new tl("ModelIVSEN",tf.InferenceFailed,null!=(t=null==e?void 0:e.message)?t:"Unknown error",!0))}),this.exit){e.next=69;break}return x.warn(["ModelIVSEN: Exit layer does not exist, cant return texture"]),e.abrupt("return",void 0);case 69:return e.next=71,this.exit.getOutputs();case 71:if((T=e.sent)instanceof tC){e.next=76;break}return this.initialized=!1,x.warn(["ModelIVSEN: Exit layer did not return a texture"]),e.abrupt("return",void 0);case 76:return e.abrupt("return",T.deviceTexture);case 77:case"end":return e.stop()}},e,this,[[21,26]])})),s.infer=function(e,t){return n.apply(this,arguments)},r=k()(P().mark(function e(t,n){var r,i,o,a,s,u,c,l,f,d,h,p,v,g,m,y,_;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.weightsBinary,i=this.weightsMap,r&&i){e.next=4;break}return e.abrupt("return",void 0);case 4:return this.initializing=!0,this.cleanup(),e.next=8,this.configureEntrypoint(t,n,this.SCALE_FACTOR,1,16,r,i);case 8:if(a=(o=e.sent).err,s=o.entry,!a&&s){e.next=14;break}return this.handleError(a||new tl("Model",tf.PipelineCreationFailed,"Failed to create entry layer",!0)),e.abrupt("return");case 14:this.entry=s,this.hidden=[],u=0;case 17:if(!(u<4)){e.next=42;break}if(c=void 0,l=8,0!==u){e.next=27;break}return e.next=23,this.entry.getOutputs();case 23:c=e.sent,l=16,e.next=30;break;case 27:return e.next=29,this.hidden[u-1].layer.getOutputs();case 29:c=e.sent;case 30:return e.next=32,this.configureMid(Math.ceil(t*this.SCALE_FACTOR),Math.ceil(n*this.SCALE_FACTOR),l,8,r,i,c,2*u);case 32:if(d=(f=e.sent).err,h=f.layer){e.next=38;break}return this.handleError(d||new tl("Model",tf.PipelineCreationFailed,"Failed to create midlayer",!0)),e.abrupt("return");case 38:this.hidden.push({layer:h,timingInfo:null,timingQuery:null,idx:u});case 39:u++,e.next=17;break;case 42:return e.next=44,this.configureExit(Math.ceil(t*this.SCALE_FACTOR),Math.ceil(n*this.SCALE_FACTOR),8,1,r,i);case 44:if(v=(p=e.sent).err,g=p.exit,!v&&g){e.next=50;break}return this.handleError(v||new tl("Model",tf.PipelineCreationFailed,"Failed to create exit layer",!0)),e.abrupt("return");case 50:if(this.exit=g,this.gpuContext.timingInfoEnabled){for(this.timingInfoEntry=new tw(this.gpuContext,16,tT.TimingQuery),m=tV(this.hidden);!(y=m()).done;)(_=y.value).timingInfo=new tw(this.gpuContext,16,tT.TimingQuery),_.timingQuery=this.gpuContext.device.createQuerySet({type:"timestamp",count:2});this.timingInfoExit=new tw(this.gpuContext,16,tT.TimingQuery),this.timingQueryEntry=this.gpuContext.device.createQuerySet({type:"timestamp",count:2}),this.timingQueryExit=this.gpuContext.device.createQuerySet({type:"timestamp",count:2})}this.width=t,this.height=n,this.initializing=!1,this.initialized=!0;case 56:case"end":return e.stop()}},e,this)})),s.reinit=function(e,t){return r.apply(this,arguments)},s.cleanup=function(){var e,t,n,r;null==(e=this.exit)||e.close();for(var i,o=tV(this.hidden);!(i=o()).done;)i.value.layer.close();null==(t=this.entry)||t.close(),null==(n=this.timingInfoEntry)||n.close(),null==(r=this.timingInfoExit)||r.close()},i=k()(P().mark(function e(t,n,r,i,o,a,s){var u,c,l,f,d,h,p;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return u=new tI(i,o,3,r,1,!0,!1),l=(c=s["init_feat.0"].weight).bits/8,f=a.slice(c.offset,c.offset+c.count*l),d={inputShape:[n,t,i],weightShape:[3,3,o*i],bias:!1,dataType:4===l?tk.F32:tk.F16,expectedInputType:tE.External,activation:new tB(.1),loadWidthBytes:this.config.loadWidthBytes},h=new tw(this.gpuContext,9*i*o*l,tT.HostToDevice),e.next=8,h.copyToDevice(this.gpuContext,f);case 8:return u.setWeights(h),e.next=11,u.configure(this.gpuContext,d);case 11:if(!(p=e.sent)){e.next=14;break}return e.abrupt("return",{err:p});case 14:return e.abrupt("return",{entry:u});case 15:case"end":return e.stop()}},e,this)})),s.configureEntrypoint=function(e,t,n,r,o,a,s){return i.apply(this,arguments)},o=k()(P().mark(function e(t,n,r,i,o,a,s,u){var c,l,f,d,h,p,v;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=(c=a["bottleneck."+u].weight).bits/8,f=o.slice(c.offset,c.offset+c.count*l),d=4===l?new tP(r,i,!1):new tU(r,i,!1),h={inputShape:[n,t,r],weightShape:[3,3,i*r],bias:!1,dataType:4===l?tk.F32:tk.F16,expectedInputType:tE.Buffer,activation:new tB(.1),loadWidthBytes:this.config.loadWidthBytes},p=new tw(this.gpuContext,9*r*i*l,tT.HostToDevice),e.next=8,p.copyToDevice(this.gpuContext,f);case 8:return d.setInputs(s),d.setWeights(p),e.next=12,d.configure(this.gpuContext,h);case 12:if(!(v=e.sent)){e.next=15;break}return e.abrupt("return",{err:v});case 15:return e.abrupt("return",{layer:d});case 16:case"end":return e.stop()}},e,this)})),s.configureMid=function(e,t,n,r,i,a,s,u){return o.apply(this,arguments)},a=k()(P().mark(function e(t,n,r,i,o,a){var s,u,c,l,f,d,h,p=this;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=new tF(r,i,3,1,!1),c=(u=a.reconstruct.weight).bits/8,l=o.slice(u.offset,u.offset+u.count*c),f={inputShape:[n,t,r],weightShape:[3,3,i*r],bias:!1,dataType:4===c?tk.F32:tk.F16,expectedInputType:tE.External,activation:new tB(.1),loadWidthBytes:this.config.loadWidthBytes},d=new tw(this.gpuContext,9*r*i*c,tT.HostToDevice),e.next=8,d.copyToDevice(this.gpuContext,l);case 8:return this.hidden[this.hidden.length-1].layer.getOutputs().then(function(e){return s.setInputs(e)}).catch(function(e){var t;p.handleError(new tl("Model",tf.BadParameters,null!=(t=null==e?void 0:e.message)?t:"Failed to access hidden layer",!0))}),s.setWeights(d),e.next=12,s.configure(this.gpuContext,f);case 12:if(!(h=e.sent)){e.next=15;break}return e.abrupt("return",{err:h});case 15:return e.abrupt("return",{exit:s});case 16:case"end":return e.stop()}},e,this)})),s.configureExit=function(e,t,n,r,i,o){return a.apply(this,arguments)},s.handleError=function(e){this.initializing=!1,this.initialized=!1,this.onError(e)},e}(),tW=function(e){if(!e)return x.warn("[ModelIVSEN]: timingInfo buffer is undefined"),0;var t=0;try{var n=new BigInt64Array(e);t=Number(n[1]-n[0])/1e9}catch(e){x.warn("[ModelIVSEN': Failed to get seconds from timingInfo")}return t},tj={"init_feat.0":{weight:{offset:0,bits:16,count:144}},"bottleneck.0":{weight:{offset:288,bits:16,count:1152}},"bottleneck.2":{weight:{offset:2592,bits:16,count:576}},"bottleneck.4":{weight:{offset:3744,bits:16,count:576}},"bottleneck.6":{weight:{offset:4896,bits:16,count:576}},reconstruct:{weight:{offset:6048,bits:16,count:72}}},tz=function(e){function t(t,n,r){var i;return(i=e.call(this,"SuperResolutionTransformer",r)||this).config=t,i.gpuContext=n,i.listeners=r,i.model=void 0,i.model=new tH(t,n,i.listeners.error),i}ec()(t,e);var n,r,i=t.prototype;return n=k()(P().mark(function e(){var t,n,r,i,o=this;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=this.loadLocalModelParams()).result,!(r=t.err)){e.next=3;break}return e.abrupt("return",r);case 3:return e.next=5,this.model.init();case 5:if(!(i=e.sent)){e.next=8;break}return e.abrupt("return",i);case 8:this.config.models.forEach(function(e){"local"===e.path&&n&&o.model.addModel(e,n)}),this.listeners.capabilities(this.capabilties());case 10:case"end":return e.stop()}},e,this)})),i.init=function(){return n.apply(this,arguments)},r=k()(P().mark(function e(t,n){return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.model.infer(t,n);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),this.listeners.error(new tl("SuperResolutionTransformer",tf.InferenceFailed,"Unhandled exception "+(null==e.t0?void 0:e.t0.message),!0)),e.abrupt("return",void 0);case 10:case"end":return e.stop()}},e,this,[[0,6]])})),i.transformFn=function(e,t){return r.apply(this,arguments)},i.loadLocalModelParams=function(){var e=function(){try{for(var e=atob("SKM6JcKhrbrmQFkvoDrqwEewEbtDQuM5fjvbw7C5eLDFO1crj7gZQkkzGTp0wwO0nLAOqdqsKi6aufS2Db7bQTGyWKAQsQ4wNrqdQV+4abBixRhBajkrOKS5V6+aLDIfyUDLwOGtdq4qL/mkAbK7L5YzyzurvaW9cjicOEwzJKLuOx8z6DzvwJI6LjP3u3swZrjXNE2xjMALP7K0VixKts6gVLWVOTnBFzSzOY48OCgMtwa8JLkwM2IkLCqlQIg9WLmqPEmoRD68wlxAdrwOQVG/kbh+MlAsTqlXOhIxcEBmwk26ILn/OAcyHqysLNaqYzL0w001gbHKQy21FyoYOqG6nK2Dw4JDn6kPM5eyjLR1MW2tX7juw+o/YjWBPx24gcG3sXm+wbRJPCa2DEAJugO8uiY4M70xZzIGtXM8jLQyRmK4erh0OHarij0YvwOz+r54srOvFreoLRkwKUBNPRS+ozM6Nma45bShvZi6rbQXvkOwHriTuK88wrVrtEotnLQBQKnANzSaxL/BBb0LumayPqBmPFm8cSo2vDE94r+7OOjAGr60w+TC0bk4vGWncke9Oay8L7XaOF5CbrK5wZS0L7O4PWG0zrlKOPi25D++xzk5IbntqAK4QbgVOgy5ejyeu3o6VDQdN3U+0rQKuFa+0sHoOzE3dbh7vqk65sQkwGE+iroFLi8xJrwCO405U0iGPMe/4D1SuDO1GTzSPAk3LbM7uqO47DzaPSU8Irt2xys8OD1cOqS9jTfJuJbA6Tsju0yvQLVQPLE1cjaSsoQot7tbOh01hbdzvk4wvsBeQhY/csByQM+z4754vE6/jkASvRm/jLsWtbw95zygvAm84Ll6PI62bkBHPb2yJ778PeK84jv9ucq72r/KuFW1KDlMt3o7nsEPs2SwFbv8PJlAXD/EplQ9KTvcLfg6MChsPWawwsJUPUY0pTTwufI+8bhKOpjALiJ2Or48wL4etZJAEsC/Ql8uv75iw6LCbT01xaM7S75fvDg4FMGAuOooIrY4upyhWrzzPAoyNrNeOB44sEGLPNe4OrdduwutaD/WPdU8jzAVQNm/ib1vN3e8Hr8xwaI31L9KPdU4n8S9uzCzC7hGtuO9MsNFPqM7/bZeyS5Baj0XuoXEQLZJvb6+k7xmNXqsrrATphwtMLyPOuBAzT2gtWU1HrSoN/M41LnvRCo8RsKespQ+G8EKQEs5VriPPou74TrkPBvCMrwytQa9lbvTOCI9ijlPITrANzAXP3S4djYTK8I8ILzeuAytNrzoMsc7XLlBOdQ8NjX0reM42T9AwSs9173bunrBXj38xDa/Vjy2wDXCAUBqvzu+1cJsxPXAo8NxNns/lyrjQOhAJjGeK3q5sL+Dulo+EjyVOMk/kLQ/OqmxtaiQQHC6cC1nvRU7E0EbvIa9m7HyuKa8fUJ7r2+8ij92Oow77LMsN9A/YCxWPGxAeTV3NA43F7jbvJ+9HT5UwDs/NT4GvvU6NDWrubS4kDsCO8w0E7pOPuS4cTtxNR6z1azesmy8Y0EJOvy9mrQSOOAzZa3uNY4v2Dl9NzY3RzwbsLG/gbh9vY0/Ar4sOQI6yL3hNB6527wPtSSxAbUbObU6GL23OWA+ELoxuLe6qjR2upK72Dt6wgc9UbJaOMg65jdktJwzwigHuYi0tjuyvDI9z71dMIK8iTeuOTIzbb9AOxw6DTgFvMW8nTkxuCi7iT02JEy/ZEQZt1G8OS2ls449aj77vC08GKQJOJ28HjI6skI1PDe5uGA5tzCIsOm7uLv5sbu4cjVpp+8xxLn+t8ewUz2IMsgwI7NlMxY0mTvYqEE4LLGxvBW6+sOqPfLB9DYJuZempz4bMnm+XbexJKM3Xrr6Pb85K7c0sgypxrkquj0x9TVYyTc9YjslPga7HTW5uFExWUB3OSK5IbgcOEyvEj2QODIz0TlMHjc1ObzDu4Syva5kQnSwxrT2NQ27Qzt0uUGp6zZEM78noK3HOVk8VjwzOLK4zKqgPtw7cLxVxIkuTrvBuE++5bhDu8g/iDIDLvdCGj5OuQc9orw7u/g87cGKvNKmG7w2uiy8h8I9OGw6OToivZS4msCbv1PCwb2TvdLBxyuTuq02DbE1QG02Drzyv5BDLDjNuthAt0MLOPM9RryiwADA2LjsvSK4ortBwFTBhbm2u9a9ETzxsygn0bEUuRM198EFHIW1zrgCvIW3HkBzMMXAozzOsNO1zTbkL7pBvbsoP545Uz8cPT68BD/4t4e5yj11OYUwGDlWN7Uv9rWivqu5BDZ4wFy9CsMUweA/j7musnU5ZrTTuVs8Cz6FvEO1FjxSsPQ5ccAARKZAhsRmQhc59rz8wSCwuESvw5g+rUMIPQO1pUCStRHFWbisuLq4uTdDOe+tzrQwpr2877U8wDo9sbDPPKIyBLmjrN024Dx/P7K+xr+wtjW9l7tdPo5BAT8uM0A0dz/usKC/OcHDvHY2PTomQJ08QMFXpkS4PMDiwG4xlMAiPP6+1TTzPvnAK73Ev5+/VkIMyLM3XjtawzU6ezTsPvbA6zwMwDoqNDfVuhW12DO6Nag57jAvrCm4wzmNOPa9T6h2tPu86L/eN184dMWRQGu4vzwiPXy+Lbv0wc6uA7Xiuh2++7zOQPuu6L4Bveg22Lp+Nec4sb3pQWbB1rt+sUTCUb0xO+RC5DRHuLw8ZqZSu7a5NzWZtBG7TDefuqSz571tuPUokT5ftBE4HrxZNnk3j7uaNTI4D0G9uia++iduOuPC5b1BqljBwLsvOoK3VD1ivgQ5aL8gwGq1vzyHtuI8ZL6iugS8UbQaO3zDmsV2uDQspL5/PnVGdsEetym67zdJwlm65z7/sK0oO8MvvO69X8LsPJ+6LsZRP5s5GrwNRF++X8cFNFy5TrVpt9O05LL9sra9Ej71t2I9QjT3NP0/OL42uR+6rbAdvZ1B4DzNPCo+77kgunG5RUGOOEWkGr8KNZu+JK7xtMm9EDhRPprCD0BDMiy10rRPtgO39De3vqooTLy3P445cLwIPY8z58NgOJo/QsDpuse3UzefOLa9lbrtNfYx8r4TwBC12z8VQZWwNz8QuJa6qsFZs5e8s8DLNzO/MLtNQqDB5j7GtuO7VT1Dv5Q9B8JGuuI2O7pouOa5niIftxI7mLJgvQm45Tu8Pv+srTijQa0y9SylJjQ9qDUINSG40rS7OXy4Hr5QPFW4+7x5PY88KUFCNGZCHTR/PmZBvb9ItQM9l8H9vKOzY8J7PYLB2UDbNCs/Hr05QQlANj2jtZS9Vz4wvWw86zz3Ob8uq8FtssW92jOJubq/7iXirvs6Tb4ZOQu4/sBxwDY52L7sPwdEWjkcv1+2WrkpPAi9sTRVNL88K7+gwgQ5QDXZMmI5y735QMs36zvluIu7fr18uL+xSi0RutRCC7QCxIQ0WzQQvka/mb7KOwgyDi39O7Y1/jBlrT4ptzVbKmUuoK6FtUg3tS9FOoU6Hy3XNTUulbcjNoUxb7R9pfMpRjHAvG8iFrjksDsqkzVcNnQ2OS+8r465L7rxtwK4GjniM2k/frxYOeO5iD1ysIcwkKT/vFO1Vbt7uC4oRDWRKM207EAfs1K5WrWSvOU1UbeoOMFAzLJeNEG7o7Wdu+m51rqpP5K38DP8Nmk14Da+uOYwFTiOvIW7Pr+6vxS+QLvnLCBCxLu0tDy1ojgQuJy+iqpquu261i1ROLOxTTnmLcE4FbReOMkxZjJ5PaC1vLY3sQZBhjNTK+k5UrTptxe+5byLQYQ09jWxsi43zzR2sWwyvbhhMzYyRDibMfY2RSm/NRQ4NDDStvcq07ZsNCsvNS2kwAOqOrCGKT4jvBdwnDadiLKRL3AufKXuNbAuHbJ4sMUnta0TM5AzzLSANTG0nbvROny7qK+ZKCGxgioiM/cwqzcJLqmyiyoEwEouWbDqKy88JqQcunC8PkRvuwA9Lbj4PZu45LG+LzyxgS2Tqhakia8SLmuwTqFqLdO0nLFItCCwZapfIewij7EKwJy+R8AgSIMybLVJK8MyyK6+LE6vrrQ0MtmzSDhGO1EwSy6PMCY6hrOrr8M5hbncKhiv0Da/vpw5+bH3OEe7wieEupWx30DVsw+wTrhmQLa6+LTvMxc6KCyAtE43LbgNs+uwhjhwwUY4S7hRufsvEzPyN2A1l0KNsCqveL9XLjq07rGcMSVFnrvrrlU7nb3YsPI2bDlxwYs0tCmrN6k0kaTJKUapHrR0trE2B71RsmKyaLNzIpQu5SOgtZ40+TH+sSwcca8YOAEtdzbjqRAzOLPgtGmh273AtlY5I8HAPekyprgotZM2jK5KtAY3Ur34svU2Ca8zMNEzFSvtqJusGrEes7MnKTUNrzwtd7SvL4U25jEpsrdAjS3uMWoxu6ynuugv9K+tua6usC+HMtkyJC2pM16yNLy4NO8yjaSZOhS2vrIcrP08Ui3xuow207zCtDooADOqOTAzM7WZNdizHDyks2m1njseOf05d7RYNX84e7lStlpAj71ZsNQ0OTeMuSkyKjUjviGrxreELEU1JLsENo+1Yre/M5eo6LQmvaUuk7C3taI/BjHOsWW1MzkINnU0UzVZIN2wG6nPNNgyCTS7KQAxerWeM9KqOyDgoDQ5yDI0Myq4VK1ALnOz9CRWqBYu66xWMn+z0iSsOIc00LQfrgy0hK3UM/0p/DDVK9C4fDTeuVW8uzV+Nvi0+7JjNF40sbh3QKWxsCmHNbSyHrUwsb21wLLyroux3i28M/KxiTQ3uAK+M6i3rwesljVLLGczAzGNuGAtFC6zLqIlZawIsFejYqCso/auXiwXMtGuPSjfJUcsSS3MJz2qtrYjHk8pHq3DNIOpJrEyJi6smjDyodUmH6veqlGqAbLMw9EswzWfMmg6Ca7sNOerbK/vLEGwM6zysG2cSKisMLk0oatCpkCyiTEAqgYsl6Q8vYeyWa6WrYe8LTF6pOYpMDlhKlunKahdNLMYWqprqOE6ICrWKVcl+iYUK/Gz1CblN0cwzbC/shi1lrAoMK8tOa9zrzuvdh0/s9cvcSE8tNM2vK7RwSwv9jBoqCu09LGCNq0smblNsFu2JbZcrxU1a7IhL0W5O7KGNCM17i6CrTIyLaxiL5WwaCRxqxGxl7R5O7sxH7jesVOxjbGnrcEynS35p9C2YylXrFs02bEWK5xC8jWzNR6y368KNNs2SDEfOKiwdzSgvHmvTbAyr3g1M7BmsU+yiTRAMK0shLdYNQw8ZjdQg3m2tTR3sIw1WzeYuUaz+DDtuNi2ji5dNp41SjWjMgcz/bdmoWCpFLoqtx4//LWKtpm5zTG3L1GyCLjyOigwdbInMm0wy7PgtCOytLJLtk+tdDYGrVgv5rf4sAs+JjbBFhmsfbVwKyWyxKDMNOu06KoWM1O106+EtBWvNChmtJGysDDDqSkwS7iZtThE1y2WtAazPauJNZox+7hCs1u6VLeAqlO82bJfs5G5V7CwtDisnDQIudK2jrQvuUM3xTKzL6MyMiZSKP+2nR/7NGYwZyV0NAG4B7GTttKx4DRBMTQzNjPNqJg3IbS8tfg6iSGtp86xqLSbqDqf6LCzOPGyOqvTqca1y6xqJbiy+7Iop1GpM63JqoUxhLY7tLY3ZKoaKNq1ZLTyKVurZLj/MMi4XbKNsU2rwrXnJl+60LeAtMKlp6fntDMt8qzutN89gTPHLp0wdDRLJmQz0rQrOSs06LGPNRy5ZLLFpzq4niqlmsYwMC6PtE41qzBKnbk1SJm4LHKvirc4qEsoIbNhMiy0dC6rub20oyz5rvcxgLK0LLgumSoItHMvoLJfM5pA1jXWrDUgBbWTK3av0LQjMyKyrbWFtKa097WcuVg1vi4uMH26hLN5LvUww5QLsgNAsbdhN6e4Fpt8M1oxfbUDN6K43LVlu8swy7PYKEswfi2puHoxYbVfrAcxUayZMoc3cTA3sVcwqzQIsSAwVjD8s/SqgTUitH80i7f1MOow7DA4KhElSLKuMlm1IawVnwEwdjP0tFo1h7A/uGYvbLZDvlm3pDWNLeW4Br9yKsAx9CiTn322M7EKMPG5J7NiHro9FzFeoRyo7C1CJTqxDrFXOWoq0jUmMESwIbUgra2jNDTHqr+uwKpNJjaxVDOtLy03ZDK0sOIxnDXPKJo1zjJssdgwZTPLsJgw2hzsNTM0KDG2Mxiw7rVhM4auAi72MvO3yzYGrQc1DLM4KogwJjGAHt0zyjIursW5lqzuNQw03LXQMWYw0bMgrzazXaUAMNMgeR3YF1gyF6musT4xpzTbM4A08DMBNUyv4ygIIo02yjQMNKupkC2NMy4yTq9zHB4z3DKQNQkr37D0rdY3FbaMuEqqQzgJJ226zC2usOIpaKhUqSu34C9hLxOx9LGmtgpFYLAOub+0xbKgM1muoZw7PTi0Y7wzKrIzmrensbkx9i9SMO021aw3LxE4NC+utsm9JjR6Oq8vxDYDsAk3KCr2tpylozZRuVi5ZaUbMcgx2rK5Jx+0QLqssCugxrXhtpM/msDIOHylMzExMKIoP6bFN9G0XzSdMdCptK4AsI4h96dKrDa1jjAlJPUvD7CcuOE4eDQ+Okw9u7Tcseg43Sy9NDUkqzlXvPQxt7DUsH+oAbAKIAS3J64ErPoxyDd0MAI1CrVlPLu1vim9u/m4czBzNac0NDfbNJgr3iyJMT+tFTTdsW+1aKrqrFqkaLTJtqYy3jkRszy4kBzwK/u4uq4ZtU04ozj8NIGrnC49tpgxyjOSNVG4zDMfKXmtWzTQKcU86r1StXo9OrbGoF42N61jvhs7iTw8vBmwzrRROIAzvj1KMq68f7V2sqSvzzkLM3BA37yzuka6DrGus+w6WKTAut+01DwRPOqvHrFtveitvDhwOea8CK4ItLMwjj8psSm3RjoFvuaoczVjN0O5WLK9PHstBD8Os3Wwjy4auKq0LTgHL2+p+jUls20xWD0FrEEx6K/6vUa0HrQfqW+3BbINuRW2b7hjOFe5cDVZuHcmwjjxszW1HrMVseipkjYiskMyDDNrODmyNC9Mt1O7zTKorxexEzwaNEYtnayOrAknYjAQNe85qawyLWK21C77LuWxFTUMMoK1iyqxJpss6inLr3M3wbSGPCispK2PNA8dJDA/tm+vNibMJ8ufWi67rrkyUbG1LVY8HKwOpB21u64WoZ+jRiZyQEKquKyssjUltzYxJJ6wCbadLFapJyIiKPy2XCqxJP+k2hGaMWMlBCDEsnKrxCy1NX4lASVhrOwnxi9Lsd0t5DNHKqIvyrNMswguM7dGLbIxnq5WKwgqF65RMSS0VTXXJi+pj6rGsdIvlx+zN2mwRbHwrCcsS7blKKk2EbKYKscc9y8BKSqxgy8GsAg7JTWkvxgmFCr/tA+cLyqysAA41D8vsqYyijcntOkuezRPLaywDCcMMY4zBKSkOq2yR7oBQDGwV7dUOeqoDqMyKeY7T79ZMDa7zDLUMx2vYDvCIH60nSKBLhO15rAWM8G4U7gqPF2zE7OxtTiuCzonMXkpqrlDqFqx1rYINHmwDDExnFs3k7HEMgS8qLFzuuU5ADa/vqa4HS08vC8sfDoqtwWuFj5Tsnaf0LQ3GWGxxTd5ONWzcBJ6Jwu3PLQJNGWuiDZLOe2ozK27sLAsJjpiMCKvAbiipTW0YS7Cnvu5Wj8ws0K4uy74KUGhurCJti859CZ2MJIsnq3HNTasIC1BtCmyOzHqJDskiLCpKiw737xItF4/Uq5psyO4CatkM1ys8Te9MhEshLRHt4YsQTT4Mi+ta7VdKfWpqrTZNDC+5SoZNi++mDE8OYypyC/PNAO3ZiqcsaqYVDJkJJ0mZrSCsWc4gDMWJSQwSjlCsGuwq7jetPS2PKRkKVg2tLZkOrUvIDhlQFC3CLyUNeMfW6C8raY5trlkqIS+dbWltt06LrC5Nxk41inIMF61nbp3tlI4eDmhwC42ZTU8l5QxDDCgM4O2QDopq8oyy6yfLHewZazctkYpTa3mLqQ2gbOlNSY2/bpPNT2xBTGyqr2jt680Miu4OyFaraUy85y1HYEVsij/HdGa85IynfIWZxnXnYCrUKefG6CXFZAIrjegOpuYND4cCZNSpVCg2Z/KHBkd+BuzpKKhqxinClwomCGynqe1myfJJIsY5yZPJdGkHpkUuBab7KBVJeYUt55YkbUisS5lEgcZxARFmSGjKhkkFbWxLhZkEbySVaWLKyybyBkqNNwYnpUml7cV"),t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return{buffer:t.buffer}}catch(e){return{err:new tl("Model",tf.ModelInitFailed,"Failed to read weights binary string: "+((null==e?void 0:e.message)||"unknown"),!0)}}}(),t=e.buffer,n=e.err;return n||!t?(x.error("Failed to load local model params",n),{err:n}):{result:{weightsMap:tj,weightsBinary:t}}},i.capabilties=function(){return this.model.capabilities()},t}(tm),tK=function(){function e(e,t,n){this.windowContext=e,this.listeners=n,this.canvas=void 0,this.sourceVideo=void 0,this.pipeline=void 0,this.frameStream=void 0,this.gpuContext=void 0,this.performanceMonitor=void 0,this.config=void 0,this.transformerCapabilities=void 0,this.config=ta({gpu:{timingInfoEnabled:!1,requiredFeatures:["shader-f16"]},pipeline:{minimumFramerate:60,includeReceiveDelay:!0},capture:{maxQueueSize:2},monitor:{enable:!0,monitorIntervalMs:5e3,frameRateDiffPercentage:.25,frameCountDiffPercentage:.25},superRes:{enable:!1,loadWidthBytes:8,models:[]}},t),x.info("[VideoTransformer]: Parsed config",this.config),this.canvas=e.document.createElement("canvas"),this.transformerCapabilities={superRes:[]}}var t,n=e.prototype;return t=k()(P().mark(function e(){var t,n,r,i,o,a,s,u,c,l,f,d,h,p=this;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=performance.now(),x.log("[VideoTransformer]: Init start"),n=this.onErrorInternal.bind(this),e.prev=3,r=this.gpuContext=new tv(this.windowContext,this.config.gpu),e.next=7,r.init();case 7:if(!(i=e.sent)){e.next=10;break}return e.abrupt("return",{err:i});case 10:return o=new tg(this.canvas,r,n),e.next=13,o.init();case 13:if(!(a=e.sent)){e.next=16;break}return e.abrupt("return",{err:a});case 16:if(!(u=(s=new tp(this.config.capture,n)).init())){e.next=20;break}return e.abrupt("return",{err:u});case 20:if(!this.config.superRes.enable){e.next=30;break}return l=new tz(this.config.superRes,r,{error:n,capabilities:function(e){p.transformerCapabilities.superRes=e,p.listeners.capabilities(p.transformerCapabilities)}}),e.next=24,l.init();case 24:if(!(f=e.sent)){e.next=27;break}return e.abrupt("return",{err:f});case 27:c=l,e.next=31;break;case 30:c=new ty;case 31:return d=new th(s.getStream(),o,{error:n},this.config.pipeline),e.next=34,d.init(c);case 34:if(!(h=e.sent)){e.next=37;break}return e.abrupt("return",{err:h});case 37:return this.performanceMonitor=new tb(this.config.monitor,this.stats.bind(this),{performanceBreach:this.onPerformanceBreach.bind(this)}),this.frameStream=s,this.pipeline=d,x.log("[VideoTransformer]: Init complete in "+(performance.now()-t).toFixed(3)+"ms"),e.abrupt("return",{info:{timeMs:performance.now()-t,gpuProperties:r.properties()}});case 44:return e.prev=44,e.t0=e.catch(3),x.warn("[VideoTransformer]: Failed to init",e.t0),e.abrupt("return",{err:new tl("VideoTransformer",tf.Init,e.t0.message,!0)});case 48:case"end":return e.stop()}},e,this,[[3,44]])})),n.init=function(){return t.apply(this,arguments)},n.start=function(e){var t,n;this.ready()?this.active()?x.warn("[VideoTransformer]: Start called on active instance"):(this.sourceVideo=e,null==(t=this.frameStream)||t.start(e),null==(n=this.performanceMonitor)||n.start(),x.log("[VideoTransformer]: Pipeline started")):x.log("[VideoTransformer]: Start called before init")},n.stop=function(){var e,t;x.log("[VideoTransformer]: Stopping render pipeline"),null==(e=this.frameStream)||e.stop(),null==(t=this.performanceMonitor)||t.stop()},n.setVideoFrameMetadata=function(e){var t;null==(t=this.frameStream)||t.setVideoFrameMetadata(e)},n.active=function(){var e,t;return null!=(e=null==(t=this.frameStream)?void 0:t.active)&&e},n.stats=function(){if(!this.pipeline||!this.frameStream)return{timestamp:performance.now(),frames:{source:0,source_presented:0,captured:0,received:0,transformed:0,rendered:0,missed:0,blocked:0,skipped:0,failed:0,overBudget:0},timings:{captureDelay:0,receiveDelay:0,transformTime:0,renderTime:0,endToEnd:0},resolution:{sourceHeight:0,sourceWidth:0,renderHeight:0,renderWidth:0}};var e,t,n,r,i,o,a=this.pipeline.stats(),s=a.received,u=a.transformTime,c=a.skipped,l=a.transformed,f=a.failed,d=a.overBudget,h=a.rendered,p=a.renderTime,v=a.receiveDelay,g=a.endToEnd,m=this.frameStream.stats(),y=m.captured,_=m.blocked,b=m.missed,E=m.rVFCDelay,S=null!=(e=null==(t=this.sourceVideo)?void 0:t.getVideoPlaybackQuality())?e:{totalVideoFrames:0,droppedVideoFrames:0},T=S.totalVideoFrames,w=S.droppedVideoFrames;return{timestamp:performance.now(),frames:{source:T,source_presented:T-w,captured:y,received:s,transformed:l,rendered:h,missed:b,blocked:_,skipped:c,failed:f,overBudget:d},timings:{captureDelay:E,receiveDelay:v,transformTime:u,renderTime:p,endToEnd:g},resolution:{sourceHeight:null!=(n=null==(r=this.sourceVideo)?void 0:r.videoHeight)?n:0,sourceWidth:null!=(i=null==(o=this.sourceVideo)?void 0:o.videoWidth)?i:0,renderHeight:this.canvas.height,renderWidth:this.canvas.width}}},n.renderSurface=function(){return this.canvas},n.gpuProperties=function(){var e;return null==(e=this.gpuContext)?void 0:e.properties()},n.capabilities=function(){return this.transformerCapabilities},n.reset=function(){var e,t,n;x.info("[VideoTransformer]: Resetting instance"),null==(e=this.frameStream)||e.resetStats(),null==(t=this.pipeline)||t.resetStats(),null!=(n=this.performanceMonitor)&&n.monitoring()&&(this.performanceMonitor.stop(),this.performanceMonitor.start())},n.destroy=function(){x.info("[VideoTransformer]: Destroying instance"),this.stop(),this.transformerCapabilities={superRes:[]},this.listeners.capabilities(this.transformerCapabilities),this.gpuContext=void 0,this.frameStream=void 0,this.pipeline=void 0,this.performanceMonitor=void 0},n.ready=function(){return!!(this.frameStream&&this.pipeline&&this.performanceMonitor&&this.gpuContext)},n.onPerformanceBreach=function(e){this.onErrorInternal(new tl("PerformanceMonitor",e.code,e.reason,e.fatal))},n.onErrorInternal=function(e){this.stop(),this.reset(),this.listeners.error(e)},e}(),tQ=function(e){return e.setAttribute("playsinline",""),{element:function(){return e},displayDimensions:function(){return{width:e.clientWidth,height:e.clientHeight}},videoDimensions:function(){return{width:e.videoWidth,height:e.videoHeight}},stats:function(){return{timestamp:performance.now(),droppedFrames:(0,eh.ld)(e),decodedFrames:(0,eh.xB)(e)}},visible:function(){return(0,ez.j)(e)}}},tq=function(){function e(e,t){this.initialConfig=e,this.listeners=t,this.videoTransformer=void 0,this.surface=void 0,this.statusInterval=void 0,this.scoutModeTimeout=void 0,this.config=void 0,this.disabled=!1,this.scouted=!1,this.resumeOnVisible=!1;var n,r={statusIntervalMs:5e3,scoutPeriodMs:5500,logLevel:A.$.WARN,gpuAllowlist:{vendors:[],architectures:[]},behaviors:{},transformer:{}};this.config=ta(r,e.module);var i=null==(n=this.config.transformer.monitor)?void 0:n.monitorIntervalMs;void 0===e.module.scoutPeriodMs&&i&&(this.config.scoutPeriodMs=i+500),x.setConfig({enabled:!0,level:this.config.logLevel}),x.info("[VideoTransformerModule]: Parsed config",this.config)}var t,n=e.prototype;return t=k()(P().mark(function e(){var t,n,r;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.videoTransformer){e.next=3;break}return x.debug("[VideoTransformerModule]: Init called on setup instance"),e.abrupt("return",void 0);case 3:if(!this.disabled){e.next=6;break}return x.warn("[VideoTransformerModule]: Init called, but the module is disabled"),e.abrupt("return",void 0);case 6:return e.prev=6,t=new tK(window,this.config.transformer,{error:this.onTransformerError.bind(this),capabilities:this.onTransformerCapabilities.bind(this)}),e.next=10,t.init();case 10:if(!(n=e.sent).err){e.next=14;break}return this.onTransformerError(n.err),e.abrupt("return",void 0);case 14:if(this.videoTransformer=t,r=this.gpuAllowed(),this.logInitEvent(n,r),r){e.next=20;break}return this.disable(),e.abrupt("return",void 0);case 20:return this.surface=this.createWebGpuCanvasSurface(t.renderSurface()),e.abrupt("return",this.surface);case 24:return e.prev=24,e.t0=e.catch(6),x.error("[VideoTransformerModule]: Unhandled error encountered during init",e.t0),this.onTransformerError(new tl("VideoTransformerModule",tf.Init,"Unhandled error during init: "+((null==e.t0?void 0:e.t0.message)||"unknown"),!0)),e.abrupt("return",void 0);case 29:case"end":return e.stop()}},e,this,[[6,24]])})),n.init=function(){return t.apply(this,arguments)},n.start=function(e){if(this.disabled)x.log("[VideoTransformerModule]: Video transformer not starting: module is disabled");else if(this.videoTransformer)if(this.videoTransformer.active())x.log("[VideoTransformerModule]: Start called, but transformer is already active");else{if(tJ())return x.log("[VideoTransformerModule]: Start called, but page is hidden. Resuming on visible"),void(this.resumeOnVisible=!0);x.log("[VideoTransformerModule]: Starting"),this.videoTransformer.start(e),this.videoTransformer.active()?(this.startLogStatusEvents(this.config.statusIntervalMs),this.scout(this.config.scoutPeriodMs)):(x.log("[VideoTransformerModule]: Failed to start"),this.onTransformerError(new tl("VideoTransformerModule",tf.BadParameters,"Transformer failed to start",!0)))}else x.log("[VideoTransformerModule]: Video transformer not starting: start called before transformer init")},n.stats=function(){var e,t,n=0,r=0,i=performance.now(),o=null==(e=this.videoTransformer)?void 0:e.stats().frames;return o?(n=null!=(t=o.rendered)?t:0,{timestamp:i,droppedFrames:r=o.missed+o.skipped+o.failed,decodedFrames:n}):{timestamp:i,decodedFrames:n,droppedFrames:r}},n.swapVideoSource=function(e){var t;null!=(t=this.videoTransformer)&&t.active()&&(this.videoTransformer.stop(),this.videoTransformer.start(e))},n.stop=function(){var e;null==(e=this.videoTransformer)||e.stop(),this.resumeOnVisible=!1,clearInterval(this.statusInterval),clearInterval(this.scoutModeTimeout)},n.reset=function(){var e;null==(e=this.videoTransformer)||e.reset()},n.destroy=function(){var e;this.stop(),this.listeners.syntheticQualities([]),null==(e=this.videoTransformer)||e.destroy(),this.videoTransformer=void 0,this.listeners.inactive()},n.disable=function(){this.disabled=!0,this.destroy()},n.onPageVisibilityChanged=function(e,t){if(e){var n,r,i=null!=(n=null==(r=this.videoTransformer)?void 0:r.active())&&n;this.stop(),x.log("[VideoTransformerModule]: Page hidden. Was active: "+i),this.resumeOnVisible=i}else x.log("[VideoTransformerModule]: Page visible, resumeOnVisible: "+this.resumeOnVisible),this.resumeOnVisible&&this.start(t),this.resumeOnVisible=!1},n.onVideoSessionChanged=function(){x.log("[VideoTransformerModule]: onVideoSession, initialized: "+!!this.videoTransformer);var e,t=null==(e=this.videoTransformer)?void 0:e.gpuProperties();t&&this.logInitEvent({info:{timeMs:0,gpuProperties:t}},this.gpuAllowed())},n.onQualityChanged=function(e){var t,n,r,i,o,a=null!=(t=null==(n=e.attributes)?void 0:n.Pipeline)?t:"",s=null==(r=this.videoTransformer)?void 0:r.capabilities().superRes.find(function(e){return e.id===a});if(!s)return x.warn("[VideoTransformerModule]: Failed to find capability for "+a+" on quality "+e.name+" received"),void(null==(o=this.videoTransformer)||o.setVideoFrameMetadata({pipelineId:"",match:{width:-1,height:-1}}));null==(i=this.videoTransformer)||i.setVideoFrameMetadata({pipelineId:a,match:{width:s.widthFrom,height:s.heightFrom}})},n.scout=function(e){var t=this;window.clearTimeout(this.scoutModeTimeout),this.scouted?x.log("[VideoTransformerModule]: Already scouted"):(x.log("[VideoTransformerModule]: Starting "+e+"ms scout mode before ready"),this.scoutModeTimeout=window.setTimeout(function(){var e;t.scouted=!0,null!=(e=t.videoTransformer)&&e.active()?(x.log("[VideoTransformerModule]: Scout mode complete"),t.onTransformerCapabilities(t.videoTransformer.capabilities()),t.listeners.active()):x.log("[VideoTransformerModule]: Scout mode complete, but video transformer is no longer active")},e))},n.gpuAllowed=function(){var e,t=null==(e=this.videoTransformer)?void 0:e.gpuProperties();if(!t)return x.info("[VideoTransformerModule]: GPU not allowed: gpu properties not found"),!1;var n,r,i,o,a,s=(o=[].concat(null!=(r=null==(n=this.config.gpuAllowlist)?void 0:n.vendors)?r:[]),a=[].concat(null!=(i=null==n?void 0:n.architectures)?i:[]),{allowed:function(e){var t={allowed:!0,reason:""};return o.includes(e.vendor)||o.includes("*")||(t={allowed:!1,reason:"GPU Vendor not allowed. Have: "+e.vendor+" Need: "+o.join(",")}),a.includes(e.architecture)||a.includes("*")||(t={allowed:!1,reason:"GPU Architecture not allowed. Have: "+e.architecture+" Need: "+a.join(",")}),t}}).allowed(t);return!!s.allowed||(x.info("[VideoTransformerModule]: GPU not allowed: "+s.reason),!1)},n.createWebGpuCanvasSurface=function(e){var t=(e.className="ivs-player-canvas-surface",e.style.objectFit="contain",e.style.overflowClipMargin="content-box",e.style.overflow="clip",e.style.imageRendering="auto",{element:function(){return e},displayDimensions:function(){return{width:e.clientWidth,height:e.clientHeight}},videoDimensions:function(){return{width:e.clientWidth,height:e.clientHeight}},stats:function(){return{timestamp:performance.now(),droppedFrames:0,decodedFrames:0}},visible:function(){return(0,ez.j)(e)}});return t.stats=this.stats.bind(this),t},n.startLogStatusEvents=function(e){var t,n,r=this,i=null!=(t=null==(n=this.videoTransformer)?void 0:n.stats())?t:tZ();clearInterval(this.statusInterval),this.statusInterval=window.setInterval(function(){var t,n;if(r.videoTransformer){var o=r.videoTransformer.stats(),a=tY(i,o),s=a.frames,u=a.timings,c=a.timestamp,l=a.resolution,f=0,d=0,h=0,p=0,v=(o.timestamp-i.timestamp)/1e3;v>0&&(f=a.frames.source/v,d=a.frames.source_presented/v,h=a.frames.captured/v,p=a.frames.rendered/v),r.printStats(a,f,d,h,p);var g=_()({status_timestamp:c,status_interval:e,surface_visible:null!=(t=null==(n=r.surface)?void 0:n.visible())&&t,source_height:l.sourceHeight,source_width:l.sourceWidth,render_height:l.renderHeight,render_width:l.renderWidth,frames_source:s.source,frames_source_presented:s.source_presented,frames_captured:s.captured,frames_missed:s.missed,frames_blocked:s.blocked,frames_skipped:s.skipped,frames_transformed:s.transformed,frames_rendered:s.rendered,frames_overbudget:s.overBudget,frames_failed:s.failed,framerate_source:f,framerate_source_presented:d,framerate_capture:h,framerate_render:p,time_capture_delay:u.captureDelay,time_receive_delay:u.receiveDelay,time_transform:u.transformTime,time_render:u.renderTime,time_end_to_end:u.endToEnd},r.gpuAnalyticsProperties());i=o,r.listeners.analytics({name:"onGpuStatus",data:g})}else window.clearInterval(r.statusInterval)},e)},n.logInitEvent=function(e,t){if(e.info){var n=e.info,r=n.timeMs,i=n.gpuProperties,o=_()({gpu_time_init:r,gpu_adapter_features:i.adapterFeatures,gpu_device_features:i.deviceFeatures,gpu_wgsl_features:i.wgslFeatures,gpu_transformer_config:JSON.stringify(this.initialConfig),gpu_allowed:t},this.gpuAnalyticsProperties());this.listeners.analytics({name:"onGpuInit",data:o})}},n.onTransformerCapabilities=function(e){var t=this;if(this.videoTransformer&&this.scouted)if(this.gpuAllowed()&&!this.disabled){var n=[],r={id:"",widthFrom:-1,heightFrom:-1,widthTo:-1,heightTo:-1,framerateFrom:-1,codec:"",encoder:"",scoreModifier:0,behavior:{nameOverride:"",mode:"none"}};e.superRes.forEach(function(e){var i=_()({},r,e,{behavior:_()({},r.behavior,t.config.behaviors[e.id])});n.push(i)}),x.info("[VideoTransformerModule]: Sending synthetics",n),this.listeners.syntheticQualities(n)}else x.info("[VideoTransformerModule]: Not sending synthetics because the module is disabled, or the GPU is not allowlisted");else x.info("[VideoTransformerModule]: Not sending synthetics because the module has not finished initializing or scouting")},n.onTransformerError=function(e){var t,n,r=_()({code:e.code,source:e.source,message:e.message,fatal:!0,surface_visible:null!=(t=null==(n=this.surface)?void 0:n.visible())&&t},this.gpuAnalyticsProperties());x.warn("[VideoTransformerModule]: Error, disabling module",e),this.listeners.error(r),this.listeners.analytics({name:"onGpuError",data:r}),this.destroy()},n.gpuAnalyticsProperties=function(){var e,t,n,r,i,o=null==(e=this.videoTransformer)?void 0:e.gpuProperties();return{gpu_architecture:null!=(t=null==o?void 0:o.architecture)?t:"",gpu_description:null!=(n=null==o?void 0:o.description)?n:"",gpu_device:null!=(r=null==o?void 0:o.device)?r:"",gpu_vendor:null!=(i=null==o?void 0:o.vendor)?i:""}},n.printStats=function(e,t,n,r,i){var o,a,s=e.frames,u=s.source,c=s.source_presented,l=s.captured,f=s.received,d=s.transformed,h=s.rendered,p=s.missed,v=s.blocked,g=s.skipped,m=s.failed,y=s.overBudget,_=e.timings,b=_.captureDelay,E=_.receiveDelay,S=_.transformTime/d,T=_.renderTime/h,w=_.endToEnd/h,C="Stats:\nStats Interval:                        "+this.config.statusIntervalMs+"ms\nDocument visible:                      "+!document.hidden+"\nSurface visible:                       "+(null!=(o=null==(a=this.surface)?void 0:a.visible())&&o)+"\nSource Resolution                      "+e.resolution.sourceWidth+"x"+e.resolution.sourceHeight+"\nRender Resolution                      "+e.resolution.renderWidth+"x"+e.resolution.renderHeight+"\nSource Total Framerate:                "+t.toFixed(1)+"\nSource Presented Framerate:            "+n.toFixed(1)+"\nCapture Framerate:                     "+r.toFixed(1)+"\nRender Framerate:                      "+i.toFixed(1)+"\nSource Total frames:                   "+u+"\nSource Presented frames:               "+c+"\nSource Dropped frames:                 "+(u-c)+"\nCaptured frames:                       "+l+"\nReceived frames:                       "+f+"\nTransformed frames:                    "+d+"\nRendered frames:                       "+h+"\nMissed frames:                         "+p+"\nBlocked frames:                        "+v+"\nSkipped frames:                        "+g+"\nOverbudget frames:                     "+y+"\nFailed frames:                         "+m+"\nAverage rVFC capture delay:            "+(b/l).toFixed(3)+"ms\nAverage frame receive delay:           "+(E/l).toFixed(3)+"ms\nAverage frame transform time:          "+S.toFixed(3)+"ms\nAverage frame render time:             "+T.toFixed(3)+"ms\nAverage frame end-to-end time:         "+w.toFixed(3)+"ms\n";x.log("[VideoTransformerModule]: "+C)},e}(),tY=function(e,t){var n={timestamp:t.timestamp,resolution:_()({},t.resolution),frames:{source:0,source_presented:0,captured:0,received:0,transformed:0,rendered:0,missed:0,blocked:0,skipped:0,failed:0,overBudget:0},timings:{captureDelay:0,receiveDelay:0,transformTime:0,renderTime:0,endToEnd:0}};return["frames","timings"].forEach(function(r){for(var i=0,o=Object.entries(t[r]);i<o.length;i++){var a=o[i],s=a[0],u=a[1];n[r][s]=u-e[r][s]}}),n},tZ=function(){return{timestamp:performance.now(),frames:{source:0,source_presented:0,captured:0,received:0,transformed:0,rendered:0,missed:0,blocked:0,skipped:0,failed:0,overBudget:0},timings:{captureDelay:0,receiveDelay:0,transformTime:0,renderTime:0,endToEnd:0},resolution:{sourceHeight:0,sourceWidth:0,renderHeight:0,renderWidth:0}}},tJ=function(){var e=(0,ez.sQ)(document).hidden;return document[e]},tX=(n(67085),function(e,t){var n=e,r=t,i=0;return{update:function(e,t){t!==r&&(i=(e-n)/(t-r)*1e3,n=e,r=t)},framerate:function(){return i}}}),t$=((g={}).video="video",g.canvas="canvas",g.debug_both="debug_both",g),t0=function(){function e(e){this.context=e,this.video=void 0,this.canvas=void 0,this.surfaceContainer=void 0,this.framerateTracker=void 0,this.surfaceContainer=e.createElement("div");var t=e.createElement("video");this.video=tQ(t),this.moveVideoToRenderSurface();var n=this.video.stats();this.framerateTracker=tX(n.decodedFrames,n.timestamp)}var t=e.prototype;return t.setVideo=function(e){if(this.video.element()!==e){this.activeSurface()!==t$.video&&this.hideSurface(e);var t=tQ(e),n=t.stats();this.framerateTracker=tX(n.decodedFrames,n.timestamp),this.video=t}},t.moveVideoToRenderSurface=function(){this.replaceElement(t$.video,this.video.element())},t.setCanvas=function(e){this.canvas!==e&&(this.activeSurface()!==t$.canvas&&this.hideSurface(e.element()),this.replaceElement(t$.canvas,e.element()),this.canvas=e)},t.setActiveSurface=function(e){if(e!==this.activeSurface()){var t,n;if(e===t$.canvas){if(!this.canvas)return void console.warn("[RenderSurface]: Tried to set canvas surface to active, but the canvas surface is undefiend.");this.hideSurface(this.video.element()),this.showSurface(this.canvas.element())}else e===t$.video?(this.hideSurface(null==(t=this.canvas)?void 0:t.element()),this.showSurface(this.video.element())):e===t$.debug_both&&(this.showSurface(null==(n=this.canvas)?void 0:n.element()),this.showSurface(this.video.element()))}},t.surface=function(){return this.surfaceContainer},t.videoElement=function(){return this.video.element()},t.displayDimensions=function(){return this.video.displayDimensions()},t.videoDimensions=function(){return this.video.videoDimensions()},t.stats=function(){var e=this.video.stats();return this.framerateTracker.update(e.decodedFrames,e.timestamp),e},t.framerate=function(){return this.framerateTracker.framerate()},t.activeSurface=function(){var e;return null!=(e=this.canvas)&&e.visible()?t$.canvas:t$.video},t.safeAppendSurface=function(e){try{this.surfaceContainer.appendChild(e)}catch(e){console.warn("[RenderSurface]: Failed to append surface to container",e)}},t.safeRemoveSurface=function(e){try{var t=this.surfaceContainer.querySelector(e);t&&this.surfaceContainer.removeChild(t)}catch(e){console.warn("[RenderSurface]: Failed to remove surface from container",e)}},t.replaceElement=function(e,t){this.safeRemoveSurface(e),this.safeAppendSurface(t)},t.hideSurface=function(e){e&&(e.style.visibility="hidden",e.style.position="absolute",e.style.inset="0")},t.showSurface=function(e){e&&(e.style.visibility="inherit",e.style.position="inherit",e.style.inset="inherit")},e}(),t1=function(){function e(){this.emitter=new eE.TypedEmitter({}),this.queue=[]}e.getInstance=function(){return e.gInstance||(e.gInstance=new e),e.gInstance};var t=e.prototype;return t.registerMetricsCallback=function(e){this.emitter.on("newMetrics",e)},t.unregisterMetricsCallback=function(e){this.emitter.off("newMetrics",e)},t.enqueue=function(e){this.queue.push(e),this.emitter.emit("newMetrics")},t.dequeueAll=function(){var e=this.queue;return this.queue=[],e},e}();function t2(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}t1.gInstance=void 0;var t3=function(){function e(t,n){var r,i,o,a,s,u=this;this.worker=void 0,this.id=void 0,this.emitter=new eP,this.seekTime=null,this.paused=!0,this.isLoaded=!1,this.autoPlayOptions=null,this.mediaSinkManager=void 0,this.experiments={},this.adjustments=void 0,this.enableRemoteSearch=void 0,this.isQualitySupported=void 0,this.onvisibilitychange=void 0,this.onmessage=function(e){return u.onWorkerMessage(e)},this.onOnline=function(){return u.postMessage("onOnline")},this.onOffline=function(){return u.postMessage("onOffline")},this.pauseHiddenSilentTab=void 0,this.state=void 0,this.workerMessageProcessors=[T],this.configManager=void 0,this.deviceConfigMetricsHelper=t1.getInstance(),this.deviceConfigEmitMetricsBound=this.emitDeviceConfigManagerMetrics.bind(this),this.daterangeTagAssembler=void 0,this.videoTransformerModule=void 0,this.renderSurface=new t0(document),this.startCapture=void 0,this.stopCapture=void 0,this.requestCaptureAnalytics=void 0,e.instanceCount+=1,this.worker=n,this.id=e.instanceId++,this.isQualitySupported=t.isQualitySupported||ez.h3,this.onvisibilitychange=function(){return u.onVisibilityChange()},this.enableRemoteSearch=t.enableRemoteSearch||!1;var c,l=(0,m.cp)();if(void 0!==t.platform&&null!==t.platform&&""!==t.platform&&(l.platform=(0,m.on)(t.platform)),this.pauseHiddenSilentTab=l.chrome&&63===l.major||l.opera,this.adjustments=(c=null!=(r=null==(i=t.webviewHost)?void 0:i.adjustments)?r:{},_()({},te,c)),this.mediaSinkManager=new e8(this,this.enableRemoteSearch,this.adjustments,this.renderSurface.videoElement()),w.isSupported()){var f=new w;this.workerMessageProcessors.push(f.processor)}var d,h,p,v,g=(d={architecture:"",description:"",device:"",vendor:""},h=!1,p=null,{init:function(){return k()(P().mark(function e(){var t;return P().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(h=!1,p=R.gpu_pending,e.prev=2,navigator.gpu){e.next=7;break}return x.warn(R.gpu_unavailable),p=R.gpu_unavailable,e.abrupt("return");case 7:return e.next=9,navigator.gpu.requestAdapter();case 9:if(t=e.sent){e.next=14;break}return x.warn(R.gpu_adapter_unavailable),p=R.gpu_adapter_unavailable,e.abrupt("return");case 14:if(t.info){e.next=18;break}return x.warn(R.gpu_adapterinfo_undefined),p=R.gpu_adapterinfo_undefined,e.abrupt("return");case 18:d=t.info,p=null,h=!0,e.next=27;break;case 23:e.prev=23,e.t0=e.catch(2),x.warn(R.gpu_error,e.t0),p=R.gpu_error+" "+((null==e.t0?void 0:e.t0.message)||"unknown");case 27:case"end":return e.stop()}},e,null,[[2,23]])}))()},process:function(e){if(!e)return e;var t=e.type,n=e.arg,r=t===b.a.ANALYTICS_EVENT,i=n&&("video-play"===n.name||"minute-watched"===n.name);return r&&i&&(n.properties.gpu_supported=h,n.properties.gpu_unsupported_reason=p,n.properties.gpu_architecture=d.architecture,n.properties.gpu_description=d.description,n.properties.gpu_device=d.device,n.properties.gpu_vendor=d.vendor),e}});g.init(),this.workerMessageProcessors.push(g.process.bind(g)),void 0!==t.serviceWorker&&("serviceWorker"in navigator||(eG.warn("Service workers are not supported."),0))&&(eV=ej(t.serviceWorker),null==(v=eH())||v.registerAndActivate()),this.state=e7(),this.resetState(),this.attachHandlers(),this.checkDebugCaptureEnabled();for(var y=((o={})[tr.AVC]=!0,o[tr.HEVC]=(0,O.bz)(),o[tr.AV1]=(0,O.dq)(),o),E=null!=(a=null==(s=t.mediaConfig)||null==(s=s.codecConfigs)?void 0:s.length)?a:0,S=0;S<E;++S){var C,I=null==(C=t.mediaConfig)||null==(C=C.codecConfigs)?void 0:C[S];I&&I.setting.skipPlatformSupportChecks&&(y[I.codecString]=!I.setting.disableUse)}var A=[tr.AVC];y[tr.HEVC]&&A.push(tr.HEVC),y[tr.AV1]&&A.push(tr.AV1),this.configManager=new ts({media:t.mediaConfig},this.onConfigChanged.bind(this)),this.onConfigChanged(),this.postMessage("create",[{mseSupported:(0,O.aP)(),keySystem:void 0!==t.keySystem?t.keySystem:window.WebKitMediaKeys&&"function"==typeof window.WebKitMediaKeys.isTypeSupported&&window.WebKitMediaKeys.isTypeSupported(G.FAIRPLAY.keySystem)?G.FAIRPLAY.uuid:"function"==typeof navigator.requestMediaKeySystemAccess?l.safari?"":l.msIE||l.msEdgeLegacy?G.PLAYREADY.uuid:G.WIDEVINE.uuid:"",browserContext:_()({},l,{webviewHost:t.webviewHost}),codecs:A,testOnly:t.testOnly,playerFramework:t.playerFramework,buildDistId:"npm"},this.configManager.getConfigSnapshot()]);var M=(0,ez.sQ)(document).hidden;this.postMessage("setVisible",[!document[M]]),this.deviceConfigMetricsHelper.registerMetricsCallback(this.deviceConfigEmitMetricsBound),this.emitDeviceConfigManagerMetrics()}var t=e.prototype;return t.delete=function(){var t,n,r=this;null==(t=eH())||t.destroy();var i=(0,ez.sQ)(document).visibilityChange;document.removeEventListener(i,this.onvisibilitychange),window.removeEventListener("online",this.onOnline),window.removeEventListener("offline",this.onOffline),this.emitter.removeAllListeners(),this.emitter.on(e9.DESTROY,function(){try{r.mediaSinkManager.destroy()}catch(e){r.onSinkRecoverableError({value:N.Vk,code:0,message:e.message})}r.emitter.removeAllListeners(),r.worker.removeEventListener("message",r.onmessage)}),this.configManager.delete(),null==(n=this.videoTransformerModule)||n.destroy(),this.videoTransformerModule=void 0,this.postMessage("delete"),e.instanceCount>0&&(e.instanceCount-=1),this.deviceConfigMetricsHelper.unregisterMetricsCallback(this.deviceConfigEmitMetricsBound)},t.attachHTMLVideoElement=function(e){var t,n;try{null==(n=this.mediaSinkManager)||n.destroy()}catch(e){this.onSinkRecoverableError({value:N.Vk,code:-1,message:e.message})}this.mediaSinkManager=new e8(this,this.enableRemoteSearch,this.adjustments,e),this.processVideoElementAttributes(e),this.renderSurface.setVideo(e),null==(t=this.videoTransformerModule)||t.swapVideoSource(e),this.configManager.getConfigSnapshot().features.gpu.flags.enable_render_surface&&this.renderSurface.moveVideoToRenderSurface()},t.getHTMLVideoElement=function(){return this.renderSurface.videoElement()},t.getVideoRenderSurface=function(){if(this.configManager.getConfigSnapshot().features.gpu.flags.enable_render_surface)return this.renderSurface.surface()},t.load=function(t,n){var r,i=this;void 0===n&&(n=""),null==(r=eH())||r.configure(),this.postMessage("load",[t,n]),this.autoPlayOptions&&this.postMessage("playIntent"),this.configManager.initDeviceConfigManager({canRefreshNow:e.canDeviceConfigManagerRefreshNowCallback,emitMetrics:e.emitDeviceConfigManagerMetricsCallback,emitAnalytics:function(e,t){i.sendConfigManagerDeviceConfigAnalytics(e,t)}});var o=this.getDeviceConfigPropertyHolder();o&&o.getJsonValue("sr_model_f16"),this.trySetupVideoTransformer()},t.play=function(){this.postMessage("playIntent"),this.mediaSinkManager.captureGesture(),this.paused=!1,this.attemptPlay()},t.setAutoplay=function(e){this.autoPlayOptions=e?{attemptMutedRetry:!0}:null},t.setAutoPlayOptions=function(e){this.autoPlayOptions=e},t.getExperiments=function(){return this.experiments},t.setExperiment=function(e,t){this.setExperimentData({id:e,assignment:t,version:0,type:""})},t.setExperimentData=function(e){this.configManager.setExperiment(e),this.postMessage("setExperiment",[e])},t.pause=function(){this.paused=!0,this.postMessage("pause")},t.isPaused=function(){return this.paused},t.seekTo=function(e){this.seekTime=e,this.postMessage("seekTo",[e])},t.isSeeking=function(){return null!==this.seekTime},t.isAutoplay=function(){return!!this.autoPlayOptions},t.getDuration=function(){return this.state.duration},t.getStartOffset=function(){return this.state.startOffset||0},t.getPosition=function(){return null===this.seekTime?this.mediaSinkManager.getCurrentSink().getCurrentTime():this.seekTime},t.getSyncTime=function(){return this.state.syncTime},t.getBuffered=function(){return this.mediaSinkManager.getCurrentSink().buffered()},t.getBufferedRanges=function(){return this.postMessage("updateBufferedRanges",[]),this.state.trackBufferedRanges},t.getSinkBufferedRanges=function(){var e=this.mediaSinkManager.getCurrentSink();return{audio:e.getBufferedRanges("audio"),video:e.getBufferedRanges("video")}},t.getBufferDuration=function(){return this.state.bufferedPosition-this.getPosition()},t.getState=function(){return this.state.state},t.getVideoWidth=function(){return this.getHTMLVideoElement().videoWidth},t.getVideoHeight=function(){return this.getHTMLVideoElement().videoHeight},t.getVideoFrameRate=function(){return this.state.statistics.framerate},t.getVideoBitRate=function(){return this.state.statistics.bitrate},t.getAverageBitrate=function(){return this.state.averageBitrate},t.getBandwidthEstimate=function(){return this.state.bandwidthEstimate},t.getPath=function(){return this.state.path},t.getProtocol=function(){return this.state.protocol},t.getVersion=function(){return"1.44.0"},t.isLiveLowLatency=function(){return this.state.liveLowLatencyEnabled&&this.state.liveLowLatency},t.isLooping=function(){return this.state.looping},t.setLogLevel=function(e){(0,eE.setLogConfigByLevel)({enabled:!0,level:e}),this.postMessage("setLogLevel",[e])},t.setLooping=function(e){this.state.looping=e,this.postMessage("setLooping",[e])},t.isMuted=function(){return this.mediaSinkManager.getCurrentSink().isMuted()},t.setMuted=function(e){this.mediaSinkManager.getCurrentSink().setMuted(e)},t.setVolume=function(e){this.state.volume=e,this.postMessage("setVolume",[this.state.volume])},t.skipAd=function(){this.postMessage("skipAd")},t.getVolume=function(){return this.state.volume},t.getQuality=function(){return this.state.quality},t.setQuality=function(e,t){void 0===t&&(t=!1),this.getHTMLVideoElement().controls||(this.postMessage("setQuality",[e,t]),this.state.autoQualityMode=!1)},t.getQualities=function(){return this.state.qualities},t.getUnavailableQualities=function(){return this.state.unavailableQualities},t.setSourceGroup=function(e){this.postMessage("setSourceGroup",[e])},t.getSourceGroup=function(){return this.state.sourceGroup},t.getSourceGroups=function(){return this.state.sourceGroups},t.setAuthToken=function(e){this.postMessage("setAuthToken",[e])},t.isAutoQualityMode=function(){return this.state.autoQualityMode},t.setAutoQualityMode=function(e){this.state.autoQualityMode=e,this.postMessage("setAutoQualityMode",[e])},t.setAutoInitialBitrate=function(e){this.postMessage("setAutoInitialBitrate",[e])},t.setAutoMaxQuality=function(e){this.postMessage("setAutoMaxQuality",[e])},t.setAutoMaxBitrate=function(e){this.postMessage("setAutoMaxBitrate",[e])},t.setAutoMaxVideoSize=function(e,t){this.postMessage("setAutoMaxVideoSize",[e,t])},t.setAutoViewportSize=function(e,t){this.postMessage("setAutoViewportSize",[e,t])},t.getPlaybackRate=function(){return this.mediaSinkManager.getCurrentSink().getPlaybackRate()},t.setPlaybackRate=function(e){return this.mediaSinkManager.getCurrentSink().setPlaybackRate(e)},t.setClientId=function(e){this.postMessage("setClientId",[e])},t.setDeviceId=function(e){this.postMessage("setDeviceId",[e])},t.setLiveSpeedUpRate=function(e){this.postMessage("setLiveSpeedUpRate",[e])},t.setPlayerType=function(e){this.postMessage("setPlayerType",[e])},t.setLiveMaxLatency=function(e){this.postMessage("setLiveMaxLatency",[e])},t.setLiveLowLatencyEnabled=function(e){this.state.liveLowLatencyEnabled=e,this.postMessage("setLiveLowLatencyEnabled",[e])},t.setRebufferToLive=function(e){var t;null!=(t=eH())&&null!=(t=t.getDriftDetectionConfig())&&t.enabled||this.postMessage("setRebufferToLive",[e])},t.setVisible=function(e){this.postMessage("setVisible",[e])},t.setInitialBufferDuration=function(e){this.postMessage("setInitialBufferDuration",[e])},t.addEventListener=function(e,t){this.emitter.on(e,t)},t.removeEventListener=function(e,t){this.emitter.removeListener(e,t)},t.getDroppedFrames=function(){return this.state.statistics.droppedFrames},t.getDecodedFrames=function(){return this.state.statistics.decodedFrames},t.getDisplayWidth=function(){return this.renderSurface.displayDimensions().width},t.getDisplayHeight=function(){return this.renderSurface.displayDimensions().height},t.getSessionId=function(){return this.state.sessionId},t.getChannelMetadata=function(){return this.state.channelMetadata},t.getSessionData=function(){return this.state.sessionData},t.getLiveLatency=function(){return this.state.liveLatency},t.isProtected=function(){return this.mediaSinkManager.isProtected()},t.startRemotePlayback=function(){this.postMessage("startRemotePlayback")},t.endRemotePlayback=function(){this.postMessage("endRemotePlayback")},t.setPlatformName=function(e){this.postMessage("setPlatformName",[e])},t.setRequestCredentials=function(e){this.postMessage("setRequestCredentials",[e])},t.setSinkMode=function(e){this.postMessage("setSinkMode",[e])},t.onSinkTimeUpdate=function(){if(null===this.seekTime){var e=this.mediaSinkManager.getCurrentSink(),t=this.renderSurface.stats(),n=t.droppedFrames,r=t.decodedFrames,i=this.renderSurface.displayDimensions(),o=i.height,a=i.width,s=(0,ez.p9)(n),u=(0,ez.p9)(r),c=(0,ez.p9)(o),l=(0,ez.p9)(a);this.postMessage("onClientSinkUpdate",[{currentTime:e.getCurrentTime(),decodedFrames:u,droppedFrames:s,framerate:this.renderSurface.framerate(),bufferDuration:e.bufferDuration(),displayHeight:c,displayWidth:l}]),this.setAutoViewportSize(a*window.devicePixelRatio,o*window.devicePixelRatio),this.emitter.emit(b.a.TIME_UPDATE,e.getCurrentTime())}},t.onSinkBufferUpdate=function(){this.emitter.emit(b.a.BUFFER_UPDATE)},t.onSinkDurationChanged=function(e){this.postMessage("onClientSinkDurationChanged",[e])},t.onSinkEnded=function(){this.postMessage("onClientSinkEnded")},t.onSinkIdle=function(){this.postMessage("onClientSinkIdle")},t.onSinkBuffering=function(){this.postMessage("onClientSinkBuffering")},t.onSinkPlaying=function(e){this.postMessage("onClientSinkPlaying"),e&&this.play()},t.onSinkStop=function(e){var t,n,r=(0,ez.sQ)(document).hidden;if(document[r])this.postMessage("pause");else if(e){if(!this.isMuted()&&(null==(t=null==(n=this.autoPlayOptions)?void 0:n.attemptMutedRetry)||t))return this.setMuted(!0),this.mediaSinkManager.getCurrentSink().play(),void this.emitter.emit(b.a.AUDIO_BLOCKED);this.pause(),this.emitter.emit(b.a.PLAYBACK_BLOCKED)}else this.pause()},t.onSinkReset=function(){this.postMessage("onClientSinkReset")},t.onSinkError=function(e){var t=e.value,n=e.code,r=e.message;this.postMessage("onClientSinkError",[t,n,r])},t.onSinkRecoverableError=function(e){var t=e.value,n=e.code,r=e.message;this.postMessage("onClientSinkRecoverableError",[t,n,r])},t.onSinkVolumeChanged=function(e,t){this.getHTMLVideoElement().controls&&t&&this.setVolume(e),this.emitter.emit(b.a.VOLUME_CHANGED,this.state.volume)},t.onSinkMutedChanged=function(e){this.postMessage("setMuted",[e]),this.emitter.emit(b.a.MUTED_CHANGED)},t.onSinkPlaybackRateChanged=function(e){this.postMessage("setPlaybackRate",[e])},t.onPassthroughSinkDataCue=function(e){var t;null==(t=this.daterangeTagAssembler)||t.addCue(e)},t.onPassthroughSinkMetadata=function(e,t,n,r,i){this.emitter.emit(b.a.TEXT_METADATA_CUE,{description:r,endTime:t,startTime:e,text:n,owner:i,type:"TextMetadataCue"})},t.onPassthroughSinkPropertyChanged=function(e,t){this.postMessage("onClientSinkPassthroughPropertyChanged",[e,t])},t.onSinkControlsChanged=function(e){this.postMessage("setControls",[e])},t.onSinkGapJump=function(e){this.postMessage("onClientSinkGapJump",[e])},t.onRemoteDevice=function(e){this.emitter.emit(e?er.G.AVAILABLE:er.G.UNAVAILABLE)},t.onRemoteReconnect=function(){this.startRemotePlayback()},t.onSessionError=function(){this.postMessage("onClientSinkError",[N.pn,0,"Chromecast session error"])},t.onLoadMediaError=function(){this.postMessage("onClientSinkError",[N.pn,0,"Chromecast load media failed"])},t.onUserCancel=function(){this.endRemotePlayback(),this.emitter.emit(er.G.SESSION_ENDED)},t.onSegmentDiscontinuity=function(){this.mediaSinkManager.onSegmentDiscontinuity()},t.onSessionStop=function(){this.endRemotePlayback(),this.emitter.emit(er.G.SESSION_ENDED)},t.onSessionStarted=function(e){this.emitter.emit(er.G.SESSION_STARTED,e)},e.canDeviceConfigManagerRefreshNowCallback=function(){return e.instanceCount>0},e.emitDeviceConfigManagerMetricsCallback=function(e){t1.getInstance().enqueue(e)},t.emitDeviceConfigManagerMetrics=function(){for(var e,t=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return t2(e,void 0);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t2(e,void 0):void 0}}(e))){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(this.deviceConfigMetricsHelper.dequeueAll());!(e=t()).done;){var n=e.value;this.sendConfigManagerDeviceConfigAnalytics("ivs_devconf_ops_metrics",n)}},t.sendConfigManagerDeviceConfigAnalytics=function(e,t){var n=(0,ez.dl)(t);n&&this.postMessage("onDeviceConfigAnalytics",[e,n])},t.attemptPlay=function(){var e=(0,ez.sQ)(document).hidden;!document[e]&&this.isLoaded&&this.postMessage("play")},t.postMessage=function(e,t,n){void 0===n&&(n=[]),this.worker.postMessage({id:this.id,funcName:e,args:t},n)},t.resetState=function(){Object.assign(this.state,e7()),this.emitter.emit(b.a.DURATION_CHANGED,0),this.seekTime=null,this.isLoaded=!1},t.attachHandlers=function(){var e=this;this.worker.addEventListener("message",this.onmessage);var t=(0,ez.sQ)(document).visibilityChange;document.addEventListener(t,this.onvisibilitychange),window.addEventListener("online",this.onOnline),window.addEventListener("offline",this.onOffline);var n=this.emitter;n.on(b.a.VOLUME_CHANGED,function(){return e.onVolumeChanged()}),n.on(b.a.MUTED_CHANGED,function(){return e.onMutedChanged()}),n.on(b.a.SEEK_COMPLETED,function(){return e.onSeekCompleted()}),n.on(b.a.ERROR,function(){return e.onError()}),n.on(b.a.SESSION_DATA,function(t){return e.onSessionData(t)}),n.on(b.a.SEGMENT_DISCONTINUITY,function(){return e.onSegmentDiscontinuity()}),n.on(e9.STATE_CHANGED,function(t){return e.onStateChanged(t)}),n.on(e9.MEDIA_SINK_RPC,function(t){try{e.mediaSinkManager.applyRPC(t)}catch(t){e.onSinkError({value:N.Vk,code:-2,message:t.message})}}),n.on(e9.CONFIGURE,function(t){var n=t[0];try{e.mediaSinkManager.configure(n),e.setSinkMode(n.mode)}catch(t){e.onSinkError({value:N.Vk,code:-3,message:t.message})}}),n.on(e9.RESET,function(){try{var t,n;null==(t=e.videoTransformerModule)||t.stop(),null==(n=e.videoTransformerModule)||n.reset(),e.mediaSinkManager.reset()}catch(t){e.onSinkRecoverableError({value:N.Vk,code:-4,message:t.message})}}),n.on(en.C.ID3,function(t){return e.onID3(t)}),n.on(e9.GET_EXPERIMENTS,function(t){e.experiments=t}),n.on(e9.PROPERTY_CHANGED,function(t){var n=t.key,r=t.value;return e.onCorePropertyChanged(n,r)}),n.on(e9.SYNC_TIME_CHANGED,function(t){e.emitter.emit(b.a.SYNC_TIME_UPDATE,1e3*t)}),n.on(e9.BUFFERED_RANGES,function(t){e.state.trackBufferedRanges=t}),n.on(e9.LOG_MESSAGE,function(e){var t=e.level;return console[t](e.message)})},t.onCorePropertyChanged=function(e,t){var n,r;this.state[e]=(r=t,"syncTime"===e&&(r*=1e3),r),"quality"===e&&(null==(n=this.videoTransformerModule)||n.onQualityChanged(this.state[e]))},t.onVolumeChanged=function(){var e=(0,ez.sQ)(document).hidden;this.pauseHiddenSilentTab&&document[e]&&0===this.getVolume()&&this.postMessage("pause")},t.onMutedChanged=function(){var e=(0,ez.sQ)(document).hidden;this.pauseHiddenSilentTab&&document[e]&&this.isMuted()&&this.postMessage("pause")},t.onSeekCompleted=function(){this.seekTime=null},t.onError=function(){this.paused=!0},t.onStateChanged=function(e){var t,n=this;switch(e){case ei.p.READY:var r=this.isQualitySupported;if(this.adjustments.abrTranscodesOnly&&this.state.qualities.length>1){var i=this.state.qualities.slice().sort(function(e,t){return t.bitrate-e.bitrate});"chunked"!==i[0].group?r=function(e){return"chunked"!==e.group&&n.isQualitySupported(e)}:this.setAutoMaxQuality(i[1])}var o=(0,ez.YH)(this.state.qualities,r);this.state.qualities=o.supported,o.unsupported.forEach(function(e){return n.removeQuality(e)}),this.isLoaded=!0,this.autoPlayOptions&&this.play(),this.paused||this.attemptPlay();break;case ei.p.IDLE:null==(t=this.videoTransformerModule)||t.stop();break;case ei.p.PLAYING:this.tryStartVideoTransformer();break;case ei.p.ENDED:this.paused=!0}this.emitter.emit(b.a.STATE_CHANGED,e),this.emitter.emit(e)},t.removeQuality=function(e){this.postMessage("removeQuality",[e])},t.onID3=function(e){var t=this;e.forEach(function(e){if("TXXX"===e.id&&"segmentmetadata"===e.desc&&e.info.length){var n=(0,ez.N8)(e.info[0]);if(Object.prototype.hasOwnProperty.call(n,"stream_offset")){var r=Number(n.stream_offset);isNaN(r)||(t.state.startOffset=r-t.getPosition())}}})},t.onVisibilityChange=function(){var e,t=(0,ez.sQ)(document).hidden,n=document[t];this.paused||document[t]||this.attemptPlay(),this.pauseHiddenSilentTab&&!this.paused&&n&&(this.isMuted()||0===this.getVolume())&&this.postMessage("pause"),null==(e=this.videoTransformerModule)||e.onPageVisibilityChanged(n,this.getHTMLVideoElement()),(0,m.cp)().firefox||this.postMessage("setVisible",[!n])},t.onSessionData=function(e){Object.assign(this.state,e)},t.onConfigChanged=function(){var e,t=this.configManager.getConfigSnapshot();t.features.gpu.flags.enable_render_surface&&this.renderSurface.moveVideoToRenderSurface(),this.setupDaterangeTagAssembler(null!=(e=t.features.passthroughDaterangeTags)&&e),this.mediaSinkManager.onPlayerConfigurationChanged(t),this.postMessage("updatePlayerConfiguration",[t])},t.setupDaterangeTagAssembler=function(e){var t,n,r,i,o=this;e?this.daterangeTagAssembler||(this.daterangeTagAssembler=(t=function(e){var t=e.attributes["X-TV-TWITCH-STREAM-SOURCE"];void 0!==t&&o.emitter.emit(b.a.STREAM_SOURCE_CUE,{type:"StreamSourceCue",streamSource:t}),o.emitter.emit(b.a.METADATA,{type:"text/json",data:(0,ez.dl)(_()({ID:e.ID,CLASS:e.CLASS},e.attributes))})},n=new Map,r=function(e,t){return Array.from(e.attributes).every(function(e){return void 0!==t.attributes[e]})},i=function(e,n,i,o){for(var a=0;a<n.length;++a){var s=n[a];if(s.CLASS===e.CLASS&&void 0===s.attributes[i])return s.attributes[i]=o,r(e,s)&&(n.splice(a,1),t(s)),!0}return!1},{addCue:function(e){var o,a,s=null==(o=e.value)?void 0:o.key,u=null==(a=e.value)?void 0:a.data;if(void 0!==s&&void 0!==u)for(var c=0;c<e5.length;++c){var l=e5[c];if(l.attributes.has(s)){var f=e.startTime+"-"+e.endTime,d=n.get(f);if(d||(d=[],n.set(f,d)),!i(l,d,s,u)){var h,p={ID:"com.apple.quicktime.FAKE-HLS-"+e6++,CLASS:l.CLASS,attributes:((h={})[s]=u,h.DURATION=""+(e.endTime-e.startTime),h["START-DATE"]=(new Date).toISOString(),h)};r(l,p)?t(p):d.push(p)}}}}})):this.daterangeTagAssembler=void 0},t.trySetupVideoTransformer=function(){var e=this;if(this.videoTransformerModule)this.videoTransformerModule.onVideoSessionChanged();else{var t=this.configManager.getConfigSnapshot().features.gpu;if(t.flags.init_transformer||t.flags.run_transformer){var n=function(t){e.renderSurface.setActiveSurface(t$.video),x.warn("[MediaPlayer]: Video Transformer error, switching render surface to video",t)},r=function(t){x.debug("[MediaPlayer]: Sending analytics event",t),e.postMessage(t.name,[t.data])};this.videoTransformerModule=new tq(t,{error:n,analytics:r,active:function(){var n,r=t$.video;t.flags.allow_canvas_visible&&(r=t$.canvas,null!=(n=t.render)&&n.debug&&(r=t$.debug_both)),e.renderSurface.setActiveSurface(r)},inactive:function(){e.renderSurface.setActiveSurface(t$.video)},syntheticQualities:function(t){x.info("Received synthetics",t),e.postMessage("setSyntheticQualities",[t])}}),this.videoTransformerModule.init().then(function(n){n&&e.videoTransformerModule&&(t.flags.add_canvas_to_surface&&(x.debug("[MediaPlayer]: Adding canvas to render surface"),e.renderSurface.setCanvas(n)),e.getState()===ei.p.PLAYING&&e.tryStartVideoTransformer())}).catch(function(t){null==(i=e.videoTransformerModule)||i.disable(),x.warn("[MediaPlayer]: Unhanled error initializing the Video Transformer");var i,o={source:"MediaPlayer",code:tf.Init,message:"Unhandled error initializing the Video Transformer: "+((null==t?void 0:t.message)||"unknown"),fatal:!0,gpu_architecture:"",gpu_description:"",gpu_device:"",gpu_vendor:"",surface_visible:!1};n(),r({name:"onGpuError",data:o})})}}},t.tryStartVideoTransformer=function(){this.videoTransformerModule&&this.configManager.getConfigSnapshot().features.gpu.flags.run_transformer&&this.videoTransformerModule.start(this.getHTMLVideoElement())},t.onWorkerMessage=function(e){var t=e.data;if(t&&t.id===this.id){var n=this.workerMessageProcessors.reduce(function(e,t){return t(e)},t),r=n.type,i=n.arg;void 0!==t.arg?this.emitter.emit(r,i):this.emitter.emit(r)}},t.processVideoElementAttributes=function(e){if(e.hasAttribute("autoplay")&&(e.removeAttribute("autoplay"),this.setAutoplay(!0)),e.hasAttribute("playbackRate")){var t,n=parseFloat(null!=(t=e.getAttribute("playbackRate"))?t:"1.0");if(!isNaN(n)){var r=(0,ez.qE)(n,.25,2);this.setPlaybackRate(r)}e.removeAttribute("playbackRate")}if(e.hasAttribute("src")){var i=e.src;(0,ez.Pr)(e),this.load(i)}if(e.hasAttribute("loop")&&(e.removeAttribute("loop"),this.setLooping(!0)),e.hasAttribute("muted")&&(e.removeAttribute("muted"),this.setMuted(!0)),e.hasAttribute("volume")){var o,a=parseFloat(null!=(o=e.getAttribute("volume"))?o:"1.0");isNaN(a)||this.setVolume((0,ez.qE)(a,0,1)),e.removeAttribute("volume")}},t.checkDebugCaptureEnabled=function(){},t.getDeviceConfigPropertyHolder=function(){return this.configManager.getDeviceConfigPropertyHolder()},e}();t3.instanceCount=0,t3.instanceId=0;var t4=r(573),t8=function(){function e(e){var t=this;this.workerPort=void 0,this.emitter=void 0,this.messageQueue=void 0,this.workerPort={postMessage:this.postMessageFromWorker.bind(this),onmessage:function(){}},this.emitter=new eI.EventEmitter,this.messageQueue=new t4.o,this.loadScript(e,function(e){return t.applyWorkerEnv(e)})}var t=e.prototype;return t.postMessage=function(e){this.messageQueue?this.messageQueue.push(e):this.postMessageToWorker(e)},t.addEventListener=function(e,t){this.emitter.on(e,t)},t.removeEventListener=function(e,t){this.emitter.off(e,t)},t.onmessage=function(){},t.onmessageerror=function(){},t.onerror=function(){},t.terminate=function(){},t.dispatchEvent=function(){return!0},t.loadScript=function(e,t){var n=this,r=new XMLHttpRequest;r.open("GET",e),r.addEventListener("load",function(){r.status>=200&&r.status<400?t(r.response):n.emitter.emit("error",Error(r.statusText))}),r.addEventListener("error",function(e){n.emitter.emit("error",e)}),r.send()},t.applyWorkerEnv=function(e){if(this.messageQueue){try{Function("self","messageHandler",e)(window,this.workerPort)}catch(e){return void this.emitter.emit("error",e)}for(;!this.messageQueue.empty();)this.postMessageToWorker(this.messageQueue.pop());this.messageQueue=null}},t.postMessageFromWorker=function(e){var t=this;setTimeout(function(){t.emitter.emit("message",{data:e})},0)},t.postMessageToWorker=function(e){var t=this;setTimeout(function(){t.workerPort.onmessage({data:e})},0)},e}();function t6(e,t,n){var r;return void 0===n&&(n=!1),(r=(0,m.cp)().msIE?new t8(e):new Worker((0,ez.J6)(e)?e:URL.createObjectURL(new Blob(["importScripts('"+e+"')"])))).postMessage({wasmBinaryUrl:t,showWorkerLogs:n}),r}var t5="undefined"!=typeof window&&"object"==typeof window.WebAssembly&&"function"==typeof window.WebAssembly.instantiate,t7=t5;function t9(e){var t=e.asmWorker,n=e.wasmWorker,r=e.wasmBinary;if(!t7&&!t)throw Error("WebAssembly is not supported by the browser. This is required for playback.");var i=t6(t7?n:t,r,e.showWorkerLog);return new nt(e,i)}function ne(){return"1.44.0"}var nt=function(){function e(e,t){this.core=void 0,this.startCapture=void 0,this.stopCapture=void 0,this.requestCaptureAnalytics=void 0,this.core=new t3(e,t)}var t=e.prototype;return t.addEventListener=function(e,t){var n;null==(n=this.checkCore())||n.addEventListener(e,t)},t.attachHTMLVideoElement=function(e){var t;null==(t=this.checkCore())||t.attachHTMLVideoElement(e)},t.delete=function(){var e;null==(e=this.checkCore())||e.delete(),this.core=null},t.endRemotePlayback=function(){var e;null==(e=this.checkCore())||e.endRemotePlayback()},t.isAutoplay=function(){var e;return null==(e=this.checkCore())?void 0:e.isAutoplay()},t.isAutoQualityMode=function(){var e;return null==(e=this.checkCore())?void 0:e.isAutoQualityMode()},t.getAverageBitrate=function(){var e;return null==(e=this.checkCore())?void 0:e.getAverageBitrate()},t.getBandwidthEstimate=function(){var e;return null==(e=this.checkCore())?void 0:e.getBandwidthEstimate()},t.getBufferDuration=function(){var e;return null==(e=this.checkCore())?void 0:e.getBufferDuration()},t.getBuffered=function(){var e;return null==(e=this.checkCore())?void 0:e.getBuffered()},t.getBufferedRanges=function(){var e;return null==(e=this.checkCore())?void 0:e.getBufferedRanges()},t.getSinkBufferedRanges=function(){var e;return null==(e=this.checkCore())?void 0:e.getSinkBufferedRanges()},t.getDecodedFrames=function(){var e;return null==(e=this.checkCore())?void 0:e.getDecodedFrames()},t.getDisplayHeight=function(){var e;return null==(e=this.checkCore())?void 0:e.getDisplayHeight()},t.getDisplayWidth=function(){var e;return null==(e=this.checkCore())?void 0:e.getDisplayWidth()},t.getDroppedFrames=function(){var e;return null==(e=this.checkCore())?void 0:e.getDroppedFrames()},t.getDuration=function(){var e;return null==(e=this.checkCore())?void 0:e.getDuration()},t.getExperiments=function(){var e;return null==(e=this.checkCore())?void 0:e.getExperiments()},t.getHTMLVideoElement=function(){var e;return null==(e=this.checkCore())?void 0:e.getHTMLVideoElement()},t.getVideoRenderSurface=function(){var e;return null==(e=this.checkCore())?void 0:e.getVideoRenderSurface()},t.getLiveLatency=function(){var e;return null==(e=this.checkCore())?void 0:e.getLiveLatency()},t.getPath=function(){var e;return null==(e=this.checkCore())?void 0:e.getPath()},t.getProtocol=function(){var e;return null==(e=this.checkCore())?void 0:e.getProtocol()},t.getPlaybackRate=function(){var e;return null==(e=this.checkCore())?void 0:e.getPlaybackRate()},t.getPosition=function(){var e;return null==(e=this.checkCore())?void 0:e.getPosition()},t.getSyncTime=function(){var e;return null==(e=this.checkCore())?void 0:e.getSyncTime()},t.getQualities=function(){var e;return null==(e=this.checkCore())?void 0:e.getQualities()},t.getUnavailableQualities=function(){var e;return null==(e=this.checkCore())?void 0:e.getUnavailableQualities()},t.getQuality=function(){var e;return null==(e=this.checkCore())?void 0:e.getQuality()},t.getSessionData=function(){var e;return null==(e=this.checkCore())?void 0:e.getSessionData()},t.getSessionId=function(){var e;return null==(e=this.checkCore())?void 0:e.getSessionId()},t.getChannelMetadata=function(){var e,t;return null!=(e=null==(t=this.checkCore())?void 0:t.getChannelMetadata())?e:[]},t.getStartOffset=function(){var e;return null==(e=this.checkCore())?void 0:e.getStartOffset()},t.getState=function(){var e;return null==(e=this.checkCore())?void 0:e.getState()},t.getVersion=function(){var e;return null==(e=this.checkCore())?void 0:e.getVersion()},t.getVideoBitRate=function(){var e;return null==(e=this.checkCore())?void 0:e.getVideoBitRate()},t.getVideoFrameRate=function(){var e;return null==(e=this.checkCore())?void 0:e.getVideoFrameRate()},t.getVideoHeight=function(){var e;return null==(e=this.checkCore())?void 0:e.getVideoHeight()},t.getVideoWidth=function(){var e;return null==(e=this.checkCore())?void 0:e.getVideoWidth()},t.getVolume=function(){var e;return null==(e=this.checkCore())?void 0:e.getVolume()},t.isLiveLowLatency=function(){var e;return null==(e=this.checkCore())?void 0:e.isLiveLowLatency()},t.isLooping=function(){var e;return null==(e=this.checkCore())?void 0:e.isLooping()},t.isMuted=function(){var e;return null==(e=this.checkCore())?void 0:e.isMuted()},t.isPaused=function(){var e;return null==(e=this.checkCore())?void 0:e.isPaused()},t.isProtected=function(){var e;return null==(e=this.checkCore())?void 0:e.isProtected()},t.isSeeking=function(){var e;return null==(e=this.checkCore())?void 0:e.isSeeking()},t.load=function(e,t){var n;return void 0===t&&(t=""),null==(n=this.checkCore())?void 0:n.load(e,t)},t.pause=function(){var e;null==(e=this.checkCore())||e.pause()},t.play=function(){var e;null==(e=this.checkCore())||e.play()},t.removeEventListener=function(e,t){var n;null==(n=this.checkCore())||n.removeEventListener(e,t)},t.seekTo=function(e){var t;null==(t=this.checkCore())||t.seekTo(e)},t.setAuthToken=function(e){var t;null==(t=this.checkCore())||t.setAuthToken(e)},t.setAutoInitialBitrate=function(e){var t;null==(t=this.checkCore())||t.setAutoInitialBitrate(e)},t.setAutoMaxQuality=function(e){var t;null==(t=this.checkCore())||t.setAutoMaxQuality(e)},t.setAutoMaxBitrate=function(e){var t;null==(t=this.checkCore())||t.setAutoMaxBitrate(e)},t.setAutoMaxVideoSize=function(e,t){var n;null==(n=this.checkCore())||n.setAutoMaxVideoSize(e,t)},t.setAutoplay=function(e){var t;null==(t=this.checkCore())||t.setAutoplay(e)},t.setAutoPlayOptions=function(e){var t;null==(t=this.checkCore())||t.setAutoPlayOptions(e)},t.setAutoQualityMode=function(e){var t;null==(t=this.checkCore())||t.setAutoQualityMode(e)},t.setAutoViewportSize=function(e,t){var n;null==(n=this.checkCore())||n.setAutoViewportSize(e,t)},t.setClientId=function(e){var t;null==(t=this.checkCore())||t.setClientId(e)},t.setDeviceId=function(e){var t;null==(t=this.checkCore())||t.setDeviceId(e)},t.setExperiment=function(e,t){var n;null==(n=this.checkCore())||n.setExperiment(e,t)},t.setExperimentData=function(e){var t;null==(t=this.checkCore())||t.setExperimentData(e)},t.setInitialBufferDuration=function(e){var t;null==(t=this.checkCore())||t.setInitialBufferDuration(e)},t.setLiveLowLatencyEnabled=function(e){var t;null==(t=this.checkCore())||t.setLiveLowLatencyEnabled(e)},t.setLiveMaxLatency=function(e){var t;null==(t=this.checkCore())||t.setLiveMaxLatency(e)},t.setLiveSpeedUpRate=function(e){var t;null==(t=this.checkCore())||t.setLiveSpeedUpRate(e)},t.setLogLevel=function(e){var t;null==(t=this.checkCore())||t.setLogLevel(e)},t.setLooping=function(e){var t;null==(t=this.checkCore())||t.setLooping(e)},t.setMuted=function(e){var t;null==(t=this.checkCore())||t.setMuted(e)},t.setPlaybackRate=function(e){var t;null==(t=this.checkCore())||t.setPlaybackRate(e)},t.setPlayerType=function(e){var t;null==(t=this.checkCore())||t.setPlayerType(e)},t.setQuality=function(e,t){var n;void 0===t&&(t=!1),null==(n=this.checkCore())||n.setQuality(e,t)},t.setSourceGroup=function(e){var t;null==(t=this.checkCore())||t.setSourceGroup(e)},t.getSourceGroup=function(){var e;return null==(e=this.checkCore())?void 0:e.getSourceGroup()},t.getSourceGroups=function(){var e;return null==(e=this.checkCore())?void 0:e.getSourceGroups()},t.setRebufferToLive=function(e){var t;null==(t=this.checkCore())||t.setRebufferToLive(e)},t.setVisible=function(e){var t;null==(t=this.checkCore())||t.setVisible(e)},t.setVolume=function(e){var t;null==(t=this.checkCore())||t.setVolume(e)},t.startRemotePlayback=function(){var e;null==(e=this.checkCore())||e.startRemotePlayback()},t.setPlatformName=function(e){var t;null==(t=this.checkCore())||t.setPlatformName(e)},t.setRequestCredentials=function(e){var t;null==(t=this.checkCore())||t.setRequestCredentials(e)},t.checkCore=function(){return this.core||console.warn("Method called on deleted player instance."),this.core},t.skipAd=function(){var e;null==(e=this.checkCore())||e.skipAd()},e}()},573:function(e,t,n){"use strict";n.d(t,{o:function(){return r}});var r=function(){function e(){this.buffer=void 0,this.head=void 0,this.tail=void 0,this.buffer=[],this.head=0,this.tail=0}var t=e.prototype;return t.push=function(e){this.tail===this.buffer.length?this.buffer.push(e):this.buffer[this.tail]=e,this.tail++},t.pop=function(){var e,t=null!=(e=this.buffer[this.head])?e:null;return this.buffer[this.head]=null,this.head++,this.empty()&&(this.head=0,this.tail=0),t},t.size=function(){return this.tail-this.head},t.empty=function(){return this.head>=this.tail},e}()},290:function(e,t,n){"use strict";n.d(t,{$1:function(){return l},$_:function(){return p},Ec:function(){return h},Pt:function(){return a},Ri:function(){return f},Vk:function(){return r},a1:function(){return i},lU:function(){return c},ok:function(){return o},pn:function(){return s},xA:function(){return d},yY:function(){return u}});var r=-1,i=2,o=3,a=4,s=1,u=101,c=102,l=201,f=202,d=203,h=204,p=404},998:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(898),i=n.n(r),o=n(290),a=n(789),s=n(573),u=n(623);function c(e){var t=(e||"").match(/codecs="([^.]+)\./);return t&&t[1]?t[1]:""}var l=function(){function e(e,t,n,r,i){this.rawCodec=t,this.group=n,this.isProtected=r,this.onError=i,this.pending=void 0,this.unsubscribers=[],this.srcBuf=void 0,this.blocked=!1,this.srcBuf=e,this.pending=new s.o,this.unsubscribers.push((0,u.B1)(e,"updateend",this.process.bind(this)))}var t=e.prototype;return t.getBufferedRanges=function(){try{var e=[];if(this.srcBuf)for(var t=this.srcBuf.buffered,n=0;n<t.length;n++)e.push({start:t.start(n),end:t.end(n)});return e}catch(e){return[]}},t.abort=function(){this.schedule(function(e){e.abort()})},t.changeType=function(e){var t;this.rawCodec=(t=(e||"").match(/codecs=".+"/))&&t[0]?t[0]:'codecs=""',this.schedule(function(t){t.changeType(e)})},t.appendBuffer=function(e){this.schedule(function(t){try{t.appendBuffer(e)}catch(e){if("QuotaExceededError"!==e.name)throw e;var n=t.buffered,r=n.start(0),i=n.end(n.length-1);t.remove((r+i)/2,i)}})},t.setTimestampOffset=function(e){this.schedule(function(t){t.timestampOffset=e})},t.remove=function(e,t){this.schedule(function(n){var r=n.buffered;if(r.length){var i=Math.max(e,r.start(0)),o=Math.min(t,r.end(r.length-1));i<o&&n.remove(i,o)}})},t.block=function(){var e=this;return new Promise(function(t){e.schedule(function(){e.blocked=!0,t()})})},t.unblock=function(){this.blocked=!1,this.process()},t.destroy=function(){this.pending=new s.o,this.unsubscribers.forEach(function(e){return e()}),this.srcBuf=void 0},t.schedule=function(e){this.pending.empty()&&this.canProcess()?this.safeExecute(e):(this.pending.push(e),this.process())},t.safeExecute=function(e){try{if(!this.srcBuf)throw Error("srcBuf is undefined");e(this.srcBuf)}catch(e){this.onError(e,!1)}},t.process=function(){for(;!this.pending.empty()&&this.canProcess();)this.safeExecute(this.pending.pop())},t.canProcess=function(){return!(!this.srcBuf||this.srcBuf.updating||this.blocked)},i()(e,[{key:"buffer",get:function(){return this.srcBuf}},{key:"codec",get:function(){return this.rawCodec}},{key:"timestampOffset",get:function(){return this.buffer?this.buffer.timestampOffset:0}}])}(),f=function(){function e(e,t,n){this.mediaSource=e,this.onEnded=t,this.onError=n,this.expectedTracks=-1,this.supportsChangeType=!0,this.pendingSourceBufferData=[],this.sourceBuffers=Object.create(null),this.unsubscribers=[],this.unsubscribers.push((0,u.B1)(e,"sourceended",this.onEnded))}e.isSupported=function(){return void 0!==self.MediaSource},e.isSupportedInWorker=function(){return e.isSupported()&&MediaSource.canConstructInDedicatedWorker&&"function"==typeof MediaSourceHandle},e.create=function(t,n){var r=new MediaSource,i=new Promise(function(i,o){var a=(0,u.B1)(r,"sourceopen",function(){"open"===r.readyState?(i(new e(r,t,n)),a()):o("The MediaSource was closed upon opening")})});return{ms:r,sink:i}};var t=e.prototype;return t.getBufferedRanges=function(e){var t,n;return null!=(t=null==(n=this.sourceBuffers[a.kD[e]])?void 0:n.getBufferedRanges())?t:[]},t.setExpectedTracks=function(e){this.expectedTracks=e},t.getExpectedTracks=function(){return this.expectedTracks},t.setSupportsChangeType=function(e){this.supportsChangeType=e},t.getSupportsChangeType=function(){return this.supportsChangeType},t.addTrack=function(e,t,n,r){var i=this.mediaSource,o=this.sourceBuffers,a="video/mp4;"+t;if(o[e]){var s,u=c(o[e].codec);return c(t)!==u&&o[e].changeType(a),this.checkHaveAllExpectedTracks(),null!=(s=o[e].buffer)?s:null}try{var f=i.addSourceBuffer(a);return o[e]=new l(f,t,n,r,this.handleError.bind(this)),this.checkHaveAllExpectedTracks(),f}catch(e){this.handleError(e,"open"===i.readyState)}return null},t.append=function(e,t){var n,r=this.bufferProperties,i=this.expectedTracks,a=this.sourceBuffers,s=this.pendingSourceBufferData;r.length<i?(s.push([e,t]),s.length>1024&&this.onError(o.lU,o.yY,"possible missing track",!1)):null==(n=a[e])||n.appendBuffer(t)},t.remove=function(e,t){for(var n=this.sourceBuffers,r=0,i=Object.keys(n);r<i.length;r++)n[i[r]].remove(e,t)},t.setTimestampOffset=function(e,t){var n=this.sourceBuffers[e];n&&(n.abort(),n.setTimestampOffset(t))},t.setDuration=function(e){var t=this;this.scheduleUpdate(function(){return t.mediaSource.duration=e}).catch(function(e){return t.handleError(e,!1)})},t.updateDuration=function(e,t){var n,r,i=(n=this.duration,r=e,e===1/0||e===a.Sf?t?r=1/0:t||(r=a.Sf):e!==n&&(r=e),r);i!==this.duration&&this.setDuration(i)},t.setLiveSeekableRange=function(e,t){var n=this;this.scheduleUpdate(function(){return n.mediaSource.setLiveSeekableRange(e,t)}).catch(function(e){return n.handleError(e,!1)})},t.scheduleUpdate=function(e){var t=this;void 0===e&&(e=d);var n=Object.keys(this.sourceBuffers).map(function(e){return t.sourceBuffers[e]});return Promise.all(n.map(function(e){return e.block()})).then(e).then(function(){return n.forEach(function(e){return e.unblock()})})},t.isDrmProtected=function(){return this.bufferProperties.some(function(e){return e.isProtected})},t.isAudioOnly=function(){return 1===this.bufferProperties.length&&"audio_only"===this.bufferProperties[0].group},t.isTrackCompatible=function(e){return!1===(!1===this.supportsChangeType&&this.isChangingCodecId(e)||this.isChangingContentProtection(e)||this.isChangingNumberOfTracks(e.expectedTracks)||this.isChangingNumberOfCodecsInSingleTrack(e,e.expectedTracks))},t.destroy=function(){this.destroySourceBuffers(),this.unsubscribers.forEach(function(e){return e()}),this.unsubscribers=[]},t.isChangingContentProtection=function(e){return this.isDrmProtected()!==e.isProtected},t.isChangingNumberOfTracks=function(e){return this.expectedTracks!==e},t.isChangingNumberOfCodecsInSingleTrack=function(e,t){return 1===this.expectedTracks&&1===t&&e.codec.split(",").length!==this.bufferProperties[0].codec.split(",").length},t.isChangingCodecId=function(e){var t=this.bufferProperties.find(function(t){return t.trackID===e.trackID});return!!t&&c(t.codec)!==c(e.codec)},t.checkHaveAllExpectedTracks=function(){var e=this.sourceBuffers,t=this.bufferProperties,n=this.expectedTracks,r=this.pendingSourceBufferData;if(t.length>=n&&r.length){for(var i=0;i<r.length;++i){var o,a=r[i],s=a[0],u=a[1];null==(o=e[s])||o.appendBuffer(u)}this.pendingSourceBufferData=[]}},t.handleError=function(e,t){var n=e.code||o.lU,r=o.lU;"NotSupportedError"===e.name&&(r=n=o.Pt),this.onError(r,n,e.message,t)},t.destroySourceBuffers=function(){for(var e=this.mediaSource;e.sourceBuffers.length>0;)try{e.removeSourceBuffer(e.sourceBuffers[0])}catch(e){this.handleError(e,!1);break}for(var t=0,n=Object.keys(this.sourceBuffers);t<n.length;t++){var r=n[t];this.sourceBuffers[r].destroy()}this.sourceBuffers=Object.create(null)},i()(e,[{key:"duration",get:function(){return this.mediaSource.duration}},{key:"bufferProperties",get:function(){var e=this,t=this.sourceBuffers,n=Object.keys(t);return n.map(function(r){var i=t[r];return{trackID:Number(r),codec:i.codec,mode:"mse",path:"",isProtected:i.isProtected,group:i.group,srcObj:null,expectedTracks:n.length,duration:e.duration}})}}])}(),d=function(){}},789:function(e,t,n){"use strict";n.d(t,{HJ:function(){return a},Pp:function(){return o},Sf:function(){return i},de:function(){return r},kD:function(){return s}});var r=.1,i=0x40000000,o=12e4,a=3e3,s={audio:0x736f756e,video:0x76696465}},623:function(e,t,n){"use strict";n.d(t,{B1:function(){return f},GX:function(){return h},V3:function(){return c},gd:function(){return s},ld:function(){return a},tX:function(){return l},uD:function(){return v},v8:function(){return d},vG:function(){return u},xB:function(){return o},xE:function(){return p}});var r=n(796),i=n(789);function o(e){return"number"==typeof e.webkitDecodedFrameCount?e.webkitDecodedFrameCount:"function"==typeof e.getVideoPlaybackQuality?e.getVideoPlaybackQuality().totalVideoFrames:"number"==typeof e.mozDecodedFrames?e.mozDecodedFrames:0}function a(e){return"number"==typeof e.webkitDroppedFrameCount?e.webkitDroppedFrameCount:"function"==typeof e.getVideoPlaybackQuality?e.getVideoPlaybackQuality().droppedVideoFrames:0}function s(e,t){for(var n=0;n<t.length;n++)console.info(e,"start: ",t.start(n),", end: ",t.end(n))}function u(e,t,n){for(var r=0;r<e.length;r++){var i=e.start(r),o=e.end(r);if(!(o<=t)){if(i-n>t)break;for(var a=r+1;a<e.length&&!(e.start(a)-o>n);a++)o=e.end(a);for(var s=r-1;s>=0&&!(i-e.end(s)>n);s--)i=e.start(s);return{start:Math.min(i,t),end:o}}}return{start:t,end:t}}function c(e,t){var n=u(e.buffered,e.currentTime,t).end,r=e.currentTime;return!(e.ended||e.duration-r<t)&&n-r<t}function l(e,t,n){void 0===n&&(n=i.de);var r=u(e,t,n).end-t>n;if(e.length>1||!r)for(var o=0;o<e.length;o++){var a=e.start(o),s=e.end(o);if(t<a&&s-a>n)return a+n}return r?t+n:t}function f(e,t,n){return e.addEventListener(t,n),function(){e.removeEventListener(t,n)}}function d(e){if(e.src){var t=e.src;r.Pr(e),e.load(),URL.revokeObjectURL(t)}}function h(e,t){var n=e.playbackRate,r=e.src;r&&URL.revokeObjectURL(r),e.src=t,e.playbackRate=n}function p(e,t){for(var n=0;n<e.length;n++){var r=e.start(n),o=e.end(n);if(!(o-r<i.de)){if(t<r)return r;if(t>=r&&t<=o-i.de)break}}return t}function v(e){for(var t=[],n=0;n<e.length;n++)t.push("["+e.start(n)+", "+e.end(n)+"]");return t.join(",")}},272:function(){},847:function(){},139:function(e,t,n){"use strict";n.d(t,{$:function(){return i}});var r,i=((r={}).DEBUG="debug",r.INFO="info",r.WARN="warn",r.ERROR="error",r)},993:function(){},33:function(){},282:function(){},796:function(e,t,n){"use strict";function r(e){try{return JSON.parse(e)}catch(t){return console.error("Failed JSON parse:",e),{}}}function i(e){try{return JSON.stringify(e)}catch(t){return console.error("Failed JSON stringify:",e),""}}function o(e){return""===e.codecs||"undefined"==typeof MediaSource||MediaSource.isTypeSupported('video/mp4;codecs="'+e.codecs+'"')}function a(e,t){var n=[],r=[];return e.forEach(function(e){t(e)?n.push(e):r.push(e)}),{supported:n,unsupported:r}}function s(e){var t,n;return void 0!==e.hidden?(t="hidden",n="visibilitychange"):void 0!==e.msHidden?(t="msHidden",n="msvisibilitychange"):void 0!==e.webkitHidden&&(t="webkitHidden",n="webkitvisibilitychange"),{hidden:t,visibilityChange:n}}function u(e,t,n){return Math.min(n,Math.max(t,e))}function c(e){e.removeAttribute("src")}function l(e){var t=window.location,n=document.createElement("a");return n.href=e,n.hostname===t.hostname&&n.port===t.port&&n.protocol===t.protocol}function f(e){if("function"==typeof e.checkVisibility)return e.checkVisibility({visibilityProperty:!0});var t=e.style;return"none"!==t.display&&"hidden"!==t.visibility}function d(e){return 0|e}n.d(t,{J6:function(){return l},N8:function(){return r},Pr:function(){return c},YH:function(){return a},dl:function(){return i},h3:function(){return o},j:function(){return f},p9:function(){return d},qE:function(){return u},sQ:function(){return s}})},579:function(e,t,n){"use strict";n.d(t,{G:function(){return v}});var r,i,o,a=n(911),s=n(0),u=n(184),c=n(376),l=n(965),f=((r={}).DURATION_CHANGE="durationchange",r.ENDED="ended",r.ERROR="error",r.LOADED_METADATA="loadedmetadata",r.LOADSTART="loadstart",r.PAUSE="pause",r.PLAY="play",r.PLAYING="playing",r.RATE_CHANGE="ratechange",r.SEEKED="seeked",r.SEEKING="seeking",r.TIME_UPDATE="timeupdate",r.VOLUME_CHANGE="volumechange",r.WAITING="waiting",r),d=((i=d||{})[i.HAVE_NOTHING=0]="HAVE_NOTHING",i[i.HAVE_METADATA=1]="HAVE_METADATA",i[i.HAVE_CURRENT_DATA=2]="HAVE_CURRENT_DATA",i[i.HAVE_FUTURE_DATA=3]="HAVE_FUTURE_DATA",i[i.HAVE_ENOUGH_DATA=4]="HAVE_ENOUGH_DATA",i),h=((o={})[c.p.IDLE]=1,o[c.p.READY]=1,o[c.p.BUFFERING]=2,o[c.p.PLAYING]=2,o[c.p.ENDED]=1,o),p="AmazonIVS";function v(e,t){if(void 0===e||"function"!=typeof e.getTech)throw{message:"videojs not available, AmazonIVS tech not registered",code:1};if(!l.i$)throw{message:"WebAssembly support is required for AmazonIVS tech",code:2};if(!e.getTech(p)){var n,r={featuresProgressEvents:!0,featuresTimeupdateEvents:!0,featuresPlaybackRate:!0,featuresFullscreenResize:!0,featuresVolumeControl:!0,featuresMuteControl:!0,featuresNativeTextTracks:!1,privateContructor:function(n,r,i){this._readyState=d.HAVE_NOTHING,this._defaultPlaybackRate=1,this._seeking=!1,t.playerFramework={name:"videojs",version:e.VERSION},this._mediaPlayer=(0,l.vt)(t),this._mediaPlayer.setAutoplay(!0===n.autoplay),this._attachVideojsListeners(),this._mediaPlayer.addEventListener(u.a.METADATA,this._onCaptionEvent.bind(this));var o=this._createEl(n);n.el=o,i(this,n,r),window.vttjs&&window.vttjs.restore(),this.triggerReady(),setTimeout((function(){var e=this.options(),t=e.loop,n=e.muted;t&&this._mediaPlayer.setLooping(!0),n&&this._mediaPlayer.setMuted(!0)}).bind(this),0)},dispose:function(){this._mediaPlayer.delete()},setPreload:function(){},autoplay:function(e){if("boolean"!=typeof e)return this._mediaPlayer.autoplay;this.setAutoplay(e)},setAutoplay:function(e){this._mediaPlayer.setAutoplay(e)},preload:function(){},load:function(){},readyState:function(){return this._readyState},seeking:function(){return this._seeking},networkState:function(){if(!this._mediaPlayer)return 0;var e=this._mediaPlayer.getHTMLVideoElement();return e.src||e.srcObject?h[this._mediaPlayer.getState()]:3},ended:function(){return this._mediaPlayer.getState()===c.p.ENDED},seekable:function(){return e.createTimeRange(0,this._mediaPlayer.getDuration())},play:function(){this._mediaPlayer.play(),this.trigger(f.PLAY)},pause:function(){this._mediaPlayer.pause()},setCurrentTime:function(e){var t=this._mediaPlayer.getHTMLVideoElement();(t.src||t.srcObject)&&(this._mediaPlayer.seekTo(e),this._seeking=!0,this.trigger(f.SEEKING))},controls:function(){return!1},setControls:function(){return!1},muted:function(){return this._mediaPlayer.isMuted()},setMuted:function(e){this._mediaPlayer.setMuted(e)},volume:function(){return this._mediaPlayer.getVolume()},setVolume:function(e){this._mediaPlayer.setVolume(e)},defaultPlaybackRate:function(e){if(!e)return this._defaultPlaybackRate;this._defaultPlaybackRate=e},playbackRate:function(){return this._mediaPlayer.getPlaybackRate()},setPlaybackRate:function(e){this._mediaPlayer.setPlaybackRate(e)},paused:function(){return this._mediaPlayer.isPaused()},duration:function(){return this._mediaPlayer.getDuration()},currentTime:function(){return this._mediaPlayer.getPosition()},_createEl:function(e){var t=this._mediaPlayer.getHTMLVideoElement();t.setAttribute("class","vjs-tech"),void 0!==e.disablePictureInPicture&&(t.disablePictureInPicture=e.disablePictureInPicture),["preload","poster"].forEach((function(n){e[n]&&t.setAttribute(n,e[n])}).bind(this)),e.playsinline&&(t.setAttribute("webkit-playsinline",""),t.setAttribute("playsinline",""));var n=document.createElement("div");return n.appendChild(t),n},src:function(e){this.trigger(f.LOADSTART),this._seeking=!1,this._captionTrack&&(this.textTracks().removeTrack(this._captionTrack),this._captionTrack=null),e&&this._mediaPlayer.load(e)},addEventListener:function(e,t){this._mediaPlayer.addEventListener(e,t)},removeEventListener:function(e,t){this._mediaPlayer.removeEventListener(e,t)},getMediaPlayerAPI:function(){return this._mediaPlayer},supportsFullScreen:function(){return!0},enterFullScreen:function(){var e=this._mediaPlayer.getHTMLVideoElement();(e.requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen||e.webkitEnterFullscreen||function(){console.error("Fullscreen API is not available")}).call(e)},exitFullScreen:function(){(document.exitFullScreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen||function(){console.error("Exitscreen API is not available")}).call(document)},requestPictureInPicture:function(){return this._mediaPlayer.getHTMLVideoElement().requestPictureInPicture()},setDisablePictureInPicture:function(e){this._mediaPlayer.getHTMLVideoElement().disablePictureInPicture=e},disablePictureInPicture:function(){return this._mediaPlayer.getHTMLVideoElement().disablePictureInPicture},_onCaptionEvent:function(e){if("text/json"===e.type){var t=JSON.parse(e.data);if(t.caption){var n=t.caption;this._captionTrack||(this._captionTrack=this.addTextTrack("captions",n.format),this._currentCue=null),this._currentCue&&this._captionTrack.removeCue(this._currentCue);var r=this._mediaPlayer.getHTMLVideoElement(),i=window.VTTCue||window.vttjs.VTTCue;i?(this._currentCue=new i(r.currentTime,r.currentTime+2,n.text),this._captionTrack.addCue(this._currentCue)):console.warn("No VTTCue implementation available, caption may not be available")}}},_attachVideojsListeners:function(){this._mediaPlayer.addEventListener(c.p.READY,(function(){this._readyState=d.HAVE_METADATA,this.trigger(f.LOADED_METADATA)}).bind(this)),this._mediaPlayer.addEventListener(c.p.IDLE,(function(){this._readyState=d.HAVE_NOTHING,this.trigger(f.PAUSE)}).bind(this)),this._mediaPlayer.addEventListener(c.p.PLAYING,(function(){this._readyState<=d.HAVE_CURRENT_DATA&&(this._readyState=d.HAVE_FUTURE_DATA),this.trigger(f.PLAY),this.trigger(f.PLAYING)}).bind(this)),this._mediaPlayer.addEventListener(c.p.ENDED,(function(){this._readyState=d.HAVE_NOTHING,this.trigger(f.ENDED)}).bind(this)),this._mediaPlayer.addEventListener(c.p.BUFFERING,(function(){this._readyState=d.HAVE_CURRENT_DATA}).bind(this)),this._mediaPlayer.addEventListener(u.a.REBUFFERING,(function(){this._readyState=d.HAVE_CURRENT_DATA,this.trigger(f.WAITING)}).bind(this)),this._mediaPlayer.addEventListener(u.a.TIME_UPDATE,(function(){this.trigger(f.TIME_UPDATE)}).bind(this)),this._mediaPlayer.addEventListener(u.a.VOLUME_CHANGED,(function(){this.trigger(f.VOLUME_CHANGE)}).bind(this)),this._mediaPlayer.addEventListener(u.a.MUTED_CHANGED,(function(){this.trigger(f.VOLUME_CHANGE)}).bind(this)),this._mediaPlayer.addEventListener(u.a.ERROR,(function(){this.trigger(f.ERROR)}).bind(this)),this._mediaPlayer.addEventListener(u.a.DURATION_CHANGED,(function(){this.trigger(f.DURATION_CHANGE)}).bind(this)),this._mediaPlayer.addEventListener(u.a.SEEK_COMPLETED,(function(){this._seeking=!1,this.trigger(f.SEEKED)}).bind(this)),this._mediaPlayer.addEventListener(u.a.PLAYBACK_RATE_CHANGED,(function(){this.trigger(f.RATE_CHANGE)}).bind(this))}},i=e.getTech("Tech");"function"==typeof e.extend?(r.constructor=function(e,t){this.privateContructor(e,t,function(e,t,n){i.call(e,t,n)})},n=e.extend(i,r,p)):((n=function(e,t){this.privateContructor(e,t,function(e,t,n){var r=i.prototype,o=r.featuresProgressEvents,a=r.featuresTimeupdateEvents,s=r.featuresPlaybackRate,u=r.featuresFullscreenResize,c=r.featuresVolumeControl,l=r.featuresMuteControl,d=r.featuresNativeTextTracks;r.featuresProgressEvents=!0,r.featuresTimeupdateEvents=!0,r.featuresPlaybackRate=!0,r.featuresFullscreenResize=!0,r.featuresVolumeControl=!0,r.featuresMuteControl=!0,r.featuresNativeTextTracks=!1,Object.assign(e,new i(t,n)),e.on(f.PLAYING,function(){e.hasStarted_=!0}),e.on(f.LOADSTART,function(){e.hasStarted_=!1}),r.featuresProgressEvents=o,r.featuresTimeupdateEvents=a,r.featuresPlaybackRate=s,r.featuresFullscreenResize=u,r.featuresVolumeControl=c,r.featuresMuteControl=l,r.featuresNativeTextTracks=d})}).prototype=Object.create(i.prototype),Object.assign(n.prototype,r)),n.supportsFullScreen=function(){return!0},n.isSupported=function(){return -1===(navigator.appVersion||"").toLowerCase().indexOf("rv:11")},n.canPlayType=function(e){return"string"==typeof e&&e.length>0&&(e.indexOf("application/x-mpegURL")>-1?"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'):""!==document.createElement("video").canPlayType(e))},n.canPlaySource=function(){return!0},e.registerTech("AmazonIVS",n);var o=e.registerPlugin||e.plugin;o("getIVSEvents",function(){return{PlayerEventType:u.a,MetadataEventType:s.C,PlayerState:c.p,ErrorType:a.B}}),o("getIVSPlayer",function(){return this.tech(!0).getMediaPlayerAPI()})}}},405:function(e,t,n){"use strict";n.d(t,{U:function(){return a}});var r=n(184),i=n(376),o="enableIVSQualityPlugin";function a(e){if(void 0===e||"function"!=typeof e.getTech)throw{message:"videojs not available, Amazon IVS Quality Plugin not registered",code:1};if(!e.getPlugin(o)){var t,n=e.getComponent("MenuButton"),a=e.getComponent("MenuItem"),s={privateConstructor:function(e,t,n){n(this,e,t),this.controlText("Quality")},createItems:function(){var e=this.player(),t=e.getIVSPlayer(),n=[],i=new a(e,{selectable:!0,label:"Auto",qualityGroup:"auto"});i.selected(t.isAutoQualityMode()),i.on(["click","tap"],function(){t.setAutoQualityMode(!0)}),i.on(["click","tap"],this._clickHandler.bind(this,i)),n.push(i);var o=t.getQuality(),s=t.getQualities();return s&&s.length>0&&s.forEach((function(r){var i=new a(e,{selectable:!0,label:r.name,qualityGroup:r.group}),s=(function(e){t.setQuality(e)}).bind(null,r);i.on(["click","tap"],s),i.on(["click","tap"],this._clickHandler.bind(this,i)),t.isAutoQualityMode()||i.selected(o.group===r.group),n.push(i)}).bind(this)),t.addEventListener(r.a.QUALITY_CHANGED,function(n){var r;if(!t.isAutoQualityMode()){var i=null==(r=e.controlBar)?void 0:r.getChild("QualityMenuButton");null==i||i.items.forEach(function(e){var t=e.options().qualityGroup;n&&t&&e.selected(n.group===t)})}}),this.qualityItems=n,n},buildCSSClass:function(){return"vjs-icon-hd vjs-icon-placeholder "+n.prototype.buildCSSClass.call(this)},_clickHandler:function(e){this.items.forEach(function(t){t!==e&&t.selected(!1)})}};"function"==typeof e.extend?(s.constructor=function(e,t){this.privateConstructor(e,t,function(e,t,r){n.call(e,t,r)})},t=e.extend(n,s)):((t=function(e,t){this.privateConstructor(e,t,function(e,t,r){var i="quality-control";r.name=i;var o=new n(t,r);o.getChild(i).addClass("vjs-icon-hd vjs-icon-placeholder"),Object.assign(e,o),e.items=e.createItems(),e.items.forEach(function(t){e.menu.addItem(t)})})}).prototype=Object.create(n.prototype),Object.assign(t.prototype,s)),e.registerComponent("QualityMenuButton",t),(e.registerPlugin||e.plugin)(o,function(){var e=this;e.getIVSPlayer().addEventListener(i.p.READY,function(){var t,n,r=null==(t=e.controlBar)?void 0:t.getChild("QualityMenuButton");r&&(r.dispose(),e.controlBar.removeChild(r)),null==(n=e.controlBar)||n.addChild("QualityMenuButton")})})}}},898:function(e){"use strict";e.exports=n(46045)}},r={};function i(e){var n=r[e];if(void 0!==n)return n.exports;var o=r[e]={exports:{}};return t[e].call(o.exports,o,o.exports,i),o.exports}i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};!function(){"use strict";i.r(o),i.d(o,{AuthorizationError:function(){return t.y},CaptureEventType:function(){return n.P},ErrorSource:function(){return e.g},ErrorType:function(){return t.B},LogLevel:function(){return g.$},MediaPlayer:function(){return u.KJ},MetadataEventType:function(){return r.C},MetadataID3Type:function(){return r._},PlayerEventType:function(){return a.a},PlayerState:function(){return s.p},RemotePlayerEvent:function(){return b.G},create:function(){return u.vt},createWorker:function(){return u.Zx},getVersion:function(){return u.HF},isPlayerSupported:function(){return u.i$},isVP9Supported:function(){return m.YJ},isWasmSupported:function(){return u.TH},registerIVSQualityPlugin:function(){return _.U},registerIVSTech:function(){return y.G}});var e=i(554),t=i(911),n=i(695),r=i(0),a=i(184),s=i(376),u=i(965),c=i(272),l={};for(var f in c)0>["default","LogLevel","isVP9Supported","registerIVSTech","registerIVSQualityPlugin","ErrorSource","AuthorizationError","ErrorType","CaptureEventType","MetadataEventType","MetadataID3Type","PlayerEventType","PlayerState","MediaPlayer","create","createWorker","getVersion","isPlayerSupported","isWasmSupported"].indexOf(f)&&(l[f]=(function(e){return c[e]}).bind(0,f));i.d(o,l);var d=i(847);for(var f in l={},d)0>["default","LogLevel","isVP9Supported","registerIVSTech","registerIVSQualityPlugin","ErrorSource","AuthorizationError","ErrorType","CaptureEventType","MetadataEventType","MetadataID3Type","PlayerEventType","PlayerState","MediaPlayer","create","createWorker","getVersion","isPlayerSupported","isWasmSupported"].indexOf(f)&&(l[f]=(function(e){return d[e]}).bind(0,f));i.d(o,l);var h=i(993);for(var f in l={},h)0>["default","LogLevel","isVP9Supported","registerIVSTech","registerIVSQualityPlugin","ErrorSource","AuthorizationError","ErrorType","CaptureEventType","MetadataEventType","MetadataID3Type","PlayerEventType","PlayerState","MediaPlayer","create","createWorker","getVersion","isPlayerSupported","isWasmSupported"].indexOf(f)&&(l[f]=(function(e){return h[e]}).bind(0,f));i.d(o,l);var p=i(33);for(var f in l={},p)0>["default","LogLevel","isVP9Supported","registerIVSTech","registerIVSQualityPlugin","ErrorSource","AuthorizationError","ErrorType","CaptureEventType","MetadataEventType","MetadataID3Type","PlayerEventType","PlayerState","MediaPlayer","create","createWorker","getVersion","isPlayerSupported","isWasmSupported"].indexOf(f)&&(l[f]=(function(e){return p[e]}).bind(0,f));i.d(o,l);var v=i(282);for(var f in l={},v)0>["default","LogLevel","isVP9Supported","registerIVSTech","registerIVSQualityPlugin","ErrorSource","AuthorizationError","ErrorType","CaptureEventType","MetadataEventType","MetadataID3Type","PlayerEventType","PlayerState","MediaPlayer","create","createWorker","getVersion","isPlayerSupported","isWasmSupported"].indexOf(f)&&(l[f]=(function(e){return v[e]}).bind(0,f));i.d(o,l);var g=i(139),m=i(530),y=i(579),_=i(405),b=i(355)}(),e.exports=o}()}}]);